import{s as j}from"./vue-multiselect-DlgdwCpK.js";import{_ as Y,r as s,u as Z,A as c,w as ee,o as te,G as ae,c as i,a as t,n as u,h as D,t as v,m as N,C as P,d as b,f as se,V as le,F as O,j as oe,s as U,x as q,g as n,y as ne}from"./index-BYXzTvYI.js";import{C}from"./Charts-CE-RyVlE.js";/* empty css                                                                   */import{_ as re}from"./BigTable-Cj2PGgEM.js";import"./xlsx-IcMHtxdE.js";/* empty css                            *//* empty css                                                 */const ie={class:"container-global mb-2"},ue={class:"d-flex justify-content-between align-items-center mb-2 mt-auto"},de={class:"text-end"},ce={class:"row align-items-end mb-4"},ve={class:"col-md-5"},me={class:"col-md-5"},_e={class:"col-md-2 text-end"},pe={class:"mb-2"},ye={class:"row text-center mb-4"},be={class:"col"},ge={class:"card border-success"},he={class:"card-body"},fe={class:"text-success"},we={class:"col"},ke={class:"card border-danger"},xe={class:"card-body"},De={class:"text-danger",style:{"text-align":"center"}},Ce={style:{"margin-right":"10px"}},Se={style:{"margin-left":"10px"}},Ue={class:"col"},Te={class:"card border-warning"},Be={class:"card-body"},Ve={class:"text-warning",style:{"text-align":"center"}},Fe={style:{"margin-right":"10px"}},Ae={style:{"margin-left":"10px"}},Ie={class:"nav nav-tabs"},Re=["onClick"],Le={key:0,class:"card mb-4"},Ee={key:1,class:"row g-4 mb-4"},$e={key:0,class:"col-md-12"},je={key:1,class:"col-md-12"},Ne={class:"card h-100"},Pe={key:2,class:"col-md-12"},Oe={class:"card h-100"},qe={key:3,class:"col-md-12"},ze={class:"card h-100"},He={key:4,class:"col-md-12"},Me={class:"card h-100"},Ge={__name:"DownEquipment",setup(Ke){const z=s(null),w=Z(),m=s(""),_=s(""),d=s(""),T=s([]),B=s([]),S=s(!0),V=s({title:"Daily Trend",type:"bar",api:{url:c+"/chart/de_running_total",params:[14,d.value,""]},columns:{label:["date"],datas:["running_total","daily_down","daily_done"]},colors:["red","orange","green"],labels:["Total Down","Units Down / Day","Units Done / Day"]}),g=s({title:"Daily Trend",type:"line",api:{url:c+"/chart/de_running_total",params:[14,d.value,""]},columns:{label:["date"],datas:["running_total","daily_down","daily_done"]},colors:["red","orange","green"],labels:["Total Down","Units Down / Day","Units Done / Day"]}),h=s({title:"Unit Summary",type:"pie",api:{url:c+"/chart/de_total_rental",params:["",""]},columns:{datas:["unit_rental","spare_exists_false","spare_exists_true"]},colors:["green","red","orange"],labels:["Unit Rental","PA Unit","PA Rental"]}),H=s({title:"Customer Summary",type:"bar",api:{url:c+"/chart/de_customer_summary"},columns:{label:["customer"],datas:["total_unit","total_break"]},colors:["green","red"],labels:["Total Unit","Total Break"]}),M=s({title:"Location Summary",type:"bar",api:{url:c+"/chart/de_location_summary"},columns:{label:["alt_location"],datas:["total_unit","total_break"]},colors:["green","red"],labels:["Total Unit","Total Break"]}),G=s({title:"Site Summary"}),K=s({firstCol:{label:"TK NO",field:"tk_no",type:"type"},merge:[{fields:["hour_in","hour_out"],to:"hour"},{fields:["jarak_in","jarak_out"],to:"jarak"}],priority:["customer","alt_location"],unpriority:["username","createdAt","lastUpdated"],hidden:["id","done"],toRemove:["vehicle_type","plate_no"],uneditable:["id","plan_hub"],checkbox:["spare_exists"],date:[],datetime:["down_since","estimated_return"]}),J=s({data:`${w.apiBaseUrl}/de_site`,dropdowns:{vehicle_type:{url:w.apiBaseUrl+"/dropdowns/vehicle_type",valueField:"vehicle_type",column:"vehicle_type"},tk_no:{url:w.apiBaseUrl+"/dropdowns/tk_no",valueField:"tk_no",column:"tk_no"}},get:{vehicle_type:{url:w.apiBaseUrl+"/get/vehicle_type",valueField:"vehicle_type",column:"vehicle_type"}}}),l=s(""),Q=[{label:"All",value:""},{label:"Site Summary",value:"site-summary"},{label:"Daily Trend",value:"0"},{label:"Unit Summary",value:"1"},{label:"Customer Summary",value:"2"},{label:"Location Summary",value:"3"}],W=async()=>{try{const o=await U.get(c+"/dropdowns/customer");T.value=o.data.map(a=>({label:a,value:a}));const e=await U.get(c+"/dropdowns/alt_location");B.value=e.data.map(a=>({label:a,value:a}))}catch(o){console.error("Error fetching dropdown data:",o)}};s();const F=s(),k=s(),A=async(o,e)=>{var a,r,E,$;o==="customer"?(m.value=e,g.value.api.params[1]=((a=m.value)==null?void 0:a.value)??"",h.value.api.params[0]=((r=m.value)==null?void 0:r.value)??""):(_.value=e,g.value.api.params[2]=((E=_.value)==null?void 0:E.value)??"",h.value.api.params[1]=(($=_.value)==null?void 0:$.value)??""),console.log(e.value),await k.value.renderChart(),await F.value.renderChart(),await x(),await q()},f=s([0,0]),p=s([0,0]),y=s([0,0]),I=s("");function R(){const o=new Date,e=o.getHours().toString().padStart(2,"0"),a=o.getMinutes().toString().padStart(2,"0"),r=o.getSeconds().toString().padStart(2,"0");I.value=`${e}:${a}:${r}`}const x=async()=>{var o,e;try{const a=await U.get(c+"/chart/de_total_rental",{params:{params:[((o=m.value)==null?void 0:o.value)??"",((e=_.value)==null?void 0:e.value)??""]}}),r=a.data[0].unit_rental+a.data[0].spare_exists_false+a.data[0].spare_exists_true;f.value[0]=a.data[0].unit_rental,p.value[0]=a.data[0].spare_exists_false+a.data[0].spare_exists_true,y.value[0]=a.data[0].spare_exists_false,r===0?(f.value[1]=0,p.value[1]=0,y.value[1]=0):(f.value[1]=(f.value[0]/r*100).toFixed(2),p.value[1]=(100-p.value[0]/r*100).toFixed(2),y.value[1]=(100-y.value[0]/r*100).toFixed(2))}catch(a){console.error("Fetch error:",a)}};ee(d.value,async()=>{console.log("selectedItems : ",d.value),V.value.api.params[1]=d.value,g.value.api.params[1]=d.value,h.value.api.params[0]=d.value,await x()});let L;te(async()=>{await W(),await x(),S.value=!1,R(),L=setInterval(R,1e3)}),ae(()=>{clearInterval(L)});const X=async()=>{customer.value="",location.value="",d.value="",V.value.api.params[1]="",g.value.api.params[1]="",h.value.api.params[0]="",await x(),await q(),k.value&&await k.value.renderChart()};return(o,e)=>(n(),i(O,null,[t("div",ie,[t("div",ue,[e[4]||(e[4]=t("h1",{class:"h3 fw-bold mb-0"},[t("i",{class:"bi bi-car-front-fill me-2"}),D(" Down Equipment Dashboard ")],-1)),t("div",de,[t("div",null,v(I.value),1)])]),t("div",ce,[t("div",ve,[e[5]||(e[5]=t("label",{class:"form-label"},"Select Customer",-1)),S.value?u("",!0):(n(),N(P(j),{key:0,modelValue:m.value,"onUpdate:modelValue":[e[0]||(e[0]=a=>m.value=a),e[1]||(e[1]=a=>A("customer",a))],options:T.value||[],placeholder:"Select Customer",label:"label","track-by":"value",class:"multiselect no-border"},null,8,["modelValue","options"]))]),t("div",me,[e[6]||(e[6]=t("label",{class:"form-label"},"Select Location",-1)),S.value?u("",!0):(n(),N(P(j),{key:0,modelValue:_.value,"onUpdate:modelValue":[e[2]||(e[2]=a=>_.value=a),e[3]||(e[3]=a=>A("location",a))],options:B.value||[],placeholder:"Select Location",label:"label","track-by":"value",class:"multiselect no-border"},null,8,["modelValue","options"]))]),t("div",_e,[b(le,{type:"button",color:"danger",size:"md",block:!1,onClick:X},{default:se(()=>e[7]||(e[7]=[D(" Reset Filter ")])),_:1})])]),t("div",pe,[e[13]||(e[13]=t("div",{class:"text-end"},[t("h5",{class:"fw-bold text-primary"})],-1)),t("div",ye,[t("div",be,[t("div",ge,[t("div",he,[t("h3",fe,v(f.value[0]),1),e[8]||(e[8]=t("p",{class:"fw-bold mb-0"},"On Hire (UIC)",-1))])])]),t("div",we,[t("div",ke,[t("div",xe,[t("h3",De,[t("span",Ce,v(p.value[1])+"%",1),e[9]||(e[9]=D(" || ")),t("span",Se,v(p.value[0]),1)]),e[10]||(e[10]=t("p",{class:"fw-bold mb-0"},"PA Unit",-1))])])]),t("div",Ue,[t("div",Te,[t("div",Be,[t("h3",Ve,[t("span",Fe,v(y.value[1])+"%",1),e[11]||(e[11]=D(" || ")),t("span",Ae,v(y.value[0]),1)]),e[12]||(e[12]=t("p",{class:"fw-bold mb-0"},"PA Rental",-1))])])])])]),t("ul",Ie,[(n(),i(O,null,oe(Q,a=>t("li",{class:"nav-item",key:a.value},[t("button",{class:ne(["nav-link",{active:l.value===a.value}]),onClick:r=>l.value=a.value},v(a.label),11,Re)])),64))])]),l.value===""||l.value==="site-summary"?(n(),i("div",Le,[b(re,{ref_key:"bigTableRef",ref:z,settings:G.value,urls:J.value,fields:K.value,canInsert:!1,canUpdate:!1},null,8,["settings","urls","fields"])])):u("",!0),l.value===""||["0","1","2","3"].includes(l.value)?(n(),i("div",Ee,[l.value===""||l.value==="0"?(n(),i("div",$e)):u("",!0),l.value===""||l.value==="0"?(n(),i("div",je,[t("div",Ne,[b(C,{ref_key:"chart11",ref:k,settings:g.value},null,8,["settings"])])])):u("",!0),l.value===""||l.value==="1"?(n(),i("div",Pe,[t("div",Oe,[b(C,{ref_key:"chart2",ref:F,settings:h.value},null,8,["settings"])])])):u("",!0),l.value===""||l.value==="2"?(n(),i("div",qe,[t("div",ze,[b(C,{settings:H.value},null,8,["settings"])])])):u("",!0),l.value===""||l.value==="3"?(n(),i("div",He,[t("div",Me,[b(C,{settings:M.value},null,8,["settings"])])])):u("",!0)])):u("",!0),e[14]||(e[14]=t("br",null,null,-1)),e[15]||(e[15]=t("br",null,null,-1)),e[16]||(e[16]=t("br",null,null,-1))],64))}},at=Y(Ge,[["__scopeId","data-v-889576a3"]]);export{at as default};
