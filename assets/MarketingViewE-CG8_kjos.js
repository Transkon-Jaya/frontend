import{r as e,p as a,o,c as l,a as n,m as t,E as u,b as s,v as r,t as i,f as p,z as d,q as m,g as c}from"./index-ymcskxsK.js";import{V as _,u as b,w as k}from"./xlsx-nBpVFcdQ.js";const w={class:"form-container"},v={key:0},y={key:1,class:"error"},f={key:0},h={key:1},g=["onUpdate:modelValue"],E={key:1},V={key:2},U=["onUpdate:modelValue"],q={key:1},x={key:3},C=["onUpdate:modelValue"],N={key:1},P={key:4},I=["onUpdate:modelValue"],D={key:1},M={key:5},S=["onUpdate:modelValue"],j={key:1},A={key:6},F=["onClick"],L="https://www.transkon-rent.com/api/marketing",H={__name:"MarketingViewE",setup(H){const K=e([]),O=e(!0),Q=e(null),z=e({name_customer:"",location:"",plan_hub:"",number_quot:"",no_spk_po_customer:""}),$=async()=>{try{const e=await m.post(L,{name_customer:z.value.name_customer,location:z.value.location,plan_hub:z.value.plan_hub,number_quot:z.value.number_quot,no_spk_po_customer:z.value.no_spk_po_customer});K.value.push({...e.data,id:parseInt(e.data.id,10),isEditing:!1}),z.value={name_customer:"",location:"",plan_hub:"",number_quot:"",no_spk_po_customer:""},alert("Inserted successfully!")}catch(e){alert("Failed to insert")}},B=()=>{const e=b.json_to_sheet(K.value),a=b.book_new();b.book_append_sheet(a,e,"Marketing Data"),k(a,"Marketing_Data.xlsx")},G=e([{label:"Actions",field:"actions"},{label:"ID",field:"id",sortable:!0,filterable:!0},{label:"Customer Name",field:"name_customer",sortable:!0,filterable:!0},{label:"Location",field:"location",sortable:!0,filterable:!0},{label:"Plan Hub",field:"plan_hub",sortable:!0,filterable:!0},{label:"Number Quot",field:"number_quot",sortable:!0,filterable:!0},{label:"No SPK PO Customer",field:"no_spk_po_customer",sortable:!0,filterable:!0}]),J=a((()=>K.value.map((e=>({...e,actions:e.isEditing?"Save":"Edit"})))));return o((async()=>{try{O.value=!0;const e=await m.get(L);K.value=e.data.map((e=>({...e,id:parseInt(e.id,10),isEditing:!1})))}catch(e){Q.value="Failed to fetch data"}finally{O.value=!1}})),(e,a)=>(c(),l("div",null,[a[6]||(a[6]=n("h2",null,"Marketing Data (Editable, Exportable, & Insertable)",-1)),n("div",w,[a[5]||(a[5]=n("h3",null,"Add New Entry",-1)),s(n("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>z.value.name_customer=e),placeholder:"Customer Name"},null,512),[[r,z.value.name_customer]]),s(n("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>z.value.location=e),placeholder:"Location"},null,512),[[r,z.value.location]]),s(n("input",{"onUpdate:modelValue":a[2]||(a[2]=e=>z.value.plan_hub=e),placeholder:"Plan Hub"},null,512),[[r,z.value.plan_hub]]),s(n("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>z.value.number_quot=e),placeholder:"Number Quot"},null,512),[[r,z.value.number_quot]]),s(n("input",{"onUpdate:modelValue":a[4]||(a[4]=e=>z.value.no_spk_po_customer=e),placeholder:"No SPK PO Customer"},null,512),[[r,z.value.no_spk_po_customer]]),n("button",{onClick:$},"Add New Entry")]),n("button",{onClick:B},"Export to Excel"),O.value?(c(),l("p",v,"Loading...")):t("",!0),Q.value?(c(),l("p",y,i(Q.value),1)):t("",!0),O.value||Q.value?t("",!0):(c(),u(d(_),{key:2,columns:G.value,rows:J.value,"pagination-options":{enabled:!0,mode:"pages",perPage:10},"search-options":{enabled:!0},"sort-options":{enabled:!0}},{"table-row":p((e=>["id"===e.column.field?(c(),l("span",f,i(e.row.id),1)):"name_customer"===e.column.field?(c(),l("span",h,[e.row.isEditing?s((c(),l("input",{key:0,"onUpdate:modelValue":a=>e.row.name_customer=a},null,8,g)),[[r,e.row.name_customer]]):(c(),l("span",E,i(e.row.name_customer),1))])):"location"===e.column.field?(c(),l("span",V,[e.row.isEditing?s((c(),l("input",{key:0,"onUpdate:modelValue":a=>e.row.location=a},null,8,U)),[[r,e.row.location]]):(c(),l("span",q,i(e.row.location),1))])):"plan_hub"===e.column.field?(c(),l("span",x,[e.row.isEditing?s((c(),l("input",{key:0,"onUpdate:modelValue":a=>e.row.plan_hub=a},null,8,C)),[[r,e.row.plan_hub]]):(c(),l("span",N,i(e.row.plan_hub),1))])):"number_quot"===e.column.field?(c(),l("span",P,[e.row.isEditing?s((c(),l("input",{key:0,"onUpdate:modelValue":a=>e.row.number_quot=a},null,8,I)),[[r,e.row.number_quot]]):(c(),l("span",D,i(e.row.number_quot),1))])):"no_spk_po_customer"===e.column.field?(c(),l("span",M,[e.row.isEditing?s((c(),l("input",{key:0,"onUpdate:modelValue":a=>e.row.no_spk_po_customer=a},null,8,S)),[[r,e.row.no_spk_po_customer]]):(c(),l("span",j,i(e.row.no_spk_po_customer),1))])):"actions"===e.column.field?(c(),l("span",A,[n("button",{onClick:a=>e.row.isEditing?(async e=>{try{await m.put(`${L}`,{id:e.id,name_customer:e.name_customer,location:e.location,plan_hub:e.plan_hub,number_quot:e.number_quot,no_spk_po_customer:e.no_spk_po_customer}),e.isEditing=!1,alert("Updated successfully!")}catch(a){alert("Failed to update")}})(e.row):e.row.isEditing=!0},i(e.row.isEditing?"Save":"Edit"),9,F)])):t("",!0)])),_:1},8,["columns","rows"]))]))}};export{H as default};
