import{u as B,r as v,m as F,o as S,x as y,c as f,a as s,q as C,p as g,b as r,v as n,d as P,f as x,V,g as c,h as U,y as D}from"./index-CG5MKjpj.js";import{l as E,a as M}from"./logger-B1IqVKgO.js";const A={class:"row"},T={class:"col-xl-6 mx-auto"},z={class:"card"},I={class:"card-body p-4"},_={class:"col-md-12"},$={class:"col-md-12"},j={class:"col-md-12"},q={class:"col-md-12"},L={class:"col-md-12"},R={class:"col-md-12"},G={class:"col-md-12"},H={class:"col-md-12"},J={key:0,class:"text-danger"},K={class:"col-md-12"},O={key:0,class:"mt-3"},Q=["src"],W={class:"col-md-12 mt-4 mb-3 d-flex gap-3"},m="Loading...",ee={__name:"ProfileView",setup(X){const d=B(),b=d.apiBaseUrl+"/profile",a=v({name:m,email:m,phone:m,department:m,position:m,username:m,password:"",confirmPassword:""}),t=new FormData,i=v(),p=v(null),h=l=>{p.value=l.target.files[0]},u=F(()=>a.value.password!==a.value.confirmPassword);S(async()=>{try{const l=await y.get(b,{headers:{Authorization:`Bearer ${d.token}`},params:{username:d.username}});i.value=l.data[0],w()}catch(l){console.error("Fetch error:",l)}});const w=()=>{a.value.name=i.value.name,a.value.email=i.value.email,a.value.phone=i.value.phone,a.value.department=i.value.department,a.value.position=i.value.jabatan,a.value.username=d.username,a.value.password="",a.value.confirmPassword=""},N=()=>{w()},k=async()=>{if(!u.value)try{t.append("name",a.value.name),t.append("email",a.value.email),t.append("phone",a.value.phone),t.append("department",a.value.department),t.append("position",a.value.position),t.append("username",a.value.username),a.value.password&&t.append("password",a.value.password),p.value&&t.append("profilePicture",p.value);const l=await y.post(b,t,{headers:{Authorization:`Bearer ${d.token}`}});d.setProfile(l.data.photo),E("user data : ",d.photo),await D(),window.location.reload(),alert("Profile updated successfully!")}catch(l){M("Submit error:",l),alert("Error updating profile.")}};return(l,e)=>(c(),f("div",A,[s("div",T,[s("div",z,[e[19]||(e[19]=s("div",{class:"card-header px-4 py-3"},[s("h5",{class:"mb-0"},"User Settings")],-1)),s("div",I,[s("form",{onSubmit:C(k,["prevent"]),class:"row g-3 needs-validation",novalidate:""},[s("div",_,[e[8]||(e[8]=s("label",{for:"Name",class:"form-label"},"Name",-1)),r(s("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>a.value.name=o),type:"text",class:"form-control",id:"firstName",disabled:""},null,512),[[n,a.value.name]])]),s("div",$,[e[9]||(e[9]=s("label",{for:"phone",class:"form-label"},"E-mail",-1)),r(s("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>a.value.email=o),type:"text",class:"form-control",id:"email"},null,512),[[n,a.value.email]])]),s("div",j,[e[10]||(e[10]=s("label",{for:"phone",class:"form-label"},"Phone",-1)),r(s("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>a.value.phone=o),type:"text",class:"form-control",id:"phone"},null,512),[[n,a.value.phone]])]),s("div",q,[e[11]||(e[11]=s("label",{for:"department",class:"form-label"},"Department",-1)),r(s("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>a.value.department=o),type:"text",class:"form-control",id:"department",disabled:""},null,512),[[n,a.value.department]])]),s("div",L,[e[12]||(e[12]=s("label",{for:"position",class:"form-label"},"Position",-1)),r(s("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>a.value.position=o),type:"text",class:"form-control",id:"position",disabled:""},null,512),[[n,a.value.position]])]),s("div",R,[e[13]||(e[13]=s("label",{for:"userName",class:"form-label"},"User Name",-1)),r(s("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>a.value.username=o),type:"userName",class:"form-control",id:"userName",disabled:""},null,512),[[n,a.value.username]])]),s("div",G,[e[14]||(e[14]=s("label",{for:"password",class:"form-label"},"Password",-1)),r(s("input",{"onUpdate:modelValue":e[6]||(e[6]=o=>a.value.password=o),type:"password",class:"form-control",id:"password"},null,512),[[n,a.value.password]])]),s("div",H,[e[15]||(e[15]=s("label",{for:"confirmationPassword",class:"form-label"},"Confirm Password",-1)),r(s("input",{"onUpdate:modelValue":e[7]||(e[7]=o=>a.value.confirmPassword=o),type:"password",class:"form-control",id:"confirmationPassword"},null,512),[[n,a.value.confirmPassword]])]),u.value?(c(),f("small",J," Passwords do not match! ")):g("",!0),s("div",K,[e[16]||(e[16]=s("label",{for:"photo",class:"form-label"},"Upload Photo",-1)),s("input",{type:"file",class:"form-control",id:"photo",onChange:h,accept:"image/*"},null,32),l.previewImage?(c(),f("div",O,[s("img",{src:l.previewImage,alt:"Preview",class:"img-thumbnail",style:{"max-width":"200px"}},null,8,Q)])):g("",!0)]),s("div",W,[P(V,{type:"submit",class:"btn btn-danger",disabled:u.value},{default:x(()=>e[17]||(e[17]=[U("Submit ")])),_:1},8,["disabled"]),P(V,{type:"reset",class:"btn btn-secondary",onClick:N},{default:x(()=>e[18]||(e[18]=[U(" Reset ")])),_:1})])],32)])])])]))}};export{ee as default};
