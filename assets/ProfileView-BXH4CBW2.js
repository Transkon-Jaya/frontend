import{u as F,r as v,l as S,o as C,q as y,c as f,a,p as D,n as g,b as r,v as n,d as P,f as x,V,g as c,h as U,s as E}from"./index-CtWxdhVx.js";import{l as h,a as M}from"./logger-B1IqVKgO.js";const A={class:"row"},T={class:"col-xl-6 mx-auto"},z={class:"card"},I={class:"card-body p-4"},_={class:"col-md-12"},$={class:"col-md-12"},j={class:"col-md-12"},q={class:"col-md-12"},L={class:"col-md-12"},R={class:"col-md-12"},G={class:"col-md-12"},H={class:"col-md-12"},J={key:0,class:"text-danger"},K={class:"col-md-12"},O={key:0,class:"mt-3"},Q=["src"],W={class:"col-md-12 mt-4 mb-3 d-flex gap-3"},m="Loading...",ee={__name:"ProfileView",setup(X){const d=F(),b=d.apiBaseUrl+"/profile",s=v({name:m,email:m,phone:m,department:m,position:m,username:m,password:"",confirmPassword:""}),t=new FormData,i=v(),p=v(null),N=l=>{p.value=l.target.files[0]},u=S(()=>s.value.password!==s.value.confirmPassword);C(async()=>{try{const l=await y.get(b,{headers:{Authorization:`Bearer ${d.token}`},params:{username:d.username}});i.value=l.data[0],w()}catch(l){console.error("Fetch error:",l)}});const w=()=>{s.value.name=i.value.name,s.value.email=i.value.email,s.value.phone=i.value.phone,s.value.department=i.value.department,s.value.position=i.value.jabatan,s.value.username=d.username,s.value.password="",s.value.confirmPassword=""},k=()=>{w()},B=async()=>{if(!u.value)try{t.append("name",s.value.name),t.append("email",s.value.email),t.append("phone",s.value.phone),t.append("department",s.value.department),t.append("position",s.value.position),t.append("username",s.value.username),s.value.password&&t.append("password",s.value.password),p.value&&t.append("profilePicture",p.value);const l=await y.post(b,t,{headers:{Authorization:`Bearer ${d.token}`}});h("update profile : ",l.data),d.setProfile(l.data.foto),h("user data : ",d.photo),await E(),window.location.reload(),alert("Profile updated successfully!")}catch(l){M("Submit error:",l),alert("Error updating profile.")}};return(l,e)=>(c(),f("div",A,[a("div",T,[a("div",z,[e[19]||(e[19]=a("div",{class:"card-header px-4 py-3"},[a("h5",{class:"mb-0"},"User Settings")],-1)),a("div",I,[a("form",{onSubmit:D(B,["prevent"]),class:"row g-3 needs-validation",novalidate:""},[a("div",_,[e[8]||(e[8]=a("label",{for:"Name",class:"form-label"},"Name",-1)),r(a("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>s.value.name=o),type:"text",class:"form-control",id:"firstName",disabled:""},null,512),[[n,s.value.name]])]),a("div",$,[e[9]||(e[9]=a("label",{for:"phone",class:"form-label"},"E-mail",-1)),r(a("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>s.value.email=o),type:"text",class:"form-control",id:"email"},null,512),[[n,s.value.email]])]),a("div",j,[e[10]||(e[10]=a("label",{for:"phone",class:"form-label"},"Phone",-1)),r(a("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>s.value.phone=o),type:"text",class:"form-control",id:"phone"},null,512),[[n,s.value.phone]])]),a("div",q,[e[11]||(e[11]=a("label",{for:"department",class:"form-label"},"Department",-1)),r(a("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>s.value.department=o),type:"text",class:"form-control",id:"department",disabled:""},null,512),[[n,s.value.department]])]),a("div",L,[e[12]||(e[12]=a("label",{for:"position",class:"form-label"},"Position",-1)),r(a("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>s.value.position=o),type:"text",class:"form-control",id:"position",disabled:""},null,512),[[n,s.value.position]])]),a("div",R,[e[13]||(e[13]=a("label",{for:"userName",class:"form-label"},"User Name",-1)),r(a("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>s.value.username=o),type:"userName",class:"form-control",id:"userName",disabled:""},null,512),[[n,s.value.username]])]),a("div",G,[e[14]||(e[14]=a("label",{for:"password",class:"form-label"},"Password",-1)),r(a("input",{"onUpdate:modelValue":e[6]||(e[6]=o=>s.value.password=o),type:"password",class:"form-control",id:"password"},null,512),[[n,s.value.password]])]),a("div",H,[e[15]||(e[15]=a("label",{for:"confirmationPassword",class:"form-label"},"Confirm Password",-1)),r(a("input",{"onUpdate:modelValue":e[7]||(e[7]=o=>s.value.confirmPassword=o),type:"password",class:"form-control",id:"confirmationPassword"},null,512),[[n,s.value.confirmPassword]])]),u.value?(c(),f("small",J," Passwords do not match! ")):g("",!0),a("div",K,[e[16]||(e[16]=a("label",{for:"photo",class:"form-label"},"Upload Photo",-1)),a("input",{type:"file",class:"form-control",id:"photo",onChange:N,accept:"image/*"},null,32),l.previewImage?(c(),f("div",O,[a("img",{src:l.previewImage,alt:"Preview",class:"img-thumbnail",style:{"max-width":"200px"}},null,8,Q)])):g("",!0)]),a("div",W,[P(V,{type:"submit",class:"btn btn-danger",disabled:u.value},{default:x(()=>e[17]||(e[17]=[U("Submit ")])),_:1},8,["disabled"]),P(V,{type:"reset",class:"btn btn-secondary",onClick:k},{default:x(()=>e[18]||(e[18]=[U(" Reset ")])),_:1})])],32)])])])]))}};export{ee as default};
