import{s as $}from"./vue-multiselect-DwCYs85F.js";import{_ as X,r as s,u as Y,A as d,w as Z,o as ee,G as te,c as i,a as e,n as u,h as x,t as v,m as j,C as N,d as y,f as ae,V as se,F as P,j as le,s as U,x as oe,g as n,y as ne}from"./index-CCYKs2DH.js";import{C as D}from"./Charts-DgHJII-P.js";/* empty css                                                                   */import{_ as re}from"./BigTable-Dat-28hp.js";import"./xlsx-DuKayiUy.js";/* empty css                            *//* empty css                                                 */const ie={class:"container-global mb-2"},ue={class:"d-flex justify-content-between align-items-center mb-2 mt-auto"},de={class:"text-end"},ce={class:"row align-items-end mb-4"},ve={class:"col-md-5"},me={class:"col-md-5"},_e={class:"col-md-2 text-end"},pe={class:"mb-2"},be={class:"row text-center mb-4"},ye={class:"col"},ge={class:"card border-success"},he={class:"card-body"},fe={class:"text-success"},we={class:"col"},ke={class:"card border-danger"},xe={class:"card-body"},De={class:"text-danger",style:{"text-align":"center"}},Se={style:{"margin-right":"10px"}},Ce={style:{"margin-left":"10px"}},Ue={class:"col"},Te={class:"card border-warning"},Be={class:"card-body"},Ve={class:"text-warning",style:{"text-align":"center"}},Fe={style:{"margin-right":"10px"}},Ae={style:{"margin-left":"10px"}},Ie={class:"nav nav-tabs"},Re=["onClick"],Le={key:0,class:"card mb-4"},Ee={key:1,class:"row g-4 mb-4"},$e={key:0,class:"col-md-12"},je={key:1,class:"col-md-12"},Ne={class:"card h-100"},Pe={key:2,class:"col-md-12"},Oe={class:"card h-100"},qe={key:3,class:"col-md-12"},ze={class:"card h-100"},He={key:4,class:"col-md-12"},Me={class:"card h-100"},Ge={__name:"DownEquipment",setup(Ke){const O=s(null),h=Y(),m=s(""),_=s(""),c=s(""),T=s([]),B=s([]),S=s(!0),q=s({title:"Daily Trend",type:"bar",api:{url:d+"/chart/de_running_total",params:[14,c.value,""]},columns:{label:["date"],datas:["running_total","daily_down","daily_done"]},colors:["red","orange","green"],labels:["Total Down","Units Down / Day","Units Done / Day"]}),f=s({title:"Daily Trend",type:"line",api:{url:d+"/chart/de_running_total",params:[14,c.value,""]},columns:{label:["date"],datas:["running_total","daily_down","daily_done"]},colors:["red","orange","green"],labels:["Total Down","Units Down / Day","Units Done / Day"]}),w=s({title:"Unit Summary",type:"pie",api:{url:d+"/chart/de_total_rental",params:["",""]},columns:{datas:["unit_rental","spare_exists_false","spare_exists_true"]},colors:["green","red","orange"],labels:["Unit Rental","PA Unit","PA Rental"]}),z=s({title:"Customer Summary",type:"bar",api:{url:d+"/chart/de_customer_summary"},columns:{label:["customer"],datas:["total_unit","total_break"]},colors:["green","red"],labels:["Total Unit","Total Break"]}),H=s({title:"Location Summary",type:"bar",api:{url:d+"/chart/de_location_summary"},columns:{label:["alt_location"],datas:["total_unit","total_break"]},colors:["green","red"],labels:["Total Unit","Total Break"]}),M=s({title:"Site Summary"}),G=s({firstCol:{label:"TK NO",field:"tk_no",type:"type"},merge:[{fields:["hour_in","hour_out"],to:"hour"},{fields:["jarak_in","jarak_out"],to:"jarak"}],priority:["customer","alt_location"],unpriority:["username","createdAt","lastUpdated"],hidden:["id","done"],toRemove:["vehicle_type","plate_no"],uneditable:["id","plan_hub"],checkbox:["spare_exists"],date:[],datetime:["down_since","estimated_return"]}),K=s({data:`${h.apiBaseUrl}/de_site`,dropdowns:{vehicle_type:{url:h.apiBaseUrl+"/dropdowns/vehicle_type",valueField:"vehicle_type",column:"vehicle_type"},tk_no:{url:h.apiBaseUrl+"/dropdowns/tk_no",valueField:"tk_no",column:"tk_no"}},get:{vehicle_type:{url:h.apiBaseUrl+"/get/vehicle_type",valueField:"vehicle_type",column:"vehicle_type"}}}),l=s(""),J=[{label:"All",value:""},{label:"Site Summary",value:"site-summary"},{label:"Daily Trend",value:"0"},{label:"Unit Summary",value:"1"},{label:"Customer Summary",value:"2"},{label:"Location Summary",value:"3"}],Q=async()=>{try{const o=await U.get(d+"/dropdowns/customer");T.value=o.data.map(a=>({label:a,value:a}));const t=await U.get(d+"/dropdowns/alt_location");B.value=t.data.map(a=>({label:a,value:a}))}catch(o){console.error("Error fetching dropdown data:",o)}};s();const V=s(),F=s(),k=async(o,t)=>{var a,r,L,E;o==="customer"?(m.value=t,f.value.api.params[1]=((a=m.value)==null?void 0:a.value)??"",w.value.api.params[0]=((r=m.value)==null?void 0:r.value)??""):(_.value=t,f.value.api.params[2]=((L=_.value)==null?void 0:L.value)??"",w.value.api.params[1]=((E=_.value)==null?void 0:E.value)??""),await F.value.renderChart(),await V.value.renderChart(),await C(),await oe()},g=s([0,0]),p=s([0,0]),b=s([0,0]),A=s("");function I(){const o=new Date,t=o.getHours().toString().padStart(2,"0"),a=o.getMinutes().toString().padStart(2,"0"),r=o.getSeconds().toString().padStart(2,"0");A.value=`${t}:${a}:${r}`}const C=async()=>{var o,t;try{const a=await U.get(d+"/chart/de_total_rental",{params:{params:[((o=m.value)==null?void 0:o.value)??"",((t=_.value)==null?void 0:t.value)??""]}}),r=a.data[0].unit_rental+a.data[0].spare_exists_false+a.data[0].spare_exists_true;g.value[0]=a.data[0].unit_rental,p.value[0]=a.data[0].spare_exists_false+a.data[0].spare_exists_true,b.value[0]=a.data[0].spare_exists_false,r===0?(g.value[1]=0,p.value[1]=0,b.value[1]=0):(g.value[1]=(g.value[0]/r*100).toFixed(2),p.value[1]=(100-p.value[0]/r*100).toFixed(2),b.value[1]=(100-b.value[0]/r*100).toFixed(2))}catch(a){console.error("Fetch error:",a)}};Z(c.value,async()=>{console.log("selectedItems : ",c.value),q.value.api.params[1]=c.value,f.value.api.params[1]=c.value,w.value.api.params[0]=c.value,await C()});let R;ee(async()=>{await Q(),await C(),S.value=!1,I(),R=setInterval(I,1e3)}),te(()=>{clearInterval(R)});const W=async()=>{k("customer",{label:"",value:""}),k("location",{label:"",value:""})};return(o,t)=>(n(),i(P,null,[e("div",ie,[e("div",ue,[t[4]||(t[4]=e("h1",{class:"h3 fw-bold mb-0"},[e("i",{class:"bi bi-car-front-fill me-2"}),x(" Down Equipment Dashboard ")],-1)),e("div",de,[e("div",null,v(A.value),1)])]),e("div",ce,[e("div",ve,[t[5]||(t[5]=e("label",{class:"form-label"},"Select Customer",-1)),S.value?u("",!0):(n(),j(N($),{key:0,modelValue:m.value,"onUpdate:modelValue":[t[0]||(t[0]=a=>m.value=a),t[1]||(t[1]=a=>k("customer",a))],options:T.value||[],placeholder:"Select Customer",label:"label","track-by":"value",class:"multiselect no-border"},null,8,["modelValue","options"]))]),e("div",me,[t[6]||(t[6]=e("label",{class:"form-label"},"Select Location",-1)),S.value?u("",!0):(n(),j(N($),{key:0,modelValue:_.value,"onUpdate:modelValue":[t[2]||(t[2]=a=>_.value=a),t[3]||(t[3]=a=>k("location",a))],options:B.value||[],placeholder:"Select Location",label:"label","track-by":"value",class:"multiselect no-border"},null,8,["modelValue","options"]))]),e("div",_e,[y(se,{type:"button",color:"danger",size:"md",block:!1,onClick:W},{default:ae(()=>t[7]||(t[7]=[x(" Reset Filter ")])),_:1})])]),e("div",pe,[t[13]||(t[13]=e("div",{class:"text-end"},[e("h5",{class:"fw-bold text-primary"})],-1)),e("div",be,[e("div",ye,[e("div",ge,[e("div",he,[e("h3",fe,v(g.value[0]),1),t[8]||(t[8]=e("p",{class:"fw-bold mb-0"},"On Hire (UIC)",-1))])])]),e("div",we,[e("div",ke,[e("div",xe,[e("h3",De,[e("span",Se,v(p.value[1])+"%",1),t[9]||(t[9]=x(" || ")),e("span",Ce,v(p.value[0]),1)]),t[10]||(t[10]=e("p",{class:"fw-bold mb-0"},"PA Unit",-1))])])]),e("div",Ue,[e("div",Te,[e("div",Be,[e("h3",Ve,[e("span",Fe,v(b.value[1])+"%",1),t[11]||(t[11]=x(" || ")),e("span",Ae,v(b.value[0]),1)]),t[12]||(t[12]=e("p",{class:"fw-bold mb-0"},"PA Rental",-1))])])])])]),e("ul",Ie,[(n(),i(P,null,le(J,a=>e("li",{class:"nav-item",key:a.value},[e("button",{class:ne(["nav-link",{active:l.value===a.value}]),onClick:r=>l.value=a.value},v(a.label),11,Re)])),64))])]),l.value===""||l.value==="site-summary"?(n(),i("div",Le,[y(re,{ref_key:"bigTableRef",ref:O,settings:M.value,urls:K.value,fields:G.value,canInsert:!1,canUpdate:!1},null,8,["settings","urls","fields"])])):u("",!0),l.value===""||["0","1","2","3"].includes(l.value)?(n(),i("div",Ee,[l.value===""||l.value==="0"?(n(),i("div",$e)):u("",!0),l.value===""||l.value==="0"?(n(),i("div",je,[e("div",Ne,[y(D,{ref_key:"chart11",ref:F,settings:f.value},null,8,["settings"])])])):u("",!0),l.value===""||l.value==="1"?(n(),i("div",Pe,[e("div",Oe,[y(D,{ref_key:"chart2",ref:V,settings:w.value},null,8,["settings"])])])):u("",!0),l.value===""||l.value==="2"?(n(),i("div",qe,[e("div",ze,[y(D,{settings:z.value},null,8,["settings"])])])):u("",!0),l.value===""||l.value==="3"?(n(),i("div",He,[e("div",Me,[y(D,{settings:H.value},null,8,["settings"])])])):u("",!0)])):u("",!0),t[14]||(t[14]=e("br",null,null,-1)),t[15]||(t[15]=e("br",null,null,-1)),t[16]||(t[16]=e("br",null,null,-1))],64))}},at=X(Ge,[["__scopeId","data-v-77aac003"]]);export{at as default};
