import{_ as L,r as u,n as A,o as I,c as l,a as e,q as v,t as o,s as V,b as c,v as y,k as O,l as B,h as b,F as U,j as h,p as M,A as $,g as i,z as H}from"./index-D-aC2Z3f.js";const q={class:"data-movement-container"},w={class:"form-section"},K={class:"form-group"},j={class:"form-group"},Y={class:"form-group"},z={class:"form-group"},G={class:"form-actions"},Q={type:"submit",class:"btn btn-primary"},J={class:"table-section"},W={class:"table-header"},X={class:"search-box"},Z={class:"table-responsive"},x={class:"data-table"},tt={key:0},et={key:0},at={key:0},st={class:"comment-cell"},ot={class:"action-buttons"},nt=["onClick"],lt=["onClick"],it={key:0},ut={key:0,class:"pagination"},dt=["disabled"],rt={class:"page-info"},vt=["disabled"],mt={key:0,class:"modal-overlay"},pt={class:"modal-content"},bt={class:"modal-actions"},C=10,ft={__name:"MasterMovement",setup(kt){const E=u([]),n=u({index:null,tk_no:"",date_movement:"",comment:"",status_unit_l:""}),f=u(!1),g=u(""),m=u("date_movement"),k=u("desc"),p=u(1),R=u(!1);u(null);const D=`${$}/api.php?request=movement`,_=A(()=>{let s=[...E.value];if(g.value){const t=g.value.toLowerCase();s=s.filter(a=>{var d,r,P,N;return((d=a.tk_no)==null?void 0:d.toLowerCase().includes(t))||((r=a.comment)==null?void 0:r.toLowerCase().includes(t))||((P=a.status_unit_l)==null?void 0:P.toLowerCase().includes(t))||((N=a.date_movement)==null?void 0:N.toLowerCase().includes(t))})}return m.value&&s.sort((t,a)=>{const d=t[m.value]||"",r=a[m.value]||"";return d<r?k.value==="asc"?-1:1:d>r?k.value==="asc"?1:-1:0}),s}),T=A(()=>Math.ceil(_.value.length/C));A(()=>{const s=(p.value-1)*C,t=s+C;return _.value.slice(s,t)});const S=async()=>{try{const s=await M.get(D);E.value=s.data,p.value=1}catch(s){console.error("Error fetching data:",s),alert("Gagal memuat data. Silakan coba lagi.")}},F=async()=>{try{f.value?await M.put(D,n.value):await M.post(D,n.value),resetForm(),await S(),alert(f.value?"Data berhasil diperbarui!":"Data berhasil ditambahkan!")}catch(s){console.error("Error saving data:",s),alert("Terjadi kesalahan saat menyimpan data.")}};return I(()=>{S()}),(s,t)=>(i(),l("div",q,[t[31]||(t[31]=e("h2",{class:"page-title"},"Master Movement",-1)),e("div",w,[e("h3",null,o(f.value?"Edit Data":"Tambah Data Baru"),1),e("form",{onSubmit:V(F,["prevent"]),class:"movement-form"},[e("div",K,[t[13]||(t[13]=e("label",{for:"tk_no"},"TK No:",-1)),c(e("input",{id:"tk_no","onUpdate:modelValue":t[0]||(t[0]=a=>n.value.tk_no=a),placeholder:"Masukkan TK No",required:"",class:"form-input"},null,512),[[y,n.value.tk_no]])]),e("div",j,[t[14]||(t[14]=e("label",{for:"date_movement"},"Tanggal Movement:",-1)),c(e("input",{id:"date_movement","onUpdate:modelValue":t[1]||(t[1]=a=>n.value.date_movement=a),type:"date",required:"",class:"form-input"},null,512),[[y,n.value.date_movement]])]),e("div",Y,[t[15]||(t[15]=e("label",{for:"comment"},"Comment:",-1)),c(e("textarea",{id:"comment","onUpdate:modelValue":t[2]||(t[2]=a=>n.value.comment=a),placeholder:"Masukkan komentar",class:"form-textarea"},null,512),[[y,n.value.comment]])]),e("div",z,[t[17]||(t[17]=e("label",{for:"status_unit_l"},"Status Unit:",-1)),c(e("select",{id:"status_unit_l","onUpdate:modelValue":t[3]||(t[3]=a=>n.value.status_unit_l=a),class:"form-select"},t[16]||(t[16]=[B('<option value="" data-v-1245fd9b>Pilih Status</option><option value="OPERATIONAL" data-v-1245fd9b>OPERATIONAL</option><option value="OFFHIRE" data-v-1245fd9b>OFFHIRE</option><option value="STANDBY SITE" data-v-1245fd9b>STANDBY SITE</option><option value="FOR RENTAL" data-v-1245fd9b>FOR RENTAL</option><option value="OPT CAR SITE" data-v-1245fd9b>OPT CAR SITE</option>',6)]),512),[[O,n.value.status_unit_l]])]),e("div",G,[e("button",Q,o(f.value?"Update Data":"Tambah Data"),1),f.value?(i(),l("button",{key:0,onClick:t[4]||(t[4]=(...a)=>s.resetForm&&s.resetForm(...a)),type:"button",class:"btn btn-secondary"}," Batal ")):v("",!0)])],32)]),e("div",J,[e("div",W,[t[19]||(t[19]=e("h3",null,"Daftar Data Movement",-1)),e("div",X,[c(e("input",{"onUpdate:modelValue":t[5]||(t[5]=a=>g.value=a),placeholder:"Cari data...",class:"search-input"},null,512),[[y,g.value]]),e("button",{onClick:S,class:"btn btn-refresh"},t[18]||(t[18]=[e("i",{class:"refresh-icon"},"↻",-1),b(" Refresh ")]))])]),e("div",Z,[e("table",x,[e("thead",null,[e("tr",null,[t[23]||(t[23]=e("th",null,"No",-1)),e("th",{onClick:t[6]||(t[6]=a=>s.sortData("tk_no")),class:"sortable"},[t[20]||(t[20]=b(" TK No ")),m.value==="tk_no"?(i(),l("span",tt,o(k.value==="asc"?"↑":"↓"),1)):v("",!0)]),e("th",{onClick:t[7]||(t[7]=a=>s.sortData("date_movement")),class:"sortable"},[t[21]||(t[21]=b(" Tanggal ")),m.value==="date_movement"?(i(),l("span",et,o(k.value==="asc"?"↑":"↓"),1)):v("",!0)]),t[24]||(t[24]=e("th",null,"Comment",-1)),e("th",{onClick:t[8]||(t[8]=a=>s.sortData("status_unit_l")),class:"sortable"},[t[22]||(t[22]=b(" Status ")),m.value==="status_unit_l"?(i(),l("span",at,o(k.value==="asc"?"↑":"↓"),1)):v("",!0)]),t[25]||(t[25]=e("th",null,"Aksi",-1))])]),e("tbody",null,[(i(!0),l(U,null,h(_.value,(a,d)=>(i(),l("tr",{key:a.index},[e("td",null,o((p.value-1)*C+d+1),1),e("td",null,o(a.tk_no),1),e("td",null,o(s.formatDate(a.date_movement)),1),e("td",st,o(a.comment),1),e("td",null,[e("span",{class:H(`status-badge ${s.getStatusClass(a.status_unit_l)}`)},o(a.status_unit_l),3)]),e("td",ot,[e("button",{onClick:r=>s.editData(a),class:"btn btn-edit"},t[26]||(t[26]=[e("i",{class:"edit-icon"},"✏️",-1),b(" Edit ")]),8,nt),e("button",{onClick:r=>s.confirmDelete(a.index),class:"btn btn-delete"},t[27]||(t[27]=[e("i",{class:"delete-icon"},"🗑️",-1),b(" Hapus ")]),8,lt)])]))),128)),_.value.length===0?(i(),l("tr",it,t[28]||(t[28]=[e("td",{colspan:"6",class:"no-data"},"Tidak ada data yang ditemukan",-1)]))):v("",!0)])])]),T.value>1?(i(),l("div",ut,[e("button",{onClick:t[9]||(t[9]=(...a)=>s.prevPage&&s.prevPage(...a)),disabled:p.value===1,class:"pagination-btn"}," « Sebelumnya ",8,dt),e("span",rt," Halaman "+o(p.value)+" dari "+o(T.value),1),e("button",{onClick:t[10]||(t[10]=(...a)=>s.nextPage&&s.nextPage(...a)),disabled:p.value===T.value,class:"pagination-btn"}," Selanjutnya » ",8,vt)])):v("",!0)]),R.value?(i(),l("div",mt,[e("div",pt,[t[29]||(t[29]=e("h3",null,"Konfirmasi Hapus Data",-1)),t[30]||(t[30]=e("p",null,"Apakah Anda yakin ingin menghapus data ini?",-1)),e("div",bt,[e("button",{onClick:t[11]||(t[11]=(...a)=>s.deleteData&&s.deleteData(...a)),class:"btn btn-confirm"},"Ya, Hapus"),e("button",{onClick:t[12]||(t[12]=(...a)=>s.cancelDelete&&s.cancelDelete(...a)),class:"btn btn-cancel"},"Batal")])])])):v("",!0)]))}},gt=L(ft,[["__scopeId","data-v-1245fd9b"]]);export{gt as default};
