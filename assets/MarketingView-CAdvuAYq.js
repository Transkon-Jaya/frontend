import{r as t,p as d,o as b,c as n,a as s,d as f,m as p,b as h,v as w,B as x,t as D,q as y,g as i}from"./index-DC2DhVwx.js";import{V as M,u,w as V}from"./xlsx-DKk7OYYM.js";/* empty css                            */const C={class:"actions"},N={key:0},B={key:1,class:"error"},F={__name:"MarketingView",setup(E){const o=t([]),c=t(!0),l=t(null),r=t(""),m=t(20);t(1),d(()=>o.value.length);const v=async()=>{try{const e=await y.get("https://www.transkon-rent.com/api/marketing");o.value=e.data}catch(e){l.value="Failed to load data",console.error(e)}finally{c.value=!1}},g=d(()=>r.value?o.value.filter(e=>e.name_customer.toLowerCase().includes(r.value.toLowerCase())):o.value),k=()=>{const e=u.json_to_sheet(o.value),a=u.book_new();u.book_append_sheet(a,e,"Marketing Data"),V(a,"MarketingData.xlsx")};return b(v),(e,a)=>(i(),n("div",null,[a[1]||(a[1]=s("h2",null,"Marketing Data",-1)),s("div",C,[h(s("input",{"onUpdate:modelValue":a[0]||(a[0]=_=>r.value=_),placeholder:"Search Customer Name..."},null,512),[[w,r.value]]),s("button",{onClick:k},"Export to Excel")]),f(x(M),{columns:[{label:"ID",field:"id",sortable:!0},{label:"Customer Name",field:"name_customer",sortable:!0},{label:"Location",field:"location",sortable:!0}],rows:g.value,"pagination-options":{enabled:!0,mode:"pages",perPage:m.value},"search-options":{enabled:!0,placeholder:"Search table"},"sort-options":{enabled:!0}},null,8,["rows","pagination-options"]),c.value?(i(),n("p",N,"Loading...")):p("",!0),l.value?(i(),n("p",B,D(l.value),1)):p("",!0)]))}};export{F as default};
