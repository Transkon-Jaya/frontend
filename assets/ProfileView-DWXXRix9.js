import{u as S,r as v,l as B,o as C,s as g,c as f,a as o,p as D,n as y,b as r,v as n,d as P,f as x,V,g as c,h as U,x as E}from"./index-CCav3FzQ.js";import{l as N,a as M}from"./logger-B1IqVKgO.js";const T={class:"row"},I={class:"col-xl-6 mx-auto"},_={class:"card"},j={class:"card-body p-4"},A={class:"col-md-12"},L={class:"col-md-12"},R={class:"col-md-12"},q={class:"col-md-12"},z={class:"col-md-12"},G={class:"col-md-12"},H={class:"col-md-12"},J={class:"col-md-12"},K={key:0,class:"text-danger"},O={class:"col-md-12"},Q={key:0,class:"mt-3"},W=["src"],X={class:"col-md-12 mt-4 mb-3 d-flex gap-3"},m="Loading...",ee={__name:"ProfileView",setup(Y){const d=S(),b=d.apiBaseUrl+"/profile",s=v({name:m,email:m,phone:m,department:m,position:m,username:m,password:"",confirmPassword:""}),t=new FormData,i=v(),p=v(null),h=l=>{p.value=l.target.files[0]},u=B(()=>s.value.password!==s.value.confirmPassword);C(async()=>{console.log("Photo : ",d.photo);try{const l=await g.get(b,{params:{username:d.username}});i.value=l.data[0],w()}catch(l){console.error("Fetch error:",l)}});const w=()=>{s.value.name=i.value.name,s.value.email=i.value.email,s.value.phone=i.value.phone,s.value.department=i.value.department,s.value.position=i.value.jabatan,s.value.username=d.username,s.value.password="",s.value.confirmPassword=""},F=()=>{w()},k=async()=>{if(!u.value)try{t.append("name",s.value.name),t.append("email",s.value.email),t.append("phone",s.value.phone),t.append("department",s.value.department),t.append("position",s.value.position),t.append("username",s.value.username),s.value.password&&t.append("password",s.value.password),p.value&&t.append("profilePicture",p.value);const l=await g.post(b,t);N("update profile : ",l.data),d.setProfile(l.data.foto),N("user data : ",d.photo),await E(),window.location.reload(),alert("Profile updated successfully!")}catch(l){M("Submit error:",l),alert("Error updating profile.")}};return(l,e)=>(c(),f("div",T,[o("div",I,[o("div",_,[e[19]||(e[19]=o("div",{class:"card-header px-4 py-3"},[o("h5",{class:"mb-0"},"User Settings")],-1)),o("div",j,[o("form",{onSubmit:D(k,["prevent"]),class:"row g-3 needs-validation",novalidate:""},[o("div",A,[e[8]||(e[8]=o("label",{for:"Name",class:"form-label"},"Name",-1)),r(o("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>s.value.name=a),type:"text",class:"form-control",id:"firstName",disabled:""},null,512),[[n,s.value.name]])]),o("div",L,[e[9]||(e[9]=o("label",{for:"phone",class:"form-label"},"E-mail",-1)),r(o("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>s.value.email=a),type:"text",class:"form-control",id:"email"},null,512),[[n,s.value.email]])]),o("div",R,[e[10]||(e[10]=o("label",{for:"phone",class:"form-label"},"Phone",-1)),r(o("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>s.value.phone=a),type:"text",class:"form-control",id:"phone"},null,512),[[n,s.value.phone]])]),o("div",q,[e[11]||(e[11]=o("label",{for:"department",class:"form-label"},"Department",-1)),r(o("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>s.value.department=a),type:"text",class:"form-control",id:"department",disabled:""},null,512),[[n,s.value.department]])]),o("div",z,[e[12]||(e[12]=o("label",{for:"position",class:"form-label"},"Position",-1)),r(o("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>s.value.position=a),type:"text",class:"form-control",id:"position",disabled:""},null,512),[[n,s.value.position]])]),o("div",G,[e[13]||(e[13]=o("label",{for:"userName",class:"form-label"},"User Name",-1)),r(o("input",{"onUpdate:modelValue":e[5]||(e[5]=a=>s.value.username=a),type:"userName",class:"form-control",id:"userName",disabled:""},null,512),[[n,s.value.username]])]),o("div",H,[e[14]||(e[14]=o("label",{for:"password",class:"form-label"},"Password",-1)),r(o("input",{"onUpdate:modelValue":e[6]||(e[6]=a=>s.value.password=a),type:"password",class:"form-control",id:"password"},null,512),[[n,s.value.password]])]),o("div",J,[e[15]||(e[15]=o("label",{for:"confirmationPassword",class:"form-label"},"Confirm Password",-1)),r(o("input",{"onUpdate:modelValue":e[7]||(e[7]=a=>s.value.confirmPassword=a),type:"password",class:"form-control",id:"confirmationPassword"},null,512),[[n,s.value.confirmPassword]])]),u.value?(c(),f("small",K," Passwords do not match! ")):y("",!0),o("div",O,[e[16]||(e[16]=o("label",{for:"photo",class:"form-label"},"Upload Photo",-1)),o("input",{type:"file",class:"form-control",id:"photo",onChange:h,accept:"image/*"},null,32),l.previewImage?(c(),f("div",Q,[o("img",{src:l.previewImage,alt:"Preview",class:"img-thumbnail",style:{"max-width":"200px"}},null,8,W)])):y("",!0)]),o("div",X,[P(V,{type:"submit",class:"btn btn-danger",disabled:u.value},{default:x(()=>e[17]||(e[17]=[U("Submit ")])),_:1},8,["disabled"]),P(V,{type:"reset",class:"btn btn-secondary",onClick:F},{default:x(()=>e[18]||(e[18]=[U(" Reset ")])),_:1})])],32)])])])]))}};export{ee as default};
