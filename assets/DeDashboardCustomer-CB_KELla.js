import{s as a}from"./vue-multiselect-C1ZQBWzF.js";import{_ as e,r as l,u as t,A as s,w as r,o as i,G as n,c as o,m as u,a as d,d as c,z as v,t as m,h as p,F as _,j as y,f as b,H as g,q as h,C as w,g as f,y as x}from"./index-C57kw19F.js";import{C as k}from"./Charts-Deneuk2l.js";import{R as D}from"./RouterLink-CKFX04Bo.js";import{_ as S}from"./BigTable-Dw0ACy3U.js";/* empty css                                                                   */import"./xlsx-Bzg_cIzL.js";const U={key:0},C={class:"mb-2"},T={class:"text-end"},j={class:"row text-center mb-4"},B={class:"col"},R={class:"card border-success"},A={class:"card-body"},F={class:"text-success"},I={class:"col"},q={class:"card border-danger"},H={class:"card-body"},L={class:"text-danger",style:{"text-align":"center"}},P={style:{"margin-right":"10px"}},$={style:{"margin-left":"10px"}},z={class:"col"},E={class:"card border-warning"},V={class:"card-body"},G={class:"text-warning",style:{"text-align":"center"}},O={style:{"margin-right":"10px"}},K={style:{"margin-left":"10px"}},M={class:"nav nav-tabs"},N=["onClick"],J={key:1,class:"card mb-4"},Q={class:"card-body"},W={key:2,class:"row g-4 mb-4"},X={key:0,class:"col-md-12"},Y={key:1,class:"col-md-12"},Z={class:"card h-100"},aa={key:2,class:"col-md-12"},ea={class:"card h-100"},la={key:3,class:"col-md-12"},ta={class:"card h-100"},sa={key:4,class:"col-md-12"},ra={class:"card h-100"},ia=e({__name:"DeDashboardCustomer",setup(e){const ia=l(null),na=t(),oa=l(""),ua=l(""),da=l([]),ca=l(!0),va=l({title:"Daily Trend",type:"bar",api:{url:s+"/chart/de_running_total",params:[14,ua.value,""]},columns:{label:["date"],datas:["running_total","daily_down","daily_done"]},colors:["red","orange","green"],labels:["Total Down","Units Down / Day","Units Done / Day"]}),ma=l({title:"Daily Trend",type:"line",api:{url:s+"/chart/de_running_total",params:[14,ua.value,""]},columns:{label:["date"],datas:["running_total","daily_down","daily_done"]},colors:["red","orange","green"],labels:["Total Down","Units Down / Day","Units Done / Day"]}),pa=l({title:"Unit Summary",type:"pie",api:{url:s+"/chart/de_total_rental",params:[ua.value,""]},columns:{datas:["unit_rental","spare_exists_false","spare_exists_true"]},colors:["green","red","orange"],labels:["Unit Rental","PA Unit","PA Rental"]}),_a=l({title:"Customer Summary",type:"bar",api:{url:s+"/chart/de_customer_summary"},columns:{label:["customer"],datas:["total_unit","total_break"]},colors:["green","red"],labels:["Total Unit","Total Break"]}),ya=l({title:"Location Summary",type:"bar",api:{url:s+"/chart/de_location_summary"},columns:{label:["alt_location"],datas:["total_unit","total_break"]},colors:["green","red"],labels:["Total Unit","Total Break"]}),ba=l({title:""}),ga=l({firstCol:{label:"TK NO",field:"tk_no",type:"type"},merge:[{fields:["hour_in","hour_out"],to:"hour"},{fields:["jarak_in","jarak_out"],to:"jarak"}],priority:["customer","alt_location"],unpriority:["username","createdAt","lastUpdated"],hidden:["id","done"],toRemove:["vehicle_type","plate_no"],uneditable:["id","plan_hub"],checkbox:["spare_exists"],date:[],datetime:["down_since","estimated_return"]}),ha=l({data:`${na.apiBaseUrl}/de_site`,dropdowns:{vehicle_type:{url:na.apiBaseUrl+"/dropdowns/vehicle_type",valueField:"vehicle_type",column:"vehicle_type"},tk_no:{url:na.apiBaseUrl+"/dropdowns/tk_no",valueField:"tk_no",column:"tk_no"}},get:{vehicle_type:{url:na.apiBaseUrl+"/get/vehicle_type",valueField:"vehicle_type",column:"vehicle_type"}}}),wa=l(""),fa=[{label:"All",value:""},{label:"Site Summary",value:"site-summary"},{label:"Daily Trend",value:"0"},{label:"Unit Summary",value:"1"},{label:"Customer Summary",value:"2"},{label:"Location Summary",value:"3"}];l();const xa=l(),ka=l([0,0]),Da=l([0,0]),Sa=l([0,0]),Ua=l("");function Ca(){const a=new Date,e=a.getHours().toString().padStart(2,"0"),l=a.getMinutes().toString().padStart(2,"0"),t=a.getSeconds().toString().padStart(2,"0");Ua.value=`${e}:${l}:${t}`}const Ta=async()=>{try{const a=await h.get(s+"/chart/de_total_rental",{params:{params:[ua.value,""]}}),e=a.data[0].unit_rental+a.data[0].spare_exists_false+a.data[0].spare_exists_true;ka.value[0]=a.data[0].unit_rental,Da.value[0]=a.data[0].spare_exists_false+a.data[0].spare_exists_true,Sa.value[0]=a.data[0].spare_exists_false,0===e?(ka.value[1]=0,Da.value[1]=0,Sa.value[1]=0):(ka.value[1]=(ka.value[0]/e*100).toFixed(2),Da.value[1]=(Da.value[0]/e*100).toFixed(2),Sa.value[1]=(Sa.value[0]/e*100).toFixed(2))}catch(a){}};let ja;return r(ua.value,(async()=>{va.value.api.params[1]=ua.value,ma.value.api.params[1]=ua.value,pa.value.api.params[0]=ua.value,await Ta()})),i((async()=>{await(async()=>{try{const a=await h.get(s+"/dropdowns/customer");da.value=a.data.map((a=>({label:a,value:a})))}catch(a){}})(),await Ta(),ca.value=!1,Ca(),ja=setInterval(Ca,1e3)})),n((()=>{clearInterval(ja)})),(e,l)=>(f(),o("div",{class:"content",style:g({paddingTop:e.showHeader?"100px":"0px"})},[ca.value?u("",!0):(f(),o("div",U,[l[2]||(l[2]=d("label",{for:"dropdown",class:"form-label"},"Select Customer",-1)),c(v(a),{modelValue:oa.value,"onUpdate:modelValue":[l[0]||(l[0]=a=>oa.value=a),l[1]||(l[1]=a=>(async a=>{oa.value=a,ua.value=oa.value.value,va.value.api.params[1]=ua.value,ma.value.api.params[1]=ua.value,await xa.value.renderChart(),await Ta(),await w()})(a))],options:da.value||[],placeholder:"Select Customer",label:"label","track-by":"value",class:"multiselect no-border"},null,8,["modelValue","options"])])),d("div",C,[l[9]||(l[9]=d("h1",{class:"h4 fw-bold"},"Down Equipment Dashboard",-1)),d("div",T,[l[3]||(l[3]=d("h5",{class:"fw-bold text-primary"},null,-1)),d("div",null,m(Ua.value),1)]),d("div",j,[d("div",B,[d("div",R,[d("div",A,[d("h3",F,m(ka.value[0]),1),l[4]||(l[4]=d("p",{class:"fw-bold mb-0"},"On Hire (UIC)",-1))])])]),d("div",I,[d("div",q,[d("div",H,[d("h3",L,[d("span",P,m(Da.value[1])+"%",1),l[5]||(l[5]=p(" || ")),d("span",$,m(Da.value[0]),1)]),l[6]||(l[6]=d("p",{class:"fw-bold mb-0"},"PA Unit",-1))])])]),d("div",z,[d("div",E,[d("div",V,[d("h3",G,[d("span",O,m(Sa.value[1])+"%",1),l[7]||(l[7]=p(" || ")),d("span",K,m(Sa.value[0]),1)]),l[8]||(l[8]=d("p",{class:"fw-bold mb-0"},"PA Rental",-1))])])])])]),d("ul",M,[(f(),o(_,null,y(fa,(a=>d("li",{class:"nav-item",key:a.value},[d("button",{class:x(["nav-link",{active:wa.value===a.value}]),onClick:e=>wa.value=a.value},m(a.label),11,N)]))),64))]),""===wa.value||"site-summary"===wa.value?(f(),o("div",J,[d("div",Q,[l[10]||(l[10]=d("h5",{class:"card-title text-danger"},"Site Summary",-1)),c(S,{ref_key:"bigTableRef",ref:ia,settings:ba.value,urls:ha.value,fields:ga.value,canInsert:!1,canUpdate:!1},null,8,["settings","urls","fields"])])])):u("",!0),""===wa.value||["0","1","2","3"].includes(wa.value)?(f(),o("div",W,[""===wa.value||"0"===wa.value?(f(),o("div",X)):u("",!0),""===wa.value||"0"===wa.value?(f(),o("div",Y,[d("div",Z,[c(k,{ref_key:"chart11",ref:xa,settings:ma.value},null,8,["settings"])])])):u("",!0),""===wa.value||"1"===wa.value?(f(),o("div",aa,[d("div",ea,[c(k,{settings:pa.value},null,8,["settings"])])])):u("",!0),""===wa.value||"2"===wa.value?(f(),o("div",la,[d("div",ta,[c(k,{settings:_a.value},null,8,["settings"])])])):u("",!0),""===wa.value||"3"===wa.value?(f(),o("div",sa,[d("div",ra,[c(k,{settings:ya.value},null,8,["settings"])])])):u("",!0)])):u("",!0),d("div",null,[c(D,{to:"/de/down-equipment",color:"danger",size:"md"},{default:b((()=>l[11]||(l[11]=[p("Back to Down Equipment")]))),_:1})])],4))}},[["__scopeId","data-v-b4a43938"]]);export{ia as default};
//# sourceMappingURL=DeDashboardCustomer-CB_KELla.js.map
