import{s as z}from"./vue-multiselect-DrEkZ-gG.js";import{_ as X,r as s,u as Y,A as d,w as Z,o as ee,J as te,c as i,a as e,q as u,h as x,t as m,K as E,y as j,d as g,f as ae,V as se,F as N,j as le,p as C,B as oe,g as n,z as ne}from"./index-DtjpuImB.js";import{C as D}from"./Charts-CtEwqaPD.js";/* empty css                                                                   */import{_ as re}from"./BigTable-CVPMbKZw.js";import"./chart-BSyum5xv.js";import"./vue-good-table.esm-BwmtRVXd.js";/* empty css                            */import"./xlsx-D1NZSDnX.js";import"./logger-DsocdAuK.js";/* empty css                                                 */const ie={class:"container-global mb-2"},ue={class:"d-flex justify-content-between align-items-center mb-2 mt-auto"},de={class:"text-end"},ce={class:"row align-items-end mb-4"},ve={class:"col-md-5"},me={class:"col-md-5"},_e={class:"col-md-2 text-end"},pe={class:"mb-2"},be={class:"row text-center mb-4"},ye={class:"col"},ge={class:"card border-success"},he={class:"card-body"},fe={class:"text-success"},we={class:"col"},ke={class:"card border-danger"},xe={class:"card-body"},De={class:"text-danger",style:{"text-align":"center"}},Se={style:{"margin-right":"10px"}},Ue={style:{"margin-left":"10px"}},Ce={class:"col"},Be={class:"card border-warning"},Te={class:"card-body"},Ae={class:"text-warning",style:{"text-align":"center"}},Ve={style:{"margin-right":"10px"}},Fe={style:{"margin-left":"10px"}},Ie={class:"nav nav-tabs"},Le=["onClick"],Re={key:0,class:"card mb-4"},$e={key:1,class:"row g-4 mb-4"},ze={key:0,class:"col-md-12"},Ee={key:1,class:"col-md-12"},je={class:"card h-100"},Ne={key:2,class:"col-md-12"},Pe={class:"card h-100"},qe={key:3,class:"col-md-12"},Oe={class:"card h-100"},He={key:4,class:"col-md-12"},Ke={class:"card h-100"},Me={__name:"DownEquipment",setup(Je){const P=s(null),c=Y(),_=s(""),p=s(""),v=s(""),B=s([]),T=s([]),S=s(!0),q=s({title:"Daily Trend",type:"bar",api:{url:d+"/chart/de_running_total",params:[14,v.value,""]},columns:{label:["date"],datas:["running_total","daily_down","daily_done"]},colors:["red","orange","green"],labels:["Total Down","Units Down / Day","Units Done / Day"]}),f=s({title:"Daily Trend",type:"line",api:{url:d+"/chart/de_running_total",params:[14,v.value,""]},columns:{label:["date"],datas:["running_total","daily_down","daily_done"]},colors:["red","orange","green"],labels:["Total Down","Units Down / Day","Units Done / Day"]}),w=s({title:"Unit Summary",type:"pie",api:{url:d+"/chart/de_total_rental",params:["",""]},columns:{datas:["unit_rental","spare_exists_false","spare_exists_true"]},colors:["green","red","orange"],labels:["Unit Rental","PA Unit","PA Rental"]}),O=s({title:"Customer Summary",type:"bar",api:{url:d+"/chart/de_customer_summary"},columns:{label:["customer"],datas:["total_unit","total_break"]},colors:["green","red"],labels:["Total Unit","Total Break"]}),H=s({title:"Location Summary",type:"bar",api:{url:d+"/chart/de_location_summary"},columns:{label:["alt_location"],datas:["total_unit","total_break"]},colors:["green","red"],labels:["Total Unit","Total Break"]}),K=s({title:"Site Summary"}),M=s({firstCol:{label:"TK NO",field:"tk_no",type:"type"},merge:[{fields:["hour_in","hour_out"],to:"hour"},{fields:["jarak_in","jarak_out"],to:"jarak"}],priority:["customer","alt_location"],unpriority:["username","createdAt","lastUpdated"],hidden:["id","done"],toRemove:["vehicle_type","plate_no"],uneditable:["id","plan_hub"],checkbox:["spare_exists"],date:[],datetime:["down_since","estimated_return"]}),J=s({data:`${c.apiBaseUrl}/de_site`,dropdowns:{vehicle_type:{url:c.apiBaseUrl+"/dropdowns/vehicle_type",valueField:"vehicle_type",column:"vehicle_type"},tk_no:{url:c.apiBaseUrl+"/dropdowns/tk_no",valueField:"tk_no",column:"tk_no"}},get:{vehicle_type:{url:c.apiBaseUrl+"/get/vehicle_type",valueField:"vehicle_type",column:"vehicle_type"}}}),l=s(""),G=[{label:"All",value:""},{label:"Site Summary",value:"site-summary"},{label:"Daily Trend",value:"0"},{label:"Unit Summary",value:"1"},{label:"Customer Summary",value:"2"},{label:"Location Summary",value:"3"}],Q=async()=>{try{const o=await C.get(d+"/dropdowns/customer",{headers:{Authorization:`Bearer ${c.token}`}});B.value=o.data.map(a=>({label:a,value:a}));const t=await C.get(d+"/dropdowns/alt_location",{headers:{Authorization:`Bearer ${c.token}`}});T.value=t.data.map(a=>({label:a,value:a}))}catch(o){console.error("Error fetching dropdown data:",o)}};s();const A=s(),V=s(),k=async(o,t)=>{var a,r,R,$;o==="customer"?(_.value=t,f.value.api.params[1]=((a=_.value)==null?void 0:a.value)??"",w.value.api.params[0]=((r=_.value)==null?void 0:r.value)??""):(p.value=t,f.value.api.params[2]=((R=p.value)==null?void 0:R.value)??"",w.value.api.params[1]=(($=p.value)==null?void 0:$.value)??""),await V.value.renderChart(),await A.value.renderChart(),await U(),await oe()},h=s([0,0]),b=s([0,0]),y=s([0,0]),F=s("");function I(){const o=new Date,t=o.getHours().toString().padStart(2,"0"),a=o.getMinutes().toString().padStart(2,"0"),r=o.getSeconds().toString().padStart(2,"0");F.value=`${t}:${a}:${r}`}const U=async()=>{var o,t;try{const a=await C.get(d+"/chart/de_total_rental",{headers:{Authorization:`Bearer ${c.token}`},params:{params:[((o=_.value)==null?void 0:o.value)??"",((t=p.value)==null?void 0:t.value)??""]}}),r=a.data[0].unit_rental+a.data[0].spare_exists_false+a.data[0].spare_exists_true;h.value[0]=a.data[0].unit_rental,b.value[0]=a.data[0].spare_exists_false+a.data[0].spare_exists_true,y.value[0]=a.data[0].spare_exists_false,r===0?(h.value[1]=0,b.value[1]=0,y.value[1]=0):(h.value[1]=(h.value[0]/r*100).toFixed(2),b.value[1]=(100-b.value[0]/r*100).toFixed(2),y.value[1]=(100-y.value[0]/r*100).toFixed(2))}catch(a){console.error("Fetch error:",a)}};Z(v.value,async()=>{console.log("selectedItems : ",v.value),q.value.api.params[1]=v.value,f.value.api.params[1]=v.value,w.value.api.params[0]=v.value,await U()});let L;ee(async()=>{await Q(),await U(),S.value=!1,I(),L=setInterval(I,1e3)}),te(()=>{clearInterval(L)});const W=async()=>{k("customer",{label:"",value:""}),k("location",{label:"",value:""})};return(o,t)=>(n(),i(N,null,[e("div",ie,[e("div",ue,[t[4]||(t[4]=e("h1",{class:"h3 fw-bold mb-0"},[e("i",{class:"bi bi-car-front-fill me-2"}),x(" Down Equipment Dashboard ")],-1)),e("div",de,[e("div",null,m(F.value),1)])]),e("div",ce,[e("div",ve,[t[5]||(t[5]=e("label",{class:"form-label"},"Select Location",-1)),S.value?u("",!0):(n(),E(j(z),{key:0,modelValue:p.value,"onUpdate:modelValue":[t[0]||(t[0]=a=>p.value=a),t[1]||(t[1]=a=>k("location",a))],options:T.value||[],placeholder:"Select Location",label:"label",selectedLocation:"","track-by":"value",class:"multiselect no-border"},null,8,["modelValue","options"]))]),e("div",me,[t[6]||(t[6]=e("label",{class:"form-label"},"Select Customer",-1)),S.value?u("",!0):(n(),E(j(z),{key:0,modelValue:_.value,"onUpdate:modelValue":[t[2]||(t[2]=a=>_.value=a),t[3]||(t[3]=a=>k("customer",a))],options:B.value||[],placeholder:"Select Customer",label:"label","track-by":"value",class:"multiselect no-border"},null,8,["modelValue","options"]))]),e("div",_e,[g(se,{type:"button",color:"danger",size:"md",block:!1,onClick:W},{default:ae(()=>t[7]||(t[7]=[x(" Reset Filter ")])),_:1})])]),e("div",pe,[t[13]||(t[13]=e("div",{class:"text-end"},[e("h5",{class:"fw-bold text-primary"})],-1)),e("div",be,[e("div",ye,[e("div",ge,[e("div",he,[e("h3",fe,m(h.value[0]),1),t[8]||(t[8]=e("p",{class:"fw-bold mb-0"},"On Hire (UIC)",-1))])])]),e("div",we,[e("div",ke,[e("div",xe,[e("h3",De,[e("span",Se,m(b.value[1])+"%",1),t[9]||(t[9]=x(" || ")),e("span",Ue,m(b.value[0]),1)]),t[10]||(t[10]=e("p",{class:"fw-bold mb-0"},"PA Unit",-1))])])]),e("div",Ce,[e("div",Be,[e("div",Te,[e("h3",Ae,[e("span",Ve,m(y.value[1])+"%",1),t[11]||(t[11]=x(" || ")),e("span",Fe,m(y.value[0]),1)]),t[12]||(t[12]=e("p",{class:"fw-bold mb-0"},"PA Rental",-1))])])])])]),e("ul",Ie,[(n(),i(N,null,le(G,a=>e("li",{class:"nav-item",key:a.value},[e("button",{class:ne(["nav-link",{active:l.value===a.value}]),onClick:r=>l.value=a.value},m(a.label),11,Le)])),64))])]),l.value===""||l.value==="site-summary"?(n(),i("div",Re,[g(re,{ref_key:"bigTableRef",ref:P,settings:K.value,urls:J.value,fields:M.value,canInsert:!1,canUpdate:!1},null,8,["settings","urls","fields"])])):u("",!0),l.value===""||["0","1","2","3"].includes(l.value)?(n(),i("div",$e,[l.value===""||l.value==="0"?(n(),i("div",ze)):u("",!0),l.value===""||l.value==="0"?(n(),i("div",Ee,[e("div",je,[g(D,{ref_key:"chart11",ref:V,settings:f.value},null,8,["settings"])])])):u("",!0),l.value===""||l.value==="1"?(n(),i("div",Ne,[e("div",Pe,[g(D,{ref_key:"chart2",ref:A,settings:w.value},null,8,["settings"])])])):u("",!0),l.value===""||l.value==="2"?(n(),i("div",qe,[e("div",Oe,[g(D,{settings:O.value},null,8,["settings"])])])):u("",!0),l.value===""||l.value==="3"?(n(),i("div",He,[e("div",Ke,[g(D,{settings:H.value},null,8,["settings"])])])):u("",!0)])):u("",!0),t[14]||(t[14]=e("br",null,null,-1)),t[15]||(t[15]=e("br",null,null,-1)),t[16]||(t[16]=e("br",null,null,-1))],64))}},ot=X(Me,[["__scopeId","data-v-dd3d07be"]]);export{ot as default};
