import{f as t,i as d,o as f,c as n,a as s,q as w,d as p,w as b,l as h,k as x,t as D,p as y,g as i}from"./index-CJDT_R6f.js";import{u,w as M,V}from"./xlsx-BWLgXIuo.js";const C={class:"actions"},N={key:0},E={key:1,class:"error"},T={__name:"MarketingView",setup(L){const o=t([]),c=t(!0),l=t(null),r=t(""),m=t(20);t(1),d(()=>o.value.length);const v=async()=>{try{const e=await y.get("https://www.transkon-rent.com/api/marketing");o.value=e.data}catch(e){l.value="Failed to load data",console.error(e)}finally{c.value=!1}},k=d(()=>r.value?o.value.filter(e=>e.name_customer.toLowerCase().includes(r.value.toLowerCase())):o.value),g=()=>{const e=u.json_to_sheet(o.value),a=u.book_new();u.book_append_sheet(a,e,"Marketing Data"),M(a,"MarketingData.xlsx")};return f(v),(e,a)=>(i(),n("div",null,[a[1]||(a[1]=s("h2",null,"Marketing Data",-1)),s("div",C,[b(s("input",{"onUpdate:modelValue":a[0]||(a[0]=_=>r.value=_),placeholder:"Search Customer Name..."},null,512),[[h,r.value]]),s("button",{onClick:g},"Export to Excel")]),w(x(V),{columns:[{label:"ID",field:"id",sortable:!0},{label:"Customer Name",field:"name_customer",sortable:!0},{label:"Location",field:"location",sortable:!0}],rows:k.value,"pagination-options":{enabled:!0,mode:"pages",perPage:m.value},"search-options":{enabled:!0,placeholder:"Search table"},"sort-options":{enabled:!0}},null,8,["rows","pagination-options"]),c.value?(i(),n("p",N,"Loading...")):p("",!0),l.value?(i(),n("p",E,D(l.value),1)):p("",!0)]))}};export{T as default};
