{"version":3,"file":"DeDashboard-CAJq5cVS.js","sources":["../../src/views/de/DeDashboard.vue"],"sourcesContent":["<script setup>\r\nimport { ref, watch, onMounted, onBeforeUnmount, nextTick } from \"vue\";\r\nimport axios from \"axios\";\r\nimport Charts from \"@/components/Charts.vue\";\r\nimport RouterLink from \"@/components/RouterLink.vue\" \r\nimport { API_BASE_URL } from \"@/config/config\";\r\nimport BigTable from \"@/components/BigTable.vue\";\r\nconst bigTableRef = ref(null);\r\n\r\nimport { useUserStore } from \"@/stores/user.js\";\r\nconst userData = useUserStore();\r\n\r\n//chart\r\nconst settings1 = ref({\r\n  title: \"Daily Trend\",\r\n  type: \"bar\",\r\n  api: {\r\n    url: API_BASE_URL + \"/chart/de_running_total\",\r\n    params: [14, \"\", \"\"], //days, customer, location\r\n  },\r\n  columns: {\r\n    label: [\"date\"],\r\n    datas: [\"running_total\", \"daily_down\", \"daily_done\"],\r\n  },\r\n  colors: [\"red\", \"orange\", \"green\"],\r\n  labels: [\"Total Down\", \"Units Down / Day\", \"Units Done / Day\"],\r\n});\r\n\r\nconst settings11 = ref({\r\n  title: \"Daily Trend\",\r\n  type: \"line\",\r\n  api: {\r\n    url: API_BASE_URL + \"/chart/de_running_total\",\r\n    params: [14, \"\", \"\"], //days, customer, location\r\n  },\r\n  columns: {\r\n    label: [\"date\"],\r\n    datas: [\"running_total\", \"daily_down\", \"daily_done\"],\r\n  },\r\n  colors: [\"red\", \"orange\", \"green\"],\r\n  labels: [\"Total Down\", \"Units Down / Day\", \"Units Done / Day\"],\r\n});\r\n\r\nconst settings2 = ref({\r\n  title: \"Unit Summary\",\r\n  type: \"pie\",\r\n  api: {\r\n    url: API_BASE_URL + \"/chart/de_total_rental\",\r\n    params: [\"\", \"\"]\r\n  },\r\n  columns: {\r\n    datas: [\"unit_rental\", \"spare_exists_false\", \"spare_exists_true\"],\r\n  },\r\n  colors: [\"green\", \"red\", \"orange\"],\r\n  labels: [\"Unit Rental\", \"PA Unit\", \"PA Rental\"],\r\n});\r\n\r\nconst settings3 = ref({\r\n  title: \"Customer Summary\",\r\n  type: \"bar\",\r\n  api: {\r\n    url: API_BASE_URL + \"/chart/de_customer_summary\",\r\n  },\r\n  columns: {\r\n    label: [\"customer\"],\r\n    datas: [\"total_unit\", \"total_break\"],\r\n  },\r\n  colors: [\"green\", \"red\"],\r\n  labels: [\"Total Unit\", \"Total Break\"],\r\n});\r\n\r\nconst settings4 = ref({\r\n  title: \"Location Summary\",\r\n  type: \"bar\",\r\n  api: {\r\n    url: API_BASE_URL + \"/chart/de_location_summary\"\r\n  },\r\n  columns: {\r\n    label: [\"alt_location\"],\r\n    datas: [\"total_unit\", \"total_break\"],\r\n  },\r\n  colors: [\"green\", \"red\"],\r\n  labels: [\"Total Unit\", \"Total Break\"],\r\n});\r\n\r\n// Tabs\r\nconst currentTab = ref(\"\");\r\nconst tabs = [\r\n  { label: \"All\", value: \"\" },\r\n  { label: \"Site Summary\", value: \"site-summary\" },\r\n  { label: \"Daily Trend\", value: \"0\" },\r\n  { label: \"Unit Summary\", value: \"1\" },\r\n  { label: \"Customer Summary\", value: \"2\" },\r\n  { label: \"Location Summary\", value: \"3\" },\r\n];\r\n\r\n// Table config\r\nconst settings = ref({ title: \"\" });\r\n\r\nconst formData = ref({});\r\n\r\nconst fields = ref({\r\n  firstCol: {label: \"TK NO\", field: \"tk_no\", type: \"type\"},\r\n  merge: [\r\n    { fields: [\"hour_in\", \"hour_out\"], to: \"hour\" },\r\n    { fields: [\"jarak_in\", \"jarak_out\"], to: \"jarak\" }\r\n  ],\r\n  priority: [\"customer\", \"alt_location\"],\r\n  unpriority: [\"username\", \"createdAt\", \"lastUpdated\"],\r\n  hidden: [\"id\", \"done\"],\r\n  toRemove: [\"vehicle_type\", \"plate_no\"],\r\n  uneditable: [\"id\", \"plan_hub\"],\r\n  checkbox: [\"spare_exists\"],\r\n  date: [],\r\n  datetime: [\"down_since\", \"estimated_return\"]\r\n});\r\n\r\nconst urls = ref({\r\n  data: `${userData.apiBaseUrl}/de_site`,\r\n  dropdowns: {\r\n    vehicle_type: {\r\n      url: userData.apiBaseUrl + \"/dropdowns/vehicle_type\",\r\n      valueField: \"vehicle_type\",\r\n      column: \"vehicle_type\"\r\n    },\r\n    tk_no: {\r\n      url: userData.apiBaseUrl + \"/dropdowns/tk_no\",\r\n      valueField: \"tk_no\",\r\n      column: \"tk_no\"\r\n    },\r\n  },\r\n  get: {\r\n    vehicle_type: {\r\n      url: userData.apiBaseUrl + \"/get/vehicle_type\",\r\n      valueField: \"vehicle_type\",\r\n      column: \"vehicle_type\"\r\n    }\r\n  }\r\n});\r\n\r\n// Status Count & Waktu\r\nconst workingCount = ref([0,0]);\r\nconst smDownCount = ref([0,0]);\r\nconst umDownCount = ref([0,0]);\r\nconst currentTime = ref('');\r\n\r\n// Update jam\r\nfunction updateClock() {\r\n  const now = new Date();\r\n  const hours = now.getHours().toString().padStart(2, \"0\");\r\n  const minutes = now.getMinutes().toString().padStart(2, \"0\");\r\n  const seconds = now.getSeconds().toString().padStart(2, \"0\");\r\n  currentTime.value = `${hours}:${minutes}:${seconds}`;\r\n}\r\n\r\n\r\nconst fetchTotal = async () => {\r\n  try {\r\n    const response = await axios.get(API_BASE_URL + \"/chart/de_total_rental\", {\r\n        params: {\r\n            params: [\"\", \"\"]\r\n        },\r\n    });\r\n    console.log(\"response : \", response.data);\r\n    const _total = response.data[0].unit_rental + response.data[0].spare_exists_false + response.data[0].spare_exists_true;\r\n    workingCount.value[0] = response.data[0].unit_rental;\r\n    smDownCount.value[0] = response.data[0].spare_exists_false + response.data[0].spare_exists_true;\r\n    umDownCount.value[0] = response.data[0].spare_exists_false;\r\n    workingCount.value[1] = (workingCount.value[0] / _total *  100).toFixed(2);\r\n    smDownCount.value[1] = (smDownCount.value[0] / _total * 100).toFixed(2);\r\n    umDownCount.value[1] = (umDownCount.value[0] / _total * 100).toFixed(2);\r\n    console.log(smDownCount.value);\r\n  } catch (error) {\r\n      console.error(\"Fetch error:\", error);\r\n  }\r\n};\r\n// Lifecycle\r\nonMounted(async () => {\r\n  // Inisialisasi form kosong\r\n  await fetchTotal();\r\n  \r\n  // Mulai jam berjalan\r\n  updateClock();\r\n  setInterval(updateClock, 1000);\r\n});\r\n\r\nonBeforeUnmount(() => {\r\n});\r\n</script>\r\n\r\n\r\n<template>\r\n  <div class=\"content\" :style=\"{ paddingTop: showHeader ? '100px' : '0px' }\">\r\n    <!-- Header -->\r\n    <div class=\"mb-2\">\r\n      <h1 class=\"h4 fw-bold\">Down Equipment Dashboard</h1>\r\n      <div class=\"text-end\">\r\n        <h5 class=\"fw-bold text-primary\"></h5>\r\n        <div>{{ currentTime }}</div>\r\n      </div>\r\n      <!-- Status Cards -->\r\n     <div class=\"row text-center mb-4\">\r\n      <div class=\"col\">\r\n        <div class=\"card border-success\">\r\n          <div class=\"card-body\">\r\n            <h3 class=\"text-success\">{{ workingCount[0] }}</h3>\r\n            <p class=\"fw-bold mb-0\">On Hire (UIC)</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"col\">\r\n        <div class=\"card border-danger\">\r\n          <div class=\"card-body\">\r\n            <h3 class=\"text-danger\"style=\"text-align: center;\">\r\n            <span style=\"margin-right: 10px;\">{{ smDownCount[1] }}%</span>\r\n            ||\r\n            <span style=\"margin-left: 10px;\">{{ smDownCount[0] }}</span>\r\n          </h3>\r\n            <p class=\"fw-bold mb-0\">PA Unit</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"col\">\r\n        <div class=\"card border-warning\">\r\n          <div class=\"card-body\">\r\n            <h3 class=\"text-warning\" style=\"text-align: center;\">\r\n            <span style=\"margin-right: 10px;\">{{ umDownCount[1] }}%</span>\r\n            ||\r\n            <span style=\"margin-left: 10px;\">{{ umDownCount[0] }}</span>\r\n            </h3>\r\n            <p class=\"fw-bold mb-0\">PA Rental</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    </div>\r\n     \r\n\r\n    <!-- Filter dan Tabs \r\n    <div class=\"mb-4\">\r\n      <div class=\"d-flex flex-wrap align-items-center gap-3 mb-3\">\r\n        <label>Select Range:</label>\r\n        <input type=\"date\" v-model=\"startDate\" class=\"form-control form-control-sm w-auto\" />\r\n        <span>to</span>\r\n        <input type=\"date\" v-model=\"endDate\" class=\"form-control form-control-sm w-auto\" />\r\n        <button @click=\"applyFilter\" class=\"btn btn-sm btn-danger\">Apply</button>\r\n      </div>\r\n      -->\r\n      \r\n\r\n      <!-- Tab Navigasi -->\r\n      <ul class=\"nav nav-tabs\">\r\n        <li class=\"nav-item\" v-for=\"tab in tabs\" :key=\"tab.value\">\r\n          <button\r\n            class=\"nav-link\"\r\n            :class=\"{ active: currentTab === tab.value }\"\r\n            @click=\"currentTab = tab.value\"\r\n          >\r\n            {{ tab.label }}\r\n          </button>\r\n        </li>\r\n      </ul>\r\n    \r\n\r\n    <!-- Site Summary -->\r\n    <div v-if=\"currentTab === '' || currentTab === 'site-summary'\" class=\"card mb-4\">\r\n      <div class=\"card-body\">\r\n        <h5 class=\"card-title text-danger\">Site Summary</h5>\r\n        <BigTable\r\n          ref=\"bigTableRef\"\r\n          :settings=\"settings\"\r\n          :urls=\"urls\"\r\n          :fields=\"fields\"\r\n          :canInsert=\"false\"\r\n          :canUpdate=\"false\"\r\n          ></BigTable>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Charts Section -->\r\n    <div v-if=\"currentTab === '' || ['0', '1', '2', '3'].includes(currentTab)\" class=\"row g-4 mb-4\">\r\n\r\n       <!-- Unit Down by Site -->\r\n  <div v-if=\"currentTab === '' || currentTab === '0'\" class=\"col-md-12\">\r\n        <div class=\"card h-100\"> \r\n            <Charts :settings=settings1></Charts>\r\n        </div>\r\n      </div>\r\n  <div v-if=\"currentTab === '' || currentTab === '0'\" class=\"col-md-12\">\r\n        <div class=\"card h-100\"> \r\n            <Charts :settings=settings11></Charts>\r\n        </div>\r\n  </div>\r\n\r\n      <!-- Unit Summary -->\r\n<div v-if=\"currentTab === '' || currentTab === '1'\" class=\"col-md-12\">\r\n  <div class=\"card h-100\">\r\n      <Charts :settings=settings2></Charts>\r\n  </div>\r\n</div>\r\n\r\n    \r\n      <!-- Customer Summary -->\r\n      <div v-if=\"currentTab === '' || currentTab === '2'\" class=\"col-md-12\">\r\n        <div class=\"card h-100\">\r\n            <Charts :settings=settings3></Charts>\r\n        </div>\r\n      </div>\r\n\r\n    <!-- Location Summary -->\r\n    <div v-if=\"currentTab === '' || currentTab === '3'\" class=\"col-md-12\">\r\n        <div class=\"card h-100\">\r\n            <Charts :settings=settings4></Charts>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n\r\n    <!-- Back Button \r\n    <div>\r\n      <RouterLink to=\"/de/down-equipment\" color=\"danger\" size=\"md\">Back to Down Equipment</RouterLink>\r\n    </div>-->\r\n  </div>\r\n</template>\r\n\r\n\r\n\r\n\r\n<style scoped>\r\n.border-success {\r\n  border: 2px solid #198754 !important; /* Bootstrap green */\r\n}\r\n.border-danger {\r\n  border: 2px solid #dc3545 !important; /* Bootstrap red */\r\n}\r\n.border-warning {\r\n  border: 2px solid #ffac07 !important; /* Bootstrap yellow */\r\n}\r\n.card h3 {\r\n  font-size: 28px;\r\n}\r\n\r\ncanvas {\r\n  width: 100% !important;\r\n  max-height: 300px;\r\n}\r\n.nav-tabs .nav-link.active {\r\n  background-color: #dc3545;\r\n  color: #fff;\r\n}\r\n.nav-tabs .nav-link {\r\n  color: #000; /* Warna hitam untuk text tab tidak aktif */\r\n}\r\n.card {\r\n  width: 100%;\r\n}\r\n</style>\r\n\r\n\r\n\r\n\r\n"],"names":["bigTableRef","ref","userData","useUserStore","settings1","API_BASE_URL","settings11","settings2","settings3","settings4","currentTab","tabs","settings","fields","urls","workingCount","smDownCount","umDownCount","currentTime","updateClock","now","hours","minutes","seconds","fetchTotal","response","axios","_total","error","onMounted","onBeforeUnmount"],"mappings":"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"}