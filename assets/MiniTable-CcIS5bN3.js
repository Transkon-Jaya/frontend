import{_ as e,r as l,p as a,o as t,c as n,a as s,b as o,t as u,v as c,F as i,j as r,m as d,k as m,y as v,q as p,g as f,h as g}from"./index-ymcskxsK.js";/* empty css                                                                  */const b={class:"container mt-4"},h={class:"card p-4 shadow-sm"},y={class:"d-flex justify-content-between align-items-center mb-3"},k={class:"fw-bold"},w=["placeholder"],x={class:"table-responsive"},_={class:"table table-hover align-middle"},j={class:"table-light"},C={class:"filter-row"},U=["placeholder","onUpdate:modelValue"],V=["onUpdate:modelValue"],T={value:""},L=["value"],M=["onClick"],O={key:0},S=["checked"],P=["onUpdate:modelValue"],B={key:0},I=["colspan"],q={class:"d-flex justify-content-between align-items-center mt-3 flex-wrap gap-2"},z={class:"d-flex align-items-center gap-2"},A=["value"],E={class:"pagination mb-0"},F=["onClick","disabled"],N=e({__name:"MiniTable",props:{settings:Object,urls:Object,fields:Object},setup(e){const N=e,R=l([]),D=l(""),G=l({}),H=l({}),J=l({column:null,ascending:!0}),K=l(1),Q=l(10),W=[10,25,50,100],X=e=>N.fields.columns.some((l=>l.column===e&&l.dropdown)),Y=(e,l)=>{var a;return(null==(a=N.fields[e])?void 0:a.includes(l))||!1},Z=(e,l)=>{const a=N.fields.merge.find((e=>e.to===l));if(a){for(let l=a.fields.length-1;l>=0;l--){const t=e[a.fields[l]];if(null!==t&&""!==t)return t}return""}return e[l]},$=a((()=>{let e=R.value.filter((e=>{const l=""===D.value||Object.values(e).join(" ").toLowerCase().includes(D.value.toLowerCase()),a=Object.entries(G.value).every((([l,a])=>{if(!a)return!0;const t=a.toLowerCase(),n=N.fields.merge.find((e=>e.to===l));return n?n.fields.some((l=>(e[l]||"").toString().toLowerCase().includes(t))):(e[l]||"").toString().toLowerCase().includes(t)}));return l&&a}));return J.value.column&&e.sort(((e,l)=>{const a=Z(e,J.value.column),t=Z(l,J.value.column);return a<t?J.value.ascending?-1:1:a>t?J.value.ascending?1:-1:0})),e})),ee=a((()=>Math.ceil($.value.length/Q.value))),le=a((()=>{const e=(K.value-1)*Q.value;return $.value.slice(e,e+Q.value)})),ae=e=>{e>=1&&e<=ee.value&&(K.value=e)},te=a((()=>{const e=ee.value,l=K.value,a=[],t=Math.max(2,l-2),n=Math.min(e-1,l+2);for(let s=t;s<=n;s++)a.push(s);return t>2&&a.unshift("..."),n<e-1&&a.push("..."),a.unshift(1),e>1&&a.push(e),a}));return t((async()=>{try{const e=await p.get(N.urls.data);R.value=e.data,N.fields.columns.forEach((e=>{X(e.column)&&(H.value[e.column]=[...new Set(R.value.map((l=>l[e.column])))])}))}catch(e){}})),(l,a)=>(f(),n("div",b,[s("div",h,[s("div",y,[s("h2",k,u(e.settings.title),1),o(s("input",{type:"text",class:"form-control w-25",placeholder:e.settings.searchText||"Search...","onUpdate:modelValue":a[0]||(a[0]=e=>D.value=e)},null,8,w),[[c,D.value]])]),s("div",x,[s("table",_,[s("thead",j,[s("tr",C,[(f(!0),n(i,null,r(e.fields.columns,(e=>(f(),n("th",{key:"filter-"+e.column},[e.filterText?(f(),n(i,{key:0},[X(e.column)?o((f(),n("select",{key:1,class:"form-select form-select-sm","onUpdate:modelValue":l=>G.value[e.column]=l},[s("option",T,u(e.filterText),1),(f(!0),n(i,null,r(H.value[e.column]||[],(e=>(f(),n("option",{key:e,value:e},u(e),9,L)))),128))],8,V)),[[m,G.value[e.column]]]):o((f(),n("input",{key:0,type:"text",class:"form-control form-control-sm",placeholder:e.filterText,"onUpdate:modelValue":l=>G.value[e.column]=l},null,8,U)),[[c,G.value[e.column]]])],64)):d("",!0)])))),128))]),s("tr",null,[(f(!0),n(i,null,r(e.fields.columns,(e=>(f(),n("th",{key:"header-"+e.column,onClick:l=>{return a=e.column,void(J.value.column===a?J.value.ascending=!J.value.ascending:(J.value.column=a,J.value.ascending=!0));var a},class:"sortable"},[g(u(e.label)+" ",1),l.sortBy===e.column?(f(),n("span",O,u("asc"===J.value.ascending?"▲":"▼"),1)):d("",!0)],8,M)))),128))])]),s("tbody",null,[(f(!0),n(i,null,r(le.value,(l=>(f(),n("tr",{key:l.id,class:"clickable-row"},[(f(!0),n(i,null,r(e.fields.columns,(e=>(f(),n("td",{key:"cell-"+e.column,contenteditable:""},[Y("checkbox",e.column)?(f(),n("input",{key:0,type:"checkbox",checked:Boolean(parseInt(Z(l,e.column))),style:{"align-content":"center"}},null,8,S)):Y("datetime",e.column)?o((f(),n("input",{key:1,type:"datetime-local","onUpdate:modelValue":a=>l[e.column]=a,style:{"font-size":"9px"}},null,8,P)),[[c,l[e.column]]]):(f(),n(i,{key:2},[g(u(Z(l,e.column)),1)],64))])))),128))])))),128)),0===le.value.length?(f(),n("tr",B,[s("td",{colspan:e.fields.columns.length,class:"text-center text-muted py-4"}," No data found ",8,I)])):d("",!0)])])]),s("div",q,[s("div",z,[a[4]||(a[4]=s("label",{for:"itemsPerPage",class:"form-label mb-0"},"Rows per page:",-1)),o(s("select",{id:"itemsPerPage",class:"form-select form-select-sm w-auto","onUpdate:modelValue":a[1]||(a[1]=e=>Q.value=e)},[(f(),n(i,null,r(W,(e=>s("option",{key:e,value:e},u(e),9,A))),64))],512),[[m,Q.value]])]),s("div",null," Showing "+u(le.value.length)+" of "+u($.value.length)+" filtered results ",1),s("nav",null,[s("ul",E,[s("li",{class:v(["page-item",{disabled:1===K.value}])},[s("button",{class:"page-link",onClick:a[2]||(a[2]=e=>ae(K.value-1))},"«")],2),(f(!0),n(i,null,r(te.value,(e=>(f(),n("li",{key:"page-"+e,class:v(["page-item",{active:e===K.value,disabled:"..."===e}])},[s("button",{class:"page-link",onClick:l=>"number"==typeof e&&ae(e),disabled:"..."===e},u(e),9,F)],2)))),128)),s("li",{class:v(["page-item",{disabled:K.value===ee.value}])},[s("button",{class:"page-link",onClick:a[3]||(a[3]=e=>ae(K.value+1))},"»")],2)])])])])]))}},[["__scopeId","data-v-561a7187"]]);export{N as default};
//# sourceMappingURL=MiniTable-CcIS5bN3.js.map
