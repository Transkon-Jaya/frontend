import{s as A}from"./vue-multiselect-B3caVdI0.js";import{_ as M,r as s,u as G,A as c,w as K,o as J,E as Q,c as i,a as e,m as d,h,t as u,G as I,B as R,d as m,f as W,V as X,F as E,j as Y,q as L,s as Z,g as r,x as ee}from"./index-DzD4XlgT.js";import{C as f}from"./Charts-DPLTc_u0.js";/* empty css                                                                   */import{_ as te}from"./BigTable-lyR9XtbI.js";import"./xlsx-DAso0ExP.js";/* empty css                            *//* empty css                                                 */const ae={class:"container-local mb-2"},se={class:"d-flex justify-content-between align-items-center mb-2 mt-auto"},le={class:"text-end"},oe={class:"row align-items-end mb-4"},ne={class:"col-md-5"},re={class:"col-md-5"},ie={class:"col-md-2 text-end"},de={class:"mb-2"},ue={class:"text-end"},ce={class:"row text-center mb-4"},ve={class:"col"},_e={class:"card border-success"},me={class:"card-body"},pe={class:"text-success"},ye={class:"col"},be={class:"card border-danger"},ge={class:"card-body"},he={class:"text-danger",style:{"text-align":"center"}},fe={style:{"margin-right":"10px"}},we={style:{"margin-left":"10px"}},ke={class:"col"},xe={class:"card border-warning"},De={class:"card-body"},Se={class:"text-warning",style:{"text-align":"center"}},Ue={style:{"margin-right":"10px"}},Ce={style:{"margin-left":"10px"}},Te={class:"nav nav-tabs"},Be=["onClick"],Ve={key:0,class:"card mb-4"},Fe={class:"card-body"},Ae={key:1,class:"row g-4 mb-4"},Ie={key:0,class:"col-md-12"},Re={key:1,class:"col-md-12"},Ee={class:"card h-100"},Le={key:2,class:"col-md-12"},$e={class:"card h-100"},je={key:3,class:"col-md-12"},Ne={class:"card h-100"},Pe={key:4,class:"col-md-12"},qe={class:"card h-100"},Oe={__name:"DownEquipment",setup(ze){const $=s(null),y=G(),b=s(""),n=s(""),g=s([]),w=s(!0),S=s({title:"Daily Trend",type:"bar",api:{url:c+"/chart/de_running_total",params:[14,n.value,""]},columns:{label:["date"],datas:["running_total","daily_down","daily_done"]},colors:["red","orange","green"],labels:["Total Down","Units Down / Day","Units Done / Day"]}),k=s({title:"Daily Trend",type:"line",api:{url:c+"/chart/de_running_total",params:[14,n.value,""]},columns:{label:["date"],datas:["running_total","daily_down","daily_done"]},colors:["red","orange","green"],labels:["Total Down","Units Down / Day","Units Done / Day"]}),U=s({title:"Unit Summary",type:"pie",api:{url:c+"/chart/de_total_rental",params:[n.value,""]},columns:{datas:["unit_rental","spare_exists_false","spare_exists_true"]},colors:["green","red","orange"],labels:["Unit Rental","PA Unit","PA Rental"]}),j=s({title:"Customer Summary",type:"bar",api:{url:c+"/chart/de_customer_summary"},columns:{label:["customer"],datas:["total_unit","total_break"]},colors:["green","red"],labels:["Total Unit","Total Break"]}),N=s({title:"Location Summary",type:"bar",api:{url:c+"/chart/de_location_summary"},columns:{label:["alt_location"],datas:["total_unit","total_break"]},colors:["green","red"],labels:["Total Unit","Total Break"]}),P=s({title:""}),q=s({firstCol:{label:"TK NO",field:"tk_no",type:"type"},merge:[{fields:["hour_in","hour_out"],to:"hour"},{fields:["jarak_in","jarak_out"],to:"jarak"}],priority:["customer","alt_location"],unpriority:["username","createdAt","lastUpdated"],hidden:["id","done"],toRemove:["vehicle_type","plate_no"],uneditable:["id","plan_hub"],checkbox:["spare_exists"],date:[],datetime:["down_since","estimated_return"]}),O=s({data:`${y.apiBaseUrl}/de_site`,dropdowns:{vehicle_type:{url:y.apiBaseUrl+"/dropdowns/vehicle_type",valueField:"vehicle_type",column:"vehicle_type"},tk_no:{url:y.apiBaseUrl+"/dropdowns/tk_no",valueField:"tk_no",column:"tk_no"}},get:{vehicle_type:{url:y.apiBaseUrl+"/get/vehicle_type",valueField:"vehicle_type",column:"vehicle_type"}}}),l=s(""),z=[{label:"All",value:""},{label:"Site Summary",value:"site-summary"},{label:"Daily Trend",value:"0"},{label:"Unit Summary",value:"1"},{label:"Customer Summary",value:"2"},{label:"Location Summary",value:"3"}],H=async()=>{try{const a=await L.get(c+"/dropdowns/customer");g.value=a.data.map(t=>({label:t,value:t}))}catch(a){console.error("Error fetching dropdown data:",a)}};s();const C=s(),T=async a=>{console.log(a),b.value=a,n.value=b.value.value,S.value.api.params[1]=n.value,k.value.api.params[1]=n.value,await C.value.renderChart(),await D(),await Z()},p=s([0,0]),v=s([0,0]),_=s([0,0]),x=s("");function B(){const a=new Date,t=a.getHours().toString().padStart(2,"0"),o=a.getMinutes().toString().padStart(2,"0"),F=a.getSeconds().toString().padStart(2,"0");x.value=`${t}:${o}:${F}`}const D=async()=>{try{const a=await L.get(c+"/chart/de_total_rental",{params:{params:[n.value,""]}}),t=a.data[0].unit_rental+a.data[0].spare_exists_false+a.data[0].spare_exists_true;p.value[0]=a.data[0].unit_rental,v.value[0]=a.data[0].spare_exists_false+a.data[0].spare_exists_true,_.value[0]=a.data[0].spare_exists_false,t===0?(p.value[1]=0,v.value[1]=0,_.value[1]=0):(p.value[1]=(p.value[0]/t*100).toFixed(2),v.value[1]=(v.value[0]/t*100).toFixed(2),_.value[1]=(_.value[0]/t*100).toFixed(2))}catch(a){console.error("Fetch error:",a)}};K(n.value,async()=>{console.log("selectedItems : ",n.value),S.value.api.params[1]=n.value,k.value.api.params[1]=n.value,U.value.api.params[0]=n.value,await D()});let V;return J(async()=>{await H(),await D(),w.value=!1,console.log("dropdown : ",g.value),B(),V=setInterval(B,1e3)}),Q(()=>{clearInterval(V)}),(a,t)=>(r(),i(E,null,[e("div",ae,[e("div",se,[t[4]||(t[4]=e("h1",{class:"h3 fw-bold mb-0"},[e("i",{class:"bi bi-car-front-fill me-2"}),h(" Down Equipment Dashboard ")],-1)),e("div",le,[e("div",null,u(x.value),1)])]),e("div",oe,[e("div",ne,[t[5]||(t[5]=e("label",{class:"form-label"},"Select Customer",-1)),w.value?d("",!0):(r(),I(R(A),{key:0,modelValue:b.value,"onUpdate:modelValue":[t[0]||(t[0]=o=>b.value=o),t[1]||(t[1]=o=>T(o))],options:g.value||[],placeholder:"Select Customer",label:"label","track-by":"value",class:"multiselect no-border"},null,8,["modelValue","options"]))]),e("div",re,[t[6]||(t[6]=e("label",{class:"form-label"},"Select Location",-1)),w.value?d("",!0):(r(),I(R(A),{key:0,modelValue:a.location,"onUpdate:modelValue":[t[2]||(t[2]=o=>a.location=o),t[3]||(t[3]=o=>T(o))],options:g.value||[],placeholder:"Select Location",label:"label","track-by":"value",class:"multiselect no-border"},null,8,["modelValue","options"]))]),e("div",ie,[m(X,{type:"submit",color:"danger",size:"md",block:!1},{default:W(()=>t[7]||(t[7]=[h("Reset Filter")])),_:1})])]),e("div",de,[e("div",ue,[t[8]||(t[8]=e("h5",{class:"fw-bold text-primary"},null,-1)),e("div",null,u(x.value),1)]),e("div",ce,[e("div",ve,[e("div",_e,[e("div",me,[e("h3",pe,u(p.value[0]),1),t[9]||(t[9]=e("p",{class:"fw-bold mb-0"},"On Hire (UIC)",-1))])])]),e("div",ye,[e("div",be,[e("div",ge,[e("h3",he,[e("span",fe,u(v.value[1])+"%",1),t[10]||(t[10]=h(" || ")),e("span",we,u(v.value[0]),1)]),t[11]||(t[11]=e("p",{class:"fw-bold mb-0"},"PA Unit",-1))])])]),e("div",ke,[e("div",xe,[e("div",De,[e("h3",Se,[e("span",Ue,u(_.value[1])+"%",1),t[12]||(t[12]=h(" || ")),e("span",Ce,u(_.value[0]),1)]),t[13]||(t[13]=e("p",{class:"fw-bold mb-0"},"PA Rental",-1))])])])])]),e("ul",Te,[(r(),i(E,null,Y(z,o=>e("li",{class:"nav-item",key:o.value},[e("button",{class:ee(["nav-link",{active:l.value===o.value}]),onClick:F=>l.value=o.value},u(o.label),11,Be)])),64))])]),l.value===""||l.value==="site-summary"?(r(),i("div",Ve,[e("div",Fe,[t[14]||(t[14]=e("h5",{class:"card-title text-danger"},"Site Summary",-1)),m(te,{ref_key:"bigTableRef",ref:$,settings:P.value,urls:O.value,fields:q.value,canInsert:!1,canUpdate:!1},null,8,["settings","urls","fields"])])])):d("",!0),l.value===""||["0","1","2","3"].includes(l.value)?(r(),i("div",Ae,[l.value===""||l.value==="0"?(r(),i("div",Ie)):d("",!0),l.value===""||l.value==="0"?(r(),i("div",Re,[e("div",Ee,[m(f,{ref_key:"chart11",ref:C,settings:k.value},null,8,["settings"])])])):d("",!0),l.value===""||l.value==="1"?(r(),i("div",Le,[e("div",$e,[m(f,{settings:U.value},null,8,["settings"])])])):d("",!0),l.value===""||l.value==="2"?(r(),i("div",je,[e("div",Ne,[m(f,{settings:j.value},null,8,["settings"])])])):d("",!0),l.value===""||l.value==="3"?(r(),i("div",Pe,[e("div",qe,[m(f,{settings:N.value},null,8,["settings"])])])):d("",!0)])):d("",!0),t[15]||(t[15]=e("br",null,null,-1)),t[16]||(t[16]=e("br",null,null,-1)),t[17]||(t[17]=e("br",null,null,-1))],64))}},Ye=M(Oe,[["__scopeId","data-v-5f9509c9"]]);export{Ye as default};
