import{_ as Z,u as ee,r as d,o as te,s as U,c as o,a as e,p as j,h as m,t as n,F as g,j as k,b as p,k as h,z as x,q as ae,v as B,n as P,A as S,E as se,g as r}from"./index-Cdt_azeZ.js";const le={class:"card border-0 shadow-sm"},ne={class:"card-header"},oe={class:"d-flex justify-content-between align-items-center"},re=["disabled"],ue={class:"card-body"},ie={key:0,class:"alert alert-danger alert-dismissible fade show"},de={key:1,class:"text-center py-5"},ve={key:2,class:"table-responsive"},ce={class:"table table-hover table-striped table-bordered mb-0"},me={class:"table-dark"},be=["onUpdate:modelValue","placeholder"],pe={key:0},fe=["colspan"],ge={class:"text-center"},ke=["onClick"],ye={class:"text-center"},_e={class:"text-center"},xe={class:"text-center"},we={class:"text-center"},he={class:"text-center"},Ce={class:"text-center"},je={class:"text-center"},$e={class:"btn-group btn-group-sm",role:"group"},Ee=["onClick"],Le=["onClick"],Pe={class:"d-flex flex-wrap justify-content-between align-items-center mt-3"},Se={class:"d-flex align-items-center mb-2"},Ne=["value"],Ue={class:"text-muted"},Be={"aria-label":"Page navigation"},Ie={class:"pagination pagination-sm mb-0"},Ve={class:"page-item disabled"},Ae={class:"page-link"},Oe={key:0,class:"modal fade show d-block",style:{background:"rgba(0,0,0,0.5)"}},qe={class:"modal-dialog modal-dialog-centered"},Ke={class:"modal-content border-0 shadow"},Te={class:"modal-title"},Fe={class:"modal-body"},Me={class:"mb-3"},De=["disabled"],Re={class:"mb-3"},ze={class:"mb-3"},Je=["value"],Ge={class:"mb-3"},He=["value"],Qe={class:"mb-3"},We=["value"],Xe={class:"mb-3"},Ye=["value"],Ze={class:"mb-3"},et=["value"],tt={class:"modal-footer border-top-0"},at={key:1,class:"modal fade show d-block",style:{background:"rgba(0,0,0,0.5)"}},st={class:"modal-dialog modal-dialog-centered"},lt={class:"modal-content border-0 shadow"},nt={class:"modal-body"},ot={__name:"Employee",setup(rt){const F=ee(),M=se(),v=d([]),l=d({departments:[],jabatan:[],placements:[],genders:["L","P"],locations:[]}),$=d(!0),w=d(null),D=d(0),E=d(!1),c=d(!1),u=d({}),I=d(-1),C=d(!1),y=d(null),f=d({username:"",name:"",department:"",jabatan:"",placement:"",gender:"",lokasi:""}),_=d(10),b=d(1),R=[10,20,50,{value:-1,text:"All"}],V=[{text:"NIK",value:"username",align:"center",sortable:!0,filterable:!0},{text:"Nama",value:"name",align:"center",sortable:!0,filterable:!0},{text:"Departemen",value:"department",align:"center",sortable:!0,filterable:!0},{text:"Position",value:"jabatant",align:"center",sortable:!0,filterable:!0},{text:"Penempatan",value:"placement",align:"center",sortable:!0,filterable:!0},{text:"Gender",value:"gender",align:"center",sortable:!0,filterable:!0},{text:"Lokasi",value:"lokasi",align:"center",sortable:!0,filterable:!0},{text:"Actions",value:"actions",align:"center",sortable:!1,filterable:!1}],z=async()=>{var s,t;try{$.value=!0;const a=await P.get(`${S}/users`,{headers:{Authorization:`Bearer ${F.token}`}});v.value=a.data,D.value=v.value.length,l.value.departments=[...new Set(v.value.map(i=>i.department).filter(Boolean))],l.value.jabatan=[...new Set(v.value.map(i=>i.jabatan).filter(Boolean))],l.value.placements=[...new Set(v.value.map(i=>i.placement).filter(Boolean))],l.value.locations=[...new Set(v.value.map(i=>i.lokasi).filter(Boolean))],l.value.site=[...new Set(v.value.map(i=>i.site).filter(Boolean))],$.value=!1}catch(a){w.value=((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||a.message,$.value=!1}};te(async()=>{await z()});const L=U(()=>v.value.filter(s=>Object.keys(f.value).every(t=>f.value[t]?String(s[t]).toLowerCase().includes(f.value[t].toLowerCase()):!0))),N=U(()=>{if(_.value===-1)return L.value;const s=(b.value-1)*_.value,t=s+_.value;return L.value.slice(s,t)}),A=U(()=>_.value===-1?1:Math.ceil(L.value.length/_.value)),J=()=>{u.value={username:"",name:"",department:l.value.departments[0]||"",department:l.value.jabatan[0]||"",placement:l.value.placements[0]||"",gender:l.value.genders[0]||"L",lokasi:l.value.locations[0]||"",site:l.value.site[0]||""},c.value=!0},G=s=>{I.value=v.value.findIndex(t=>t.username===s.username),u.value=JSON.parse(JSON.stringify(s)),E.value=!0},H=async()=>{var s,t;try{if(c.value){const a=await P.post(`${S}/users`,u.value,{headers:{"Content-Type":"application/json"}});v.value.unshift(a.data),O(a.data),c.value=!1}else{const a=await P.put(`${S}/users`,u.value,{headers:{"Content-Type":"application/json"}});v.value[I.value]=a.data,O(a.data),E.value=!1}u.value={}}catch(a){w.value=((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.error)||a.message,console.error("CRUD Error:",a)}},O=s=>{s.department&&!l.value.departments.includes(s.department)&&l.value.departments.push(s.department),s.jabatan&&!l.value.jabatans.includes(s.jabatan)&&l.value.jabatans.push(s.jabatan),s.placement&&!l.value.placements.includes(s.placement)&&l.value.placements.push(s.placement),s.lokasi&&!l.value.locations.includes(s.lokasi)&&l.value.locations.push(s.lokasi)},Q=s=>{y.value=s,C.value=!0},W=async()=>{var s,t;try{await P.delete(`${S}/users/${y.value.username}`),v.value=v.value.filter(a=>a.username!==y.value.username),C.value=!1,y.value=null}catch(a){w.value=((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||a.message,C.value=!1}},q=()=>{C.value=!1,y.value=null},K=()=>{E.value=!1,c.value=!1,u.value={}},X=s=>{M.push({name:"hr-absensi-detail",params:{username:s}})},Y=()=>{Object.keys(f.value).forEach(s=>{f.value[s]=""}),b.value=1};return(s,t)=>(r(),o("div",le,[e("div",ne,[e("div",oe,[t[15]||(t[15]=e("h3",{class:"mb-0"},"List Karyawan",-1)),e("div",null,[e("button",{onClick:Y,class:"btn btn-sm btn-light me-2",disabled:!Object.values(f.value).some(Boolean)},t[13]||(t[13]=[e("i",{class:"fas fa-filter-circle-xmark me-1"},null,-1),m(" Reset Filters ")]),8,re),e("button",{onClick:J,class:"btn btn-sm btn-danger"},t[14]||(t[14]=[e("i",{class:"fas fa-plus me-1"},null,-1),m(" Add New ")]))])])]),e("div",ue,[w.value?(r(),o("div",ie,[m(n(w.value)+" ",1),e("button",{type:"button",class:"btn-close",onClick:t[0]||(t[0]=a=>w.value=null)})])):j("",!0),$.value?(r(),o("div",de,t[16]||(t[16]=[e("div",{class:"spinner-border text-primary",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1),e("p",{class:"mt-2"},"Loading data...",-1)]))):(r(),o("div",ve,[e("table",ce,[e("thead",me,[e("tr",null,[(r(),o(g,null,k(V,a=>e("th",{key:a.value,class:x(a.align?`text-${a.align}`:"")},[e("div",null,n(a.text),1),a.filterable?p((r(),o("input",{key:0,"onUpdate:modelValue":i=>f.value[a.value]=i,type:"text",class:"form-control form-control-sm mt-1",placeholder:`Filter ${a.text}`,onInput:t[1]||(t[1]=i=>b.value=1)},null,40,be)),[[B,f.value[a.value]]]):j("",!0)],2)),64))])]),e("tbody",null,[N.value.length===0?(r(),o("tr",pe,[e("td",{colspan:V.length,class:"text-center py-4"},"No data available",8,fe)])):j("",!0),(r(!0),o(g,null,k(N.value,(a,i)=>(r(),o("tr",{key:i,class:"align-middle"},[e("td",ge,[e("a",{href:"javascript:void(0)",onClick:T=>X(a.username),class:"text-primary fw-semibold"},n(a.username),9,ke)]),e("td",ye,n(a.name),1),e("td",_e,n(a.department),1),e("td",xe,n(a.jabatan),1),e("td",we,n(a.placement),1),e("td",he,[e("span",{class:x(["badge",a.gender==="Laki-laki"?"bg-info":"bg-danger"])},n(a.gender),3)]),e("td",Ce,n(a.lokasi),1),e("td",je,[e("div",$e,[e("button",{onClick:T=>G(a),class:"btn btn-warning",title:"Edit"},t[17]||(t[17]=[e("i",{class:"fas fa-edit"},null,-1)]),8,Ee),e("button",{onClick:T=>Q(a),class:"btn btn-danger",title:"Delete",id:"confirm-text"},t[18]||(t[18]=[e("i",{class:"fas fa-trash-alt"},null,-1)]),8,Le)])])]))),128))])])])),e("div",Pe,[e("div",Se,[p(e("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>_.value=a),class:"form-select form-select-sm me-2",style:{width:"90px"},onChange:t[3]||(t[3]=a=>b.value=1)},[(r(),o(g,null,k(R,a=>e("option",{key:a.value||a,value:a.value||a},n(a.text||a),9,Ne)),64))],544),[[h,_.value]]),e("small",Ue," Showing "+n(N.value.length)+" of "+n(L.value.length)+" entries ",1)]),e("nav",Be,[e("ul",Ie,[e("li",{class:x(["page-item",{disabled:b.value===1}])},[e("button",{class:"page-link",onClick:t[4]||(t[4]=a=>b.value--)},t[19]||(t[19]=[e("i",{class:"fas fa-chevron-left"},null,-1)]))],2),e("li",Ve,[e("span",Ae," Page "+n(b.value)+" of "+n(A.value),1)]),e("li",{class:x(["page-item",{disabled:b.value===A.value}])},[e("button",{class:"page-link",onClick:t[5]||(t[5]=a=>b.value++)},t[20]||(t[20]=[e("i",{class:"fas fa-chevron-right"},null,-1)]))],2)])])])]),E.value||c.value?(r(),o("div",Oe,[e("div",qe,[e("div",Ke,[e("div",{class:x(["modal-header",(c.value,"bg-danger text-white")])},[e("h5",Te,n(c.value?"Tambah Karyawan Baru":"Edit Karyawan"),1),e("button",{type:"button",class:x(["btn-close",(c.value,"btn-close-white")]),onClick:K},null,2)],2),e("div",Fe,[e("form",{onSubmit:ae(H,["prevent"])},[e("div",Me,[t[21]||(t[21]=e("label",{class:"form-label"},[m("NIK "),e("span",{class:"text-danger"},"*")],-1)),p(e("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>u.value.username=a),type:"text",class:"form-control",disabled:!c.value,required:""},null,8,De),[[B,u.value.username]])]),e("div",Re,[t[22]||(t[22]=e("label",{class:"form-label"},[m("Nama "),e("span",{class:"text-danger"},"*")],-1)),p(e("input",{"onUpdate:modelValue":t[7]||(t[7]=a=>u.value.name=a),type:"text",class:"form-control",required:""},null,512),[[B,u.value.name]])]),e("div",ze,[t[23]||(t[23]=e("label",{class:"form-label"},"Departemen",-1)),p(e("select",{"onUpdate:modelValue":t[8]||(t[8]=a=>u.value.department=a),class:"form-select",required:""},[(r(!0),o(g,null,k(l.value.departments,a=>(r(),o("option",{key:a,value:a},n(a),9,Je))),128))],512),[[h,u.value.department]])]),e("div",Ge,[t[24]||(t[24]=e("label",{class:"form-label"},"Jabatan",-1)),p(e("select",{"onUpdate:modelValue":t[9]||(t[9]=a=>u.value.jabatan=a),class:"form-select",required:""},[(r(!0),o(g,null,k(l.value.jabatan,a=>(r(),o("option",{key:a,value:a},n(a),9,He))),128))],512),[[h,u.value.jabatan]])]),e("div",Qe,[t[25]||(t[25]=e("label",{class:"form-label"},"Penempatan",-1)),p(e("select",{"onUpdate:modelValue":t[10]||(t[10]=a=>u.value.placement=a),class:"form-select",required:""},[(r(!0),o(g,null,k(l.value.placements,a=>(r(),o("option",{key:a,value:a},n(a),9,We))),128))],512),[[h,u.value.placement]])]),e("div",Xe,[t[26]||(t[26]=e("label",{class:"form-label"},"Gender",-1)),p(e("select",{"onUpdate:modelValue":t[11]||(t[11]=a=>u.value.gender=a),class:"form-select",required:""},[(r(!0),o(g,null,k(l.value.genders,a=>(r(),o("option",{key:a,value:a},n(a==="L"?"Laki-laki":"Perempuan"),9,Ye))),128))],512),[[h,u.value.gender]])]),e("div",Ze,[t[28]||(t[28]=e("label",{class:"form-label"},"Lokasi",-1)),p(e("select",{"onUpdate:modelValue":t[12]||(t[12]=a=>u.value.lokasi=a),class:"form-select"},[t[27]||(t[27]=e("option",{value:""},"Pilih Lokasi",-1)),(r(!0),o(g,null,k(l.value.locations,a=>(r(),o("option",{key:a,value:a},n(a),9,et))),128))],512),[[h,u.value.lokasi]])]),e("div",tt,[e("button",{type:"button",class:"btn btn-secondary",onClick:K},t[29]||(t[29]=[e("i",{class:"fas fa-times me-1"},null,-1),m(" Cancel ")])),e("button",{type:"submit",class:x(["btn",(c.value,"btn-danger")])},[t[30]||(t[30]=e("i",{class:"fas fa-save me-1"},null,-1)),m(" "+n(c.value?"Simpan":"Update"),1)],2)])],32)])])])])):j("",!0),C.value?(r(),o("div",at,[e("div",st,[e("div",lt,[e("div",{class:"modal-header bg-danger text-white"},[t[31]||(t[31]=e("h5",{class:"modal-title"},"Konfirmasi Hapus",-1)),e("button",{type:"button",class:"btn-close btn-close-white",onClick:q})]),e("div",nt,[t[34]||(t[34]=e("p",null,"Apakah Anda yakin ingin menghapus karyawan ini?",-1)),e("p",null,[t[32]||(t[32]=e("strong",null,"NIK:",-1)),m(" "+n(y.value.username),1)]),e("p",null,[t[33]||(t[33]=e("strong",null,"Nama:",-1)),m(" "+n(y.value.name),1)]),t[35]||(t[35]=e("p",{class:"text-danger"},"Data yang dihapus tidak dapat dikembalikan!",-1))]),e("div",{class:"modal-footer border-top-0"},[e("button",{type:"button",class:"btn btn-secondary",onClick:q},t[36]||(t[36]=[e("i",{class:"fas fa-times me-1"},null,-1),m(" Batal ")])),e("button",{type:"button",class:"btn btn-danger",onClick:W},t[37]||(t[37]=[e("i",{class:"fas fa-trash-alt me-1"},null,-1),m(" Hapus ")]))])])])])):j("",!0)]))}},it=Z(ot,[["__scopeId","data-v-46966cb4"]]);export{it as default};
