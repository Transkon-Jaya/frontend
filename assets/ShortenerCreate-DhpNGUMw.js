import{u as B,r as c,n as j,o as V,c as u,a as t,q as b,s as F,b as k,v as y,h as g,t as l,F as H,j as E,p as w,A as x,aa as C,g as v}from"./index-Br1_NATY.js";const R={class:"container py-5"},T={class:"row justify-content-center"},z={class:"col-md-6"},D={class:"card shadow-sm mb-4"},M={class:"card-body p-4"},N={class:"mb-3"},q={class:"mb-3"},I=["disabled"],O={key:0,class:"spinner-border spinner-border-sm me-2",role:"status"},P={key:0,class:"alert alert-success mt-4 mb-0",role:"alert"},Y=["href"],G={key:1,class:"alert alert-danger mt-4 mb-0",role:"alert"},J={key:0,class:"card shadow-sm"},K={class:"card-header bg-light fw-semibold d-flex justify-content-between align-items-center"},Q={class:"list-group list-group-flush"},W={class:"flex-grow-1 text-break"},X={class:"fw-medium mb-1"},Z=["href"],ee={class:"fw-medium mb-1"},te={class:"fw-medium mb-1"},se=["onClick"],le={__name:"ShortenerCreate",setup(ae){const h=B(),n=c(""),f=c(""),m=c(""),i=c(""),d=c(!1),_=c(""),p=c([]),L=async()=>{try{const a=await w.get(`${x}/shortener?username=${h.username}`,{headers:{Authorization:`Bearer ${h.token}`}});console.log("History:",a.data),p.value=a.data.map(e=>({...e,link:`${C}/office/s/${e.link}`,code:e.link}))}catch(a){console.error("Failed to fetch history:",a)}},A=j(()=>p.value.filter(a=>a.original_link.toLowerCase().includes(_.value.toLowerCase())||a.link.toLowerCase().includes(_.value.toLowerCase()))),$=async()=>{var a,e,s,r;console.log(n.value),console.log(f.value),i.value="",m.value="",d.value=!0;try{const o=await w.post(`${x}/shortener`,{code:f.value,original_link:n.value},{headers:{Authorization:`Bearer ${h.token}`,"Content-Type":"application/json"}});if(o.data.status!==1){i.value=o.data.message;return}const U=`${C}/office/s/${o.data.data.code}`;m.value=U,p.value.unshift({original_link:n.value,link:m.value,createdAt:o.data.data.createdAt,access_count:0,lastAccessed:null}),n.value="",f.value=""}catch(o){console.error(o),i.value=((e=(a=o.response)==null?void 0:a.data)==null?void 0:e.error)||((r=(s=o.response)==null?void 0:s.data)==null?void 0:r.message)||"Something went wrong."}finally{d.value=!1}},S=async a=>{var e,s;console.log(a);try{d.value=!0,i.value="";const r=await w.delete(`${x}/shortener`,{data:{code:a},headers:{Authorization:`Bearer ${h.token}`,"Content-Type":"application/json"}});p.value=p.value.filter(o=>o.code!==a)}catch(r){console.error("Failed to delete:",r),i.value=((s=(e=r.response)==null?void 0:e.data)==null?void 0:s.message)||"Failed to delete link"}finally{d.value=!1}};return V(async()=>{await L()}),(a,e)=>(v(),u("div",R,[t("div",T,[t("div",z,[t("div",D,[t("div",M,[e[6]||(e[6]=t("h5",{class:"card-title text-center mb-3"},"🔗 Create Shortened Link",-1)),e[7]||(e[7]=t("p",{class:"text-muted text-center mb-4"},"Easily shorten a long URL with optional custom code",-1)),t("form",{onSubmit:F($,["prevent"])},[t("div",N,[e[3]||(e[3]=t("label",{class:"form-label"},"Original URL",-1)),k(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>n.value=s),type:"url",class:"form-control",required:"",placeholder:"https://www.transkon-rent.com"},null,512),[[y,n.value]])]),t("div",q,[e[4]||(e[4]=t("label",{class:"form-label"},[g("Custom Code "),t("small",{class:"text-muted"})],-1)),k(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>f.value=s),type:"text",class:"form-control",placeholder:"my-short-link"},null,512),[[y,f.value]])]),t("button",{type:"submit",class:"btn btn-primary w-100",disabled:d.value||!n.value},[d.value?(v(),u("span",O)):b("",!0),g(" "+l(d.value?"Creating...":"Create Link"),1)],8,I)],32),m.value?(v(),u("div",P,[e[5]||(e[5]=g(" ✅ Short link created: ")),t("a",{href:m.value,target:"_blank",class:"alert-link"},l(m.value),9,Y)])):b("",!0),i.value?(v(),u("div",G," ❌ "+l(i.value),1)):b("",!0)])]),p.value.length?(v(),u("div",J,[t("div",K,[e[8]||(e[8]=t("span",null,"Your Short Link History",-1)),k(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>_.value=s),type:"text",class:"form-control form-control-sm w-auto",placeholder:"Search link..."},null,512),[[y,_.value]])]),t("ul",Q,[(v(!0),u(H,null,E(A.value,(s,r)=>(v(),u("li",{key:r,class:"list-group-item d-flex justify-content-between align-items-start flex-column flex-md-row gap-2"},[t("div",W,[t("div",X,l(s.original_link),1),t("a",{href:s.link,target:"_blank",class:"text-primary small text-break"},l(s.link),9,Z),e[9]||(e[9]=t("br",null,null,-1)),t("div",ee,"Created at: "+l(s.createdAt)+" || Last Access: "+l(s.lastUpdated),1),t("div",te,"Access count: "+l(s.access_count)+" || Last accessed: "+l(s.lastAccessed),1)]),t("div",null,[t("button",{class:"btn btn-sm btn-outline-danger",onClick:o=>S(s.code)},e[10]||(e[10]=[t("i",{class:"fa-solid fa-eraser"},null,-1)]),8,se)])]))),128))])])):b("",!0)])])]))}};export{le as default};
