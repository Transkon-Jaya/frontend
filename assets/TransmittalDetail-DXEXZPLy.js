import{_ as m,c as s,a as e,q as f,h as y,t as h,F as T,j as V,u as C,r as p,o as U,p as k,A as x,g as r,b as d,e as _,v as A}from"./index-DFdw_Vgd.js";const D={setup(){const b=C(),o=p([]),c=p(!0),n=p(!1),i=p(null),v=a=>a?new Date(a).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}):"-",t=async()=>{var a,l;try{c.value=!0,i.value=null;const u=await k.get(`${x}/tracking-invoices`,{headers:{Authorization:`Bearer ${b.token}`}});o.value=u.data.data||[]}catch(u){i.value=((l=(a=u.response)==null?void 0:a.data)==null?void 0:l.error)||"Gagal memuat data invoice",console.error("Fetch Error:",u)}finally{c.value=!1}},g=async a=>{try{n.value=!0;const l={acct:a.acct,tax_dept:a.tax_dept,admin:a.admin,expedisi:a.expedisi,remarks:a.remarks};await k.put(`${x}/tracking-invoices`,l,{params:{ta_id:a.ta_id},headers:{Authorization:`Bearer ${b.token}`}})}catch(l){console.error("Gagal update tracking:",l),alert("Gagal menyimpan perubahan. Coba lagi."),t()}finally{n.value=!1}};return U(()=>{t()}),{invoices:o,loading:c,submitting:n,error:i,formatDate:v,updateTracking:g}}},I={class:"info-card"},N={class:"card-body"},B={key:0,class:"text-center py-5"},E={key:1,class:"alert alert-danger"},L={key:2,class:"table-responsive"},S={class:"modern-table"},w={class:"checkbox-cell"},M=["onUpdate:modelValue","onChange","disabled"],R={class:"checkbox-cell"},F=["onUpdate:modelValue","onChange","disabled"],G={class:"checkbox-cell"},z=["onUpdate:modelValue","onChange","disabled"],j={class:"checkbox-cell"},q=["onUpdate:modelValue","onChange","disabled"],O=["onUpdate:modelValue","onBlur","disabled"];function P(b,o,c,n,i,v){return r(),s("div",I,[o[3]||(o[3]=e("div",{class:"card-header"},[e("h3",{class:"card-title"},"TRANSMITAL INVOICE INTERNAL")],-1)),e("div",N,[n.loading?(r(),s("div",B,o[0]||(o[0]=[e("div",{class:"spinner-border text-primary"},null,-1),e("p",null,"Loading invoices...",-1)]))):f("",!0),n.error?(r(),s("div",E,[o[1]||(o[1]=e("strong",null,"Error:",-1)),y(" "+h(n.error),1)])):(r(),s("div",L,[e("table",S,[o[2]||(o[2]=e("thead",null,[e("tr",null,[e("th",null,"No."),e("th",null,"No. Inv"),e("th",null,"Tgl Invoice"),e("th",null,"Acct"),e("th",null,"Tax Dept."),e("th",null,"Admin"),e("th",null,"Expedisi"),e("th",null,"Remarks")])],-1)),e("tbody",null,[(r(!0),s(T,null,V(n.invoices,(t,g)=>(r(),s("tr",{key:t.ta_id},[e("td",null,h(g+1),1),e("td",null,h(t.invoiceNo),1),e("td",null,h(n.formatDate(t.invoiceDate)),1),e("td",w,[d(e("input",{type:"checkbox","onUpdate:modelValue":a=>t.acct=a,onChange:a=>n.updateTracking(t),class:"form-checkbox",disabled:n.submitting},null,40,M),[[_,t.acct]])]),e("td",R,[d(e("input",{type:"checkbox","onUpdate:modelValue":a=>t.tax_dept=a,onChange:a=>n.updateTracking(t),class:"form-checkbox",disabled:n.submitting},null,40,F),[[_,t.tax_dept]])]),e("td",G,[d(e("input",{type:"checkbox","onUpdate:modelValue":a=>t.admin=a,onChange:a=>n.updateTracking(t),class:"form-checkbox",disabled:n.submitting},null,40,z),[[_,t.admin]])]),e("td",j,[d(e("input",{type:"checkbox","onUpdate:modelValue":a=>t.expedisi=a,onChange:a=>n.updateTracking(t),class:"form-checkbox",disabled:n.submitting},null,40,q),[[_,t.expedisi]])]),e("td",null,[d(e("input",{type:"text","onUpdate:modelValue":a=>t.remarks=a,onBlur:a=>n.updateTracking(t),class:"form-control form-control-sm",disabled:n.submitting,placeholder:"Catatan"},null,40,O),[[A,t.remarks]])])]))),128))])])]))])])}const J=m(D,[["render",P],["__scopeId","data-v-b4ab799f"]]);export{J as default};
