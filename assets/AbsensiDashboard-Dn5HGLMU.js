import{s as A}from"./vue-multiselect-B1TMqbH7.js";import{_ as z}from"./BigTable-aN1YMX3s.js";import{_ as K,u as P,r as l,A as _,o as I,c as n,m as i,a as s,h as V,t as R,l as W,G as U,B,d as b,f as q,V as G,F as T,j as J,q as H,s as Q,g as r,x as X}from"./index-DC2DhVwx.js";import{C as $}from"./Charts-Cke4Da9y.js";import"./xlsx-DKk7OYYM.js";/* empty css                            *//* empty css                                                 */const Y={key:0,class:"container-local mb-2"},Z={class:"d-flex justify-content-between align-items-center mb-2 mt-auto"},ee={class:"text-end"},ae={class:"row align-items-end mb-4"},te={class:"col-md-5"},se={class:"col-md-5"},le={class:"col-md-2 text-end"},oe={class:"nav nav-tabs"},re=["onClick"],ne={key:1,class:"card mb-4"},ie={class:"card-body"},de={key:2,class:"row g-4 mb-4"},ue={key:0,class:"col-md-12"},ce={class:"card h-100"},ve={class:"card h-100"},me={__name:"AbsensiDashboard",setup(pe){const u=P(),O=l(null),d=l(!0),c=l(null),v=l(null),f=l([]),h=l([]),y=l(),g=l({title:"Daily Average Hour Worked",type:"line",api:{url:_+"/chart/absensi_avg_hw",params:[14,new Date().toISOString().slice(0,10),"","",""]},columns:{label:["formatted_date"],datas:["avg_hour_worked"]},colors:["red"],labels:["Average Hour Worked"]}),k=l(),w=l({title:"Daily Average Hour In Out",type:"line",api:{url:_+"/chart/absensi_avg_hio",params:[14,new Date().toISOString().slice(0,10),"","",""]},columns:{label:["formatted_date"],datas:["avg_hour_in_decimal","avg_hour_out_decimal"],extras:["avg_hour_in","avg_hour_out"]},colors:["green","red"],labels:["Average Hour In","Average Hour Out"]}),E=async()=>{const t=await H.get(`${_}/dropdowns/department`);f.value=t.data.map(a=>({label:a,value:a})),console.log(f.value);const e=await H.get(`${_}/dropdowns/name`);h.value=e.data.map(a=>({label:a,value:a})),console.log(h.value),d.value=!1},S=l();function m(){const t=new Date,e=t.getHours().toString().padStart(2,"0"),a=t.getMinutes().toString().padStart(2,"0"),p=t.getSeconds().toString().padStart(2,"0");S.value=`${e}:${a}:${p}`}I(async()=>{m(),setInterval(m,1e3),await E(),d.value=!1});const o=l(""),F=[{label:"All",value:""},{label:"Site Summary",value:"site-summary"},{label:"Daily Trend",value:"0"},{label:"Unit Summary",value:"1"},{label:"Customer Summary",value:"2"},{label:"Location Summary",value:"3"}],M=l({title:"",styleClass:"",size:[10,30,100]}),N=l({firstCol:{label:"USERNAME",field:"username",type:"type",width:100},priority:["status","name","department","jabatan","hour_in","hour_out"],unpriority:["lastUpdated"],hidden:["tanggal","rn","created_at"],toRemove:["id"],exclude:[],uneditable:[],checkbox:["spare_exists"],date:[],datetime:[],status:{field:"status",calculate:t=>{var x,C;const e=new Date().toISOString().slice(0,10),a=(x=t.hour_in)==null?void 0:x.slice(0,10),p=(C=t.hour_out)==null?void 0:C.slice(0,10);return a!==e&&p!==e?"Tidak Hadir":t.hour_out==null?"Masuk":"Pulang"}}}),L=l({data:`${u.apiBaseUrl}/absensi-latest`,dropdowns:{vehicle_type:{url:u.apiBaseUrl+"/dropdowns/vehicle_type",valueField:"vehicle_type",column:"vehicle_type"},tk_no:{url:u.apiBaseUrl+"/dropdowns/tk_no",valueField:"tk_no",column:"tk_no"}},get:{vehicle_type:{url:u.apiBaseUrl+"/get/vehicle_type",valueField:"vehicle_type",column:"vehicle_type"}}}),D=async(t,e)=>{let a=0;t==="dep"?(c.value=e,a=3):t==="emp"&&(v.value=e,a=2),g.value.api.params[a]=e.value,w.value.api.params[a]=e.value,await y.value.renderChart(),await k.value.renderChart(),await Q()},j=async()=>{c.value="",v.value="";for(let t=2;t<5;t++)g.value.api.params[t]="",w.value.api.params[t]="";await y.value.renderChart(),await k.value.renderChart()};return I(()=>{m(),setInterval(m,1e3)}),(t,e)=>(r(),n(T,null,[d.value?i("",!0):(r(),n("div",Y,[s("div",Z,[e[5]||(e[5]=s("h1",{class:"h3 fw-bold mb-0"},[s("i",{class:"bi bi-people-fill me-2"}),V(" Absensi Dashboard ")],-1)),s("div",ee,[s("div",null,R(S.value),1)])]),s("div",ae,[s("div",te,[e[6]||(e[6]=s("label",{class:"form-label"},"Select Department",-1)),d.value?i("",!0):(r(),U(B(A),{key:0,modelValue:c.value,"onUpdate:modelValue":[e[0]||(e[0]=a=>c.value=a),e[1]||(e[1]=a=>D("dep",a))],options:f.value||[],placeholder:"Select Department",label:"label","track-by":"value",class:"multiselect no-border"},null,8,["modelValue","options"]))]),s("div",se,[e[7]||(e[7]=s("label",{class:"form-label"},"Select Employee",-1)),d.value?i("",!0):(r(),U(B(A),{key:0,modelValue:v.value,"onUpdate:modelValue":[e[2]||(e[2]=a=>v.value=a),e[3]||(e[3]=a=>D("emp",a))],options:h.value||[],placeholder:"Select Employee",label:"label","track-by":"value",class:"multiselect no-border"},null,8,["modelValue","options"]))]),s("div",le,[b(G,{type:"submit",color:"danger",size:"md",block:!1,onClick:e[4]||(e[4]=a=>j())},{default:q(()=>e[8]||(e[8]=[V("Reset Filter")])),_:1})]),e[9]||(e[9]=W('<div class="row text-center mb-2 mt-4" data-v-f1984925><div class="col" data-v-f1984925><div class="card border-success" data-v-f1984925><div class="card-body" data-v-f1984925><h3 class="text-success" data-v-f1984925>0</h3><p class="fw-bold mb-0" data-v-f1984925>Total Karyawan Masuk Hari Ini</p></div></div></div><div class="col" data-v-f1984925><div class="card border-danger" data-v-f1984925><div class="card-body" data-v-f1984925><h3 class="text-success" data-v-f1984925>0</h3><p class="fw-bold mb-0" data-v-f1984925>Total Karyawan Tidak Masuk Hari Ini</p></div></div></div></div>',1))]),s("ul",oe,[(r(),n(T,null,J(F,a=>s("li",{class:"nav-item",key:a.value},[s("button",{class:X(["nav-link",{active:o.value===a.value}]),onClick:p=>o.value=a.value},R(a.label),11,re)])),64))])])),o.value===""||o.value==="site-summary"?(r(),n("div",ne,[s("div",ie,[b(z,{ref_key:"bigTableRef",ref:O,settings:M.value,urls:L.value,fields:N.value,canInsert:!1,canUpdate:!0},null,8,["settings","urls","fields"])])])):i("",!0),o.value===""||["0","1","2","3"].includes(o.value)?(r(),n("div",de,[o.value===""||o.value==="0"?(r(),n("div",ue,[s("div",ce,[b($,{ref_key:"chartRef1",ref:y,settings:g.value},null,8,["settings"])])])):i("",!0),s("div",ve,[b($,{ref_key:"chartRef2",ref:k,settings:w.value},null,8,["settings"])])])):i("",!0)],64))}},we=K(me,[["__scopeId","data-v-f1984925"]]);export{we as default};
