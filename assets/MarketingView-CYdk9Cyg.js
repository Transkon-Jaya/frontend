import{k as t,m as d,g as b,c as l,a as s,b as f,i as p,d as h,v as w,y as x,t as y,n as D,o as i}from"./index-7wM4hRU9.js";import{V as M,u,w as V}from"./xlsx-DL9pYftt.js";const C={class:"actions"},N={key:0},E={key:1,class:"error"},T={__name:"MarketingView",setup(L){const o=t([]),c=t(!0),n=t(null),r=t(""),m=t(20);t(1),d(()=>o.value.length);const v=async()=>{try{const e=await D.get("https://www.transkon-rent.com/api/marketing");o.value=e.data}catch(e){n.value="Failed to load data",console.error(e)}finally{c.value=!1}},k=d(()=>r.value?o.value.filter(e=>e.name_customer.toLowerCase().includes(r.value.toLowerCase())):o.value),g=()=>{const e=u.json_to_sheet(o.value),a=u.book_new();u.book_append_sheet(a,e,"Marketing Data"),V(a,"MarketingData.xlsx")};return b(v),(e,a)=>(i(),l("div",null,[a[1]||(a[1]=s("h2",null,"Marketing Data",-1)),s("div",C,[h(s("input",{"onUpdate:modelValue":a[0]||(a[0]=_=>r.value=_),placeholder:"Search Customer Name..."},null,512),[[w,r.value]]),s("button",{onClick:g},"Export to Excel")]),f(x(M),{columns:[{label:"ID",field:"id",sortable:!0},{label:"Customer Name",field:"name_customer",sortable:!0},{label:"Location",field:"location",sortable:!0}],rows:k.value,"pagination-options":{enabled:!0,mode:"pages",perPage:m.value},"search-options":{enabled:!0,placeholder:"Search table"},"sort-options":{enabled:!0}},null,8,["rows","pagination-options"]),c.value?(i(),l("p",N,"Loading...")):p("",!0),n.value?(i(),l("p",E,y(n.value),1)):p("",!0)]))}};export{T as default};
