import{s as M}from"./vue-multiselect-IvgxcgCp.js";import{_ as te,r as s,u as ae,A as d,w as se,o as le,I as oe,c as r,a as e,q as u,F as D,j as N,t as c,J as j,x as P,d as _,f as O,V as ne,h as x,p as T,y as re,g as n,z as E}from"./index-Cqa8bM39.js";import{C as S}from"./Charts-lS7nYZV2.js";import{R as ie}from"./RouterLink-uoHnWsTC.js";import{_ as ue}from"./BigTable-Bgqj7a9H.js";import"./chart-BSyum5xv.js";/* empty css                                                                   */import"./vue-good-table.esm-CeOGgKO4.js";/* empty css                            */import"./xlsx-D1NZSDnX.js";import"./logger-B1IqVKgO.js";/* empty css                                                 */const de={class:"nav nav-tabs"},ce={class:"container-global mb-2"},ve={class:"d-flex justify-content-between align-items-center mb-2 mt-auto"},me={class:"text-end"},_e={class:"row align-items-end mb-4"},pe={class:"col-md-5"},be={class:"col-md-5"},ye={class:"col-md-2 text-end"},he={class:"mb-2"},ge={class:"row text-center mb-4"},fe={class:"col"},ke={class:"card border-success"},we={class:"card-body"},xe={class:"text-success"},Se={class:"col"},Ce={class:"card border-danger"},Ue={class:"card-body"},De={class:"text-danger",style:{"text-align":"center"}},Te={style:{"margin-right":"10px"}},Be={style:{"margin-left":"10px"}},Ve={class:"col"},Ae={class:"card border-warning"},Fe={class:"card-body"},Ie={class:"text-warning",style:{"text-align":"center"}},Re={style:{"margin-right":"10px"}},Le={style:{"margin-left":"10px"}},$e={class:"nav nav-tabs"},ze=["onClick"],Me={key:0,class:"card mb-4"},Ne={key:1,class:"row g-4 mb-4"},je={key:0,class:"col-md-12"},Pe={key:1,class:"col-md-12"},Oe={class:"card h-100"},Ee={key:2,class:"col-md-12"},He={class:"card h-100"},qe={key:3,class:"col-md-12"},Je={class:"card h-100"},Ke={key:4,class:"col-md-12"},Ge={class:"card h-100"},Qe={__name:"Maintenance",setup(We){const H=s(null),v=ae(),p=s(""),b=s(""),m=s(""),B=s([]),V=s([]),C=s(!0),q=s({title:"Daily Trend",type:"bar",api:{url:d+"/chart/de_running_total",params:[14,m.value,""]},columns:{label:["date"],datas:["running_total","daily_down","daily_done"]},colors:["red","orange","green"],labels:["Total Down","Units Down / Day","Units Done / Day"]}),f=s({title:"Daily Trend",type:"line",api:{url:d+"/chart/de_running_total",params:[14,m.value,""]},columns:{label:["date"],datas:["running_total","daily_down","daily_done"]},colors:["red","orange","green"],labels:["Total Down","Units Down / Day","Units Done / Day"]}),k=s({title:"Unit Summary",type:"pie",api:{url:d+"/chart/de_total_rental",params:["",""]},columns:{datas:["unit_rental","spare_exists_false","spare_exists_true"]},colors:["green","red","orange"],labels:["Unit Rental","PA Unit","PA Rental"]}),J=s({title:"Customer Summary",type:"bar",api:{url:d+"/chart/de_customer_summary"},columns:{label:["customer"],datas:["total_unit","total_break"]},colors:["green","red"],labels:["Total Unit","Total Break"]}),K=s({title:"Location Summary",type:"bar",api:{url:d+"/chart/de_location_summary"},columns:{label:["alt_location"],datas:["total_unit","total_break"]},colors:["green","red"],labels:["Total Unit","Total Break"]}),G=s({title:"Site Summary"}),Q=s({firstCol:{label:"TK NO",field:"tk_no",type:"type"},merge:[{fields:["hour_in","hour_out"],to:"hour"},{fields:["jarak_in","jarak_out"],to:"jarak"}],priority:["customer","alt_location"],unpriority:["username","createdAt","lastUpdated"],hidden:["id","done"],toRemove:["vehicle_type","plate_no"],uneditable:["id","plan_hub"],checkbox:["spare_exists"],date:[],datetime:["down_since","estimated_return"]}),W=s({data:`${v.apiBaseUrl}/de_site`,dropdowns:{vehicle_type:{url:v.apiBaseUrl+"/dropdowns/vehicle_type",valueField:"vehicle_type",column:"vehicle_type"},tk_no:{url:v.apiBaseUrl+"/dropdowns/tk_no",valueField:"tk_no",column:"tk_no"}},get:{vehicle_type:{url:v.apiBaseUrl+"/get/vehicle_type",valueField:"vehicle_type",column:"vehicle_type"}}}),X=s([{label:"Dashboard",route:"/fleet/fleet-main-dashboard"},{label:"Timesheet",route:"/fleet/timesheet"},{label:"Invoice",route:"/fleet/invoice"},{label:"Contract",route:"/fleet/contract"},{label:"Maintenance",route:"/fleet/maintenance"},{label:"Notification",route:"/fleet/notification"},{label:"Vehicle List",route:"/fleet/list-unit"}]),l=s(""),Y=[{label:"Site Summary",value:"site-summary"},{label:"Daily Trend",value:"0"},{label:"Unit Summary",value:"1"},{label:"Customer Summary",value:"2"},{label:"Location Summary",value:"3"}],Z=async()=>{try{const o=await T.get(d+"/dropdowns/customer",{headers:{Authorization:`Bearer ${v.token}`}});B.value=o.data.map(a=>({label:a,value:a}));const t=await T.get(d+"/dropdowns/alt_location",{headers:{Authorization:`Bearer ${v.token}`}});V.value=t.data.map(a=>({label:a,value:a}))}catch(o){console.error("Error fetching dropdown data:",o)}};s();const A=s(),F=s(),w=async(o,t)=>{var a,i,$,z;o==="customer"?(p.value=t,f.value.api.params[1]=((a=p.value)==null?void 0:a.value)??"",k.value.api.params[0]=((i=p.value)==null?void 0:i.value)??""):(b.value=t,f.value.api.params[2]=(($=b.value)==null?void 0:$.value)??"",k.value.api.params[1]=((z=b.value)==null?void 0:z.value)??""),await F.value.renderChart(),await A.value.renderChart(),await U(),await re()},g=s([0,0]),y=s([0,0]),h=s([0,0]),I=s("");function R(){const o=new Date,t=o.getHours().toString().padStart(2,"0"),a=o.getMinutes().toString().padStart(2,"0"),i=o.getSeconds().toString().padStart(2,"0");I.value=`${t}:${a}:${i}`}const U=async()=>{var o,t;try{const a=await T.get(d+"/chart/de_total_rental",{headers:{Authorization:`Bearer ${v.token}`},params:{params:[((o=p.value)==null?void 0:o.value)??"",((t=b.value)==null?void 0:t.value)??""]}}),i=a.data[0].unit_rental+a.data[0].spare_exists_false+a.data[0].spare_exists_true;g.value[0]=a.data[0].unit_rental,y.value[0]=a.data[0].spare_exists_false+a.data[0].spare_exists_true,h.value[0]=a.data[0].spare_exists_false,i===0?(g.value[1]=0,y.value[1]=0,h.value[1]=0):(g.value[1]=(g.value[0]/i*100).toFixed(2),y.value[1]=(100-y.value[0]/i*100).toFixed(2),h.value[1]=(100-h.value[0]/i*100).toFixed(2))}catch(a){console.error("Fetch error:",a)}};se(m.value,async()=>{console.log("selectedItems : ",m.value),q.value.api.params[1]=m.value,f.value.api.params[1]=m.value,k.value.api.params[0]=m.value,await U()});let L;le(async()=>{await Z(),await U(),C.value=!1,R(),L=setInterval(R,1e3)}),oe(()=>{clearInterval(L)});const ee=async()=>{w("customer",{label:"",value:""}),w("location",{label:"",value:""})};return(o,t)=>(n(),r(D,null,[e("ul",de,[(n(!0),r(D,null,N(X.value,a=>(n(),r("li",{class:"nav-item",key:a.value},[_(ie,{class:E(["nav-link",{active:o.$route.path===a.route}]),to:a.route},{default:O(()=>[x(c(a.label),1)]),_:2},1032,["class","to"])]))),128))]),e("div",ce,[e("div",ve,[t[4]||(t[4]=e("h1",{class:"h3 fw-bold mb-0"}," Maintenance ",-1)),e("div",me,[e("div",null,c(I.value),1)])]),e("div",_e,[e("div",pe,[t[5]||(t[5]=e("label",{class:"form-label"},"Select Location",-1)),C.value?u("",!0):(n(),j(P(M),{key:0,modelValue:b.value,"onUpdate:modelValue":[t[0]||(t[0]=a=>b.value=a),t[1]||(t[1]=a=>w("location",a))],options:V.value||[],placeholder:"Select Location",label:"label","track-by":"value",class:"multiselect no-border"},null,8,["modelValue","options"]))]),e("div",be,[t[6]||(t[6]=e("label",{class:"form-label"},"Select Customer",-1)),C.value?u("",!0):(n(),j(P(M),{key:0,modelValue:p.value,"onUpdate:modelValue":[t[2]||(t[2]=a=>p.value=a),t[3]||(t[3]=a=>w("customer",a))],options:B.value||[],placeholder:"Select Customer",label:"label","track-by":"value",class:"multiselect no-border"},null,8,["modelValue","options"]))]),e("div",ye,[_(ne,{type:"button",color:"danger",size:"md",block:!1,onClick:ee},{default:O(()=>t[7]||(t[7]=[x(" Reset Filter ")])),_:1})])]),e("div",he,[t[13]||(t[13]=e("div",{class:"text-end"},[e("h5",{class:"fw-bold text-primary"})],-1)),e("div",ge,[e("div",fe,[e("div",ke,[e("div",we,[e("h3",xe,c(g.value[0]),1),t[8]||(t[8]=e("p",{class:"fw-bold mb-0"},"On Hire (UIC)",-1))])])]),e("div",Se,[e("div",Ce,[e("div",Ue,[e("h3",De,[e("span",Te,c(y.value[1])+"%",1),t[9]||(t[9]=x(" || ")),e("span",Be,c(y.value[0]),1)]),t[10]||(t[10]=e("p",{class:"fw-bold mb-0"},"PA Unit",-1))])])]),e("div",Ve,[e("div",Ae,[e("div",Fe,[e("h3",Ie,[e("span",Re,c(h.value[1])+"%",1),t[11]||(t[11]=x(" || ")),e("span",Le,c(h.value[0]),1)]),t[12]||(t[12]=e("p",{class:"fw-bold mb-0"},"PA Rental",-1))])])])])])]),e("ul",$e,[(n(),r(D,null,N(Y,a=>e("li",{class:"nav-item",key:a.value},[e("button",{class:E(["nav-link",{active:l.value===a.value}]),onClick:i=>l.value=a.value},c(a.label),11,ze)])),64))]),l.value===""||l.value==="site-summary"?(n(),r("div",Me,[_(ue,{ref_key:"bigTableRef",ref:H,settings:G.value,urls:W.value,fields:Q.value,canInsert:!1,canUpdate:!1},null,8,["settings","urls","fields"])])):u("",!0),l.value===""||["0","1","2","3"].includes(l.value)?(n(),r("div",Ne,[l.value===""||l.value==="0"?(n(),r("div",je)):u("",!0),l.value===""||l.value==="0"?(n(),r("div",Pe,[e("div",Oe,[_(S,{ref_key:"chart11",ref:F,settings:f.value},null,8,["settings"])])])):u("",!0),l.value===""||l.value==="1"?(n(),r("div",Ee,[e("div",He,[_(S,{ref_key:"chart2",ref:A,settings:k.value},null,8,["settings"])])])):u("",!0),l.value===""||l.value==="2"?(n(),r("div",qe,[e("div",Je,[_(S,{settings:J.value},null,8,["settings"])])])):u("",!0),l.value===""||l.value==="3"?(n(),r("div",Ke,[e("div",Ge,[_(S,{settings:K.value},null,8,["settings"])])])):u("",!0)])):u("",!0),t[14]||(t[14]=e("br",null,null,-1)),t[15]||(t[15]=e("br",null,null,-1)),t[16]||(t[16]=e("br",null,null,-1))],64))}},ut=te(Qe,[["__scopeId","data-v-21e5caa7"]]);export{ut as default};
