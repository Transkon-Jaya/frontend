<<<<<<<< HEAD:assets/Timesheet-DZJDnRL-.js
import{u as f,w as v}from"./xlsx-D1NZSDnX.js";import{_,c as i,a as e,F as h,j as m,t as l,b as T,z as g,k as w,h as k,i as y,g as u,d as D,f as N}from"./index-B2ZTZ8RC.js";const S={name:"Timesheet",data(){return{tabs:[{label:"Dashboard",value:"dashboard",route:"/fleet/fleet-main-dashboard"},{label:"Timesheet",value:"timesheet",route:"/fleet/timesheet"},{label:"Invoice",value:"invoice",route:"/fleet/invoice"},{label:"Contract",route:"/fleet/contract"},{label:"Maintenance",value:"maintenance",route:"/fleet/maintenance"},{label:"Notification",value:"notification",route:"/fleet/notification"},{label:"Vehicle List",value:"vehicle-list",route:"/fleet/list-unit"}],currentDate:new Date(2025,4,1),filter:"all",selectedGroup:"",currentPage:1,itemsPerPage:10,units:[{id:1,tkNo:"TK 5083",plateNo:"DA 8043 WA",group:"PT ABC",noLambung:"LV74",model:"Triton HDX facelift",status:this.generateRandomStatus(30),hours:744,breakdowns:0},{id:2,tkNo:"TK 5082",plateNo:"DA 8047 WA",group:"MSO",noLambung:"LV73",model:"Triton HDX facelift",status:this.generateRandomStatus(30),hours:744,breakdowns:0},{id:3,tkNo:"TK 5078",plateNo:"DA 8049 WA",group:"QUIKS",noLambung:"LV72",model:"Triton GLS facelift",status:this.generateRandomStatus(30),hours:720,breakdowns:2},{id:4,tkNo:"TK 6036",plateNo:"KT 8983 ZE",group:"SAM",noLambung:"LV71",model:"Triton GLS facelift",status:this.generateRandomStatus(30),hours:720,breakdowns:1},{id:5,tkNo:"TK 6050",plateNo:"KT 8990 ZE",group:"PT ABC",noLambung:"LV70",model:"Triton GLS Premium",status:this.generateRandomStatus(30),hours:744,breakdowns:0},{id:6,tkNo:"TK 6051",plateNo:"KT 8991 ZE",group:"QVMSO",noLambung:"LV69",model:"Triton HDX",status:this.generateRandomStatus(30),hours:692,breakdowns:3},{id:7,tkNo:"TK 6052",plateNo:"KT 8992 ZE",group:"PT BAA/WAI",noLambung:"LV68",model:"Triton GLS",status:this.generateRandomStatus(30),hours:720,breakdowns:1},{id:8,tkNo:"TK 6053",plateNo:"KT 8993 ZE",group:"PT ABC",noLambung:"LV67",model:"Triton HDX facelift",status:this.generateRandomStatus(30),hours:744,breakdowns:0},{id:9,tkNo:"TK 6054",plateNo:"KT 8994 ZE",group:"MSO",noLambung:"LV66",model:"Triton GLS facelift",status:this.generateRandomStatus(30),hours:720,breakdowns:2},{id:10,tkNo:"TK 6055",plateNo:"KT 8995 ZE",group:"QUIKS",noLambung:"LV65",model:"Triton HDX",status:this.generateRandomStatus(30),hours:720,breakdowns:1},{id:11,tkNo:"TK 6056",plateNo:"KT 8996 ZE",group:"SAM",noLambung:"LV64",model:"Triton GLS Premium",status:this.generateRandomStatus(30),hours:744,breakdowns:0},{id:12,tkNo:"TK 6057",plateNo:"KT 8997 ZE",group:"PT BAA/WAI",noLambung:"LV63",model:"Triton HDX facelift",status:this.generateRandomStatus(30),hours:744,breakdowns:0}]}},computed:{currentMonth(){const o={year:"numeric",month:"long"};return this.currentDate.toLocaleDateString("en-US",o)},daysInMonth(){const o=this.currentDate.getFullYear(),t=this.currentDate.getMonth();return new Date(o,t+1,0).getDate()},groups(){const o=[...new Set(this.units.map(t=>t.group))];return console.log("Groups data:",o),o},filteredUnits(){let o=this.units;this.filter==="group"&&this.selectedGroup&&(o=o.filter(c=>c.group===this.selectedGroup));const t=(this.currentPage-1)*this.itemsPerPage,r=t+this.itemsPerPage;return o.slice(t,r)},totalPages(){return Math.ceil(this.units.length/this.itemsPerPage)},visiblePages(){const o=[];let r=Math.max(1,this.currentPage-Math.floor(2.5)),c=Math.min(this.totalPages,r+5-1);c-r+1<5&&(r=Math.max(1,c-5+1));for(let n=r;n<=c;n++)o.push(n);return o},averageHours(){return this.filteredUnits.length===0?0:this.filteredUnits.reduce((t,r)=>t+r.hours,0)/this.filteredUnits.length},totalBreakdowns(){return this.filteredUnits.reduce((o,t)=>o+t.breakdowns,0)}},methods:{generateRandomStatus(o){return Array.from({length:o},()=>Math.random()>.02?"active":"inactive")},getDayStatusClass(o,t){if(t>o.status.length)return"day-inactive";const r=o.status[t-1];return{"day-active":r==="active","day-inactive":r==="inactive","day-weekend":[0,6].includes(new Date(this.currentDate.getFullYear(),this.currentDate.getMonth(),t).getDay())}},getDayStatusTitle(o,t){if(t>o.status.length)return"No data";const r=o.status[t-1]==="active"?"Active":"Inactive";return`${new Date(this.currentDate.getFullYear(),this.currentDate.getMonth(),t).toLocaleDateString("en-US",{weekday:"short"})}, ${t} ${this.currentMonth}: ${r}`},changeMonth(o){const t=new Date(this.currentDate);t.setMonth(t.getMonth()+o),this.currentDate=t,this.currentPage=1},exportToExcel(){const o=["No","TK","Plat No","Group","No. Lambung","Merek/Model",...Array.from({length:this.daysInMonth},(a,d)=>d+1),"H","BD"],t=this.filteredUnits.map((a,d)=>[d+1,a.tkNo,a.plateNo,a.group,a.noLambung,a.model,...a.status.map(b=>b==="active"?"✓":"✗"),a.hours,a.breakdowns]),r=f.book_new(),c=f.aoa_to_sheet([o,...t]);c["!cols"]||(c["!cols"]=[]),o.forEach((a,d)=>{c["!cols"][d]={width:d<6?15:8}}),f.book_append_sheet(r,c,"Timesheet");const n=`Timesheet_${this.currentDate.getFullYear()}_${this.currentDate.getMonth()+1}.xlsx`;v(r,n)}}},L={class:"nav nav-tabs"},M={class:"container-global"},P={class:"timesheet-header"},K={class:"header-left"},V={class:"month-selector"},A={class:"current-month"},x={class:"timesheet-controls"},C={class:"filter-group"},G=["disabled"],E={class:"table-responsive"},U={class:"table table-bordered timesheet-table"},B={class:"day-headers"},R={class:"sticky-col"},H={class:"sticky-col"},I={class:"sticky-col"},Z={class:"sticky-col"},F={class:"sticky-col"},X={class:"sticky-col"},W=["title"],Y={class:"hours-cell"},O={class:"bd-cell"},Q={class:"summary-footer"},z={class:"summary"},j={class:"summary-item"},q={class:"summary-value"},J={class:"summary-item"},$={class:"summary-value"},tt={class:"summary-item"},et={class:"summary-value"},st={class:"timesheet-footer"},ot={class:"pagination"},at=["disabled"],nt=["onClick"],rt=["disabled"];function lt(o,t,r,c,n,a){const d=y("router-link");return u(),i(h,null,[e("ul",L,[(u(!0),i(h,null,m(n.tabs,s=>(u(),i("li",{class:"nav-item",key:s.value||s.route},[D(d,{class:g(["nav-link",{active:o.$route.path===s.route}]),to:s.route},{default:N(()=>[k(l(s.label),1)]),_:2},1032,["class","to"])]))),128))]),e("div",M,[e("div",P,[e("div",K,[t[8]||(t[8]=e("h2",null,"Timesheet",-1)),e("div",V,[e("button",{class:"btn-nav",onClick:t[0]||(t[0]=s=>a.changeMonth(-1))},"◀"),e("span",A,l(a.currentMonth),1),e("button",{class:"btn-nav",onClick:t[1]||(t[1]=s=>a.changeMonth(1))},"▶")])]),e("div",x,[e("div",C,[e("button",{class:g(["btn btn-filter",{active:n.filter==="all"}]),onClick:t[2]||(t[2]=s=>n.filter="all")},"All",2),e("button",{class:g(["btn btn-filter",{active:n.filter==="group"}]),onClick:t[3]||(t[3]=s=>n.filter="group")},"Group",2),T(e("select",{class:"form-select","onUpdate:modelValue":t[4]||(t[4]=s=>n.selectedGroup=s),disabled:n.filter!=="group"},[t[9]||(t[9]=e("option",{value:""},"Select Group",-1)),(u(!0),i(h,null,m(a.groups,s=>(u(),i("option",{key:s},l(s),1))),128))],8,G),[[w,n.selectedGroup]]),e("button",{class:"btn btn-download",onClick:t[5]||(t[5]=(...s)=>a.exportToExcel&&a.exportToExcel(...s))},t[10]||(t[10]=[e("i",{class:"download-icon"},"↓",-1),k(" Download Excel ")]))])])]),e("div",E,[e("table",U,[e("thead",null,[t[11]||(t[11]=e("tr",null,[e("th",{rowspan:"2",class:"sticky-col"},"No"),e("th",{rowspan:"2",class:"sticky-col"},"TK"),e("th",{rowspan:"2",class:"sticky-col"},"Plat No"),e("th",{rowspan:"2",class:"sticky-col"},"Group"),e("th",{rowspan:"2",class:"sticky-col"},"No. Lambung"),e("th",{rowspan:"2",class:"sticky-col"},"Merek / Model"),e("th",{colspan:"31"},"Days"),e("th",{rowspan:"2"},"H"),e("th",{rowspan:"2"},"BD")],-1)),e("tr",B,[(u(!0),i(h,null,m(a.daysInMonth,s=>(u(),i("th",{key:s},l(s),1))),128))])]),e("tbody",null,[(u(!0),i(h,null,m(a.filteredUnits,(s,b)=>(u(),i("tr",{key:s.id},[e("td",R,l(b+1),1),e("td",H,l(s.tkNo),1),e("td",I,l(s.plateNo),1),e("td",Z,l(s.group),1),e("td",F,l(s.noLambung),1),e("td",X,l(s.model),1),(u(!0),i(h,null,m(a.daysInMonth,p=>(u(),i("td",{key:p},[e("span",{class:g(a.getDayStatusClass(s,p)),title:a.getDayStatusTitle(s,p)},null,10,W)]))),128)),e("td",Y,l(s.hours),1),e("td",O,l(s.breakdowns),1)]))),128))])])]),e("div",Q,[e("div",z,[e("div",j,[t[12]||(t[12]=e("span",{class:"summary-label"},"Total Units:",-1)),e("span",q,l(a.filteredUnits.length),1)]),e("div",J,[t[13]||(t[13]=e("span",{class:"summary-label"},"Avg. Hours:",-1)),e("span",$,l(a.averageHours.toFixed(1)),1)]),e("div",tt,[t[14]||(t[14]=e("span",{class:"summary-label"},"Total BD:",-1)),e("span",et,l(a.totalBreakdowns),1)])]),e("div",st,[e("div",ot,[e("button",{class:"btn-pagination",disabled:n.currentPage===1,onClick:t[6]||(t[6]=s=>n.currentPage--)},"◀",8,at),(u(!0),i(h,null,m(a.visiblePages,s=>(u(),i("span",{key:s,class:g({active:s===n.currentPage}),onClick:b=>n.currentPage=s},l(s),11,nt))),128)),e("button",{class:"btn-pagination",disabled:n.currentPage===a.totalPages,onClick:t[7]||(t[7]=s=>n.currentPage++)},"▶",8,rt)])])])])],64)}const ct=_(S,[["render",lt],["__scopeId","data-v-8e0932cf"]]);export{ct as default};
========
import{u as f,w as v}from"./xlsx-D1NZSDnX.js";import{_,c as i,a as e,F as h,j as m,t as l,b as T,z as g,k as w,h as k,i as y,g as u,d as D,f as N}from"./index--wBuMZOF.js";const S={name:"Timesheet",data(){return{tabs:[{label:"Dashboard",value:"dashboard",route:"/fleet/fleet-main-dashboard"},{label:"Timesheet",value:"timesheet",route:"/fleet/timesheet"},{label:"Invoice",value:"invoice",route:"/fleet/invoice"},{label:"Contract",route:"/fleet/contract"},{label:"Maintenance",value:"maintenance",route:"/fleet/maintenance"},{label:"Notification",value:"notification",route:"/fleet/notification"},{label:"Vehicle List",value:"vehicle-list",route:"/fleet/list-unit"}],currentDate:new Date(2025,4,1),filter:"all",selectedGroup:"",currentPage:1,itemsPerPage:10,units:[{id:1,tkNo:"TK 5083",plateNo:"DA 8043 WA",group:"PT ABC",noLambung:"LV74",model:"Triton HDX facelift",status:this.generateRandomStatus(30),hours:744,breakdowns:0},{id:2,tkNo:"TK 5082",plateNo:"DA 8047 WA",group:"MSO",noLambung:"LV73",model:"Triton HDX facelift",status:this.generateRandomStatus(30),hours:744,breakdowns:0},{id:3,tkNo:"TK 5078",plateNo:"DA 8049 WA",group:"QUIKS",noLambung:"LV72",model:"Triton GLS facelift",status:this.generateRandomStatus(30),hours:720,breakdowns:2},{id:4,tkNo:"TK 6036",plateNo:"KT 8983 ZE",group:"SAM",noLambung:"LV71",model:"Triton GLS facelift",status:this.generateRandomStatus(30),hours:720,breakdowns:1},{id:5,tkNo:"TK 6050",plateNo:"KT 8990 ZE",group:"PT ABC",noLambung:"LV70",model:"Triton GLS Premium",status:this.generateRandomStatus(30),hours:744,breakdowns:0},{id:6,tkNo:"TK 6051",plateNo:"KT 8991 ZE",group:"QVMSO",noLambung:"LV69",model:"Triton HDX",status:this.generateRandomStatus(30),hours:692,breakdowns:3},{id:7,tkNo:"TK 6052",plateNo:"KT 8992 ZE",group:"PT BAA/WAI",noLambung:"LV68",model:"Triton GLS",status:this.generateRandomStatus(30),hours:720,breakdowns:1},{id:8,tkNo:"TK 6053",plateNo:"KT 8993 ZE",group:"PT ABC",noLambung:"LV67",model:"Triton HDX facelift",status:this.generateRandomStatus(30),hours:744,breakdowns:0},{id:9,tkNo:"TK 6054",plateNo:"KT 8994 ZE",group:"MSO",noLambung:"LV66",model:"Triton GLS facelift",status:this.generateRandomStatus(30),hours:720,breakdowns:2},{id:10,tkNo:"TK 6055",plateNo:"KT 8995 ZE",group:"QUIKS",noLambung:"LV65",model:"Triton HDX",status:this.generateRandomStatus(30),hours:720,breakdowns:1},{id:11,tkNo:"TK 6056",plateNo:"KT 8996 ZE",group:"SAM",noLambung:"LV64",model:"Triton GLS Premium",status:this.generateRandomStatus(30),hours:744,breakdowns:0},{id:12,tkNo:"TK 6057",plateNo:"KT 8997 ZE",group:"PT BAA/WAI",noLambung:"LV63",model:"Triton HDX facelift",status:this.generateRandomStatus(30),hours:744,breakdowns:0}]}},computed:{currentMonth(){const o={year:"numeric",month:"long"};return this.currentDate.toLocaleDateString("en-US",o)},daysInMonth(){const o=this.currentDate.getFullYear(),t=this.currentDate.getMonth();return new Date(o,t+1,0).getDate()},groups(){const o=[...new Set(this.units.map(t=>t.group))];return console.log("Groups data:",o),o},filteredUnits(){let o=this.units;this.filter==="group"&&this.selectedGroup&&(o=o.filter(c=>c.group===this.selectedGroup));const t=(this.currentPage-1)*this.itemsPerPage,r=t+this.itemsPerPage;return o.slice(t,r)},totalPages(){return Math.ceil(this.units.length/this.itemsPerPage)},visiblePages(){const o=[];let r=Math.max(1,this.currentPage-Math.floor(2.5)),c=Math.min(this.totalPages,r+5-1);c-r+1<5&&(r=Math.max(1,c-5+1));for(let n=r;n<=c;n++)o.push(n);return o},averageHours(){return this.filteredUnits.length===0?0:this.filteredUnits.reduce((t,r)=>t+r.hours,0)/this.filteredUnits.length},totalBreakdowns(){return this.filteredUnits.reduce((o,t)=>o+t.breakdowns,0)}},methods:{generateRandomStatus(o){return Array.from({length:o},()=>Math.random()>.02?"active":"inactive")},getDayStatusClass(o,t){if(t>o.status.length)return"day-inactive";const r=o.status[t-1];return{"day-active":r==="active","day-inactive":r==="inactive","day-weekend":[0,6].includes(new Date(this.currentDate.getFullYear(),this.currentDate.getMonth(),t).getDay())}},getDayStatusTitle(o,t){if(t>o.status.length)return"No data";const r=o.status[t-1]==="active"?"Active":"Inactive";return`${new Date(this.currentDate.getFullYear(),this.currentDate.getMonth(),t).toLocaleDateString("en-US",{weekday:"short"})}, ${t} ${this.currentMonth}: ${r}`},changeMonth(o){const t=new Date(this.currentDate);t.setMonth(t.getMonth()+o),this.currentDate=t,this.currentPage=1},exportToExcel(){const o=["No","TK","Plat No","Group","No. Lambung","Merek/Model",...Array.from({length:this.daysInMonth},(a,d)=>d+1),"H","BD"],t=this.filteredUnits.map((a,d)=>[d+1,a.tkNo,a.plateNo,a.group,a.noLambung,a.model,...a.status.map(b=>b==="active"?"✓":"✗"),a.hours,a.breakdowns]),r=f.book_new(),c=f.aoa_to_sheet([o,...t]);c["!cols"]||(c["!cols"]=[]),o.forEach((a,d)=>{c["!cols"][d]={width:d<6?15:8}}),f.book_append_sheet(r,c,"Timesheet");const n=`Timesheet_${this.currentDate.getFullYear()}_${this.currentDate.getMonth()+1}.xlsx`;v(r,n)}}},L={class:"nav nav-tabs"},M={class:"container-global"},P={class:"timesheet-header"},K={class:"header-left"},V={class:"month-selector"},A={class:"current-month"},x={class:"timesheet-controls"},C={class:"filter-group"},G=["disabled"],E={class:"table-responsive"},U={class:"table table-bordered timesheet-table"},B={class:"day-headers"},R={class:"sticky-col"},H={class:"sticky-col"},I={class:"sticky-col"},Z={class:"sticky-col"},F={class:"sticky-col"},X={class:"sticky-col"},W=["title"],Y={class:"hours-cell"},O={class:"bd-cell"},Q={class:"summary-footer"},z={class:"summary"},j={class:"summary-item"},q={class:"summary-value"},J={class:"summary-item"},$={class:"summary-value"},tt={class:"summary-item"},et={class:"summary-value"},st={class:"timesheet-footer"},ot={class:"pagination"},at=["disabled"],nt=["onClick"],rt=["disabled"];function lt(o,t,r,c,n,a){const d=y("router-link");return u(),i(h,null,[e("ul",L,[(u(!0),i(h,null,m(n.tabs,s=>(u(),i("li",{class:"nav-item",key:s.value||s.route},[D(d,{class:g(["nav-link",{active:o.$route.path===s.route}]),to:s.route},{default:N(()=>[k(l(s.label),1)]),_:2},1032,["class","to"])]))),128))]),e("div",M,[e("div",P,[e("div",K,[t[8]||(t[8]=e("h2",null,"Timesheet",-1)),e("div",V,[e("button",{class:"btn-nav",onClick:t[0]||(t[0]=s=>a.changeMonth(-1))},"◀"),e("span",A,l(a.currentMonth),1),e("button",{class:"btn-nav",onClick:t[1]||(t[1]=s=>a.changeMonth(1))},"▶")])]),e("div",x,[e("div",C,[e("button",{class:g(["btn btn-filter",{active:n.filter==="all"}]),onClick:t[2]||(t[2]=s=>n.filter="all")},"All",2),e("button",{class:g(["btn btn-filter",{active:n.filter==="group"}]),onClick:t[3]||(t[3]=s=>n.filter="group")},"Group",2),T(e("select",{class:"form-select","onUpdate:modelValue":t[4]||(t[4]=s=>n.selectedGroup=s),disabled:n.filter!=="group"},[t[9]||(t[9]=e("option",{value:""},"Select Group",-1)),(u(!0),i(h,null,m(a.groups,s=>(u(),i("option",{key:s},l(s),1))),128))],8,G),[[w,n.selectedGroup]]),e("button",{class:"btn btn-download",onClick:t[5]||(t[5]=(...s)=>a.exportToExcel&&a.exportToExcel(...s))},t[10]||(t[10]=[e("i",{class:"download-icon"},"↓",-1),k(" Download Excel ")]))])])]),e("div",E,[e("table",U,[e("thead",null,[t[11]||(t[11]=e("tr",null,[e("th",{rowspan:"2",class:"sticky-col"},"No"),e("th",{rowspan:"2",class:"sticky-col"},"TK"),e("th",{rowspan:"2",class:"sticky-col"},"Plat No"),e("th",{rowspan:"2",class:"sticky-col"},"Group"),e("th",{rowspan:"2",class:"sticky-col"},"No. Lambung"),e("th",{rowspan:"2",class:"sticky-col"},"Merek / Model"),e("th",{colspan:"31"},"Days"),e("th",{rowspan:"2"},"H"),e("th",{rowspan:"2"},"BD")],-1)),e("tr",B,[(u(!0),i(h,null,m(a.daysInMonth,s=>(u(),i("th",{key:s},l(s),1))),128))])]),e("tbody",null,[(u(!0),i(h,null,m(a.filteredUnits,(s,b)=>(u(),i("tr",{key:s.id},[e("td",R,l(b+1),1),e("td",H,l(s.tkNo),1),e("td",I,l(s.plateNo),1),e("td",Z,l(s.group),1),e("td",F,l(s.noLambung),1),e("td",X,l(s.model),1),(u(!0),i(h,null,m(a.daysInMonth,p=>(u(),i("td",{key:p},[e("span",{class:g(a.getDayStatusClass(s,p)),title:a.getDayStatusTitle(s,p)},null,10,W)]))),128)),e("td",Y,l(s.hours),1),e("td",O,l(s.breakdowns),1)]))),128))])])]),e("div",Q,[e("div",z,[e("div",j,[t[12]||(t[12]=e("span",{class:"summary-label"},"Total Units:",-1)),e("span",q,l(a.filteredUnits.length),1)]),e("div",J,[t[13]||(t[13]=e("span",{class:"summary-label"},"Avg. Hours:",-1)),e("span",$,l(a.averageHours.toFixed(1)),1)]),e("div",tt,[t[14]||(t[14]=e("span",{class:"summary-label"},"Total BD:",-1)),e("span",et,l(a.totalBreakdowns),1)])]),e("div",st,[e("div",ot,[e("button",{class:"btn-pagination",disabled:n.currentPage===1,onClick:t[6]||(t[6]=s=>n.currentPage--)},"◀",8,at),(u(!0),i(h,null,m(a.visiblePages,s=>(u(),i("span",{key:s,class:g({active:s===n.currentPage}),onClick:b=>n.currentPage=s},l(s),11,nt))),128)),e("button",{class:"btn-pagination",disabled:n.currentPage===a.totalPages,onClick:t[7]||(t[7]=s=>n.currentPage++)},"▶",8,rt)])])])])],64)}const ct=_(S,[["render",lt],["__scopeId","data-v-8e0932cf"]]);export{ct as default};
>>>>>>>> dd9801410e2849a16ff8ec35e879c24411c7184b:assets/Timesheet-D5nRydbH.js
