import{_ as S,c as o,a as t,q as d,b as m,k as f,v as c,t as r,F as v,j as b,z as y,p as L,A,u as _,g as u,h as I,W as T}from"./index-DDtFK-1e.js";const k={newbie:["Apa fungsi utama dari alternator?|Menghasilkan listrik|Menyimpan listrik|Menyalakan mesin|Mengatur suhu|A","Oli mesin harus diganti setiap...|3 bulan atau 5000 km|1 tahun|Saat mesin panas|Saat bensin habis|A"],junior:["Apa yang dimaksud dengan timing belt?|Sabuk penggerak katup|Sabuk AC|Sabuk power steering|Sabuk alternator|A","Tekanan ban normal untuk mobil sedan adalah...|32 psi|10 psi|50 psi|20 psi|A"],senior:["ECU pada mobil modern berfungsi sebagai...|Otak kendaraan|Pompa bahan bakar|Sensor suhu|Pendingin mesin|A","Diagnosis OBD2 kode P0301 berarti...|Silinder 1 misfire|Suhu terlalu tinggi|Oli rendah|Baterai lemah|A"]},Q={name:"Training",setup(){const i=_(),e=i.role==="admin";return{userStore:i,isAdmin:e}},data(){return{gameStarted:!1,gameActive:!1,gameFinished:!1,timeLeft:0,timer:null,selectedLevel:"",trainingTitle:"Pelatihan Mekanik",timeLimit:600,questionInput:"",questions:[],randomizedQuestions:[],currentQuestionIndex:0,userAnswers:Array(25).fill(null),startTime:null,timeTaken:0,trainingHistory:[],currentUser:""}},computed:{currentQuestion(){return this.randomizedQuestions[this.currentQuestionIndex]||{}},score(){let i=0;return this.randomizedQuestions.forEach((e,l)=>{this.userAnswers[l]===e.answer&&i++}),i},accuracy(){return Math.round(this.score/25*100)}},methods:{selectLevel(i){this.selectedLevel=i,this.loadQuestions(i)},loadQuestions(i){const e=localStorage.getItem(`training_questions_${i}`);this.questions=e?JSON.parse(e):k[i],this.trainingTitle=localStorage.getItem(`training_title_${i}`)||this.trainingTitle,this.timeLimit=parseInt(localStorage.getItem(`training_time_${i}`))||this.timeLimit,this.questionInput=this.questions.join(`
`)},saveQuestions(){const i=this.questionInput.split(`
`).filter(e=>e.trim()).slice(0,25);if(i.length<25){alert("Harus ada 25 soal.");return}localStorage.setItem(`training_questions_${this.selectedLevel}`,JSON.stringify(i)),localStorage.setItem(`training_title_${this.selectedLevel}`,this.trainingTitle),localStorage.setItem(`training_time_${this.selectedLevel}`,this.timeLimit),this.loadQuestions(this.selectedLevel),alert("Soal berhasil disimpan!")},parseQuestions(i){return i.map(e=>{const l=e.split("|");return{question:l[0],options:{A:l[1],B:l[2],C:l[3],D:l[4]},answer:l[5]}})},startTraining(){if(!this.selectedLevel)return;this.gameStarted=!0,this.gameActive=!0,this.startTime=Date.now(),this.timeLeft=this.timeLimit;const i=localStorage.getItem(`training_questions_${this.selectedLevel}`)||k[this.selectedLevel],e=Array.isArray(i)?i:i.split(`
`);this.questions=this.parseQuestions(e),this.randomizedQuestions=[...this.questions].sort(()=>Math.random()-.5).slice(0,25),this.currentQuestionIndex=0,this.userAnswers=Array(25).fill(null),this.timer=setInterval(()=>{this.timeLeft--,this.timeLeft<=0&&this.finishTraining()},1e3)},nextQuestion(){this.currentQuestionIndex<24?this.currentQuestionIndex++:this.finishTraining()},finishTraining(){clearInterval(this.timer),this.timeTaken=this.timeLimit-this.timeLeft,this.gameActive=!1,this.gameFinished=!0;const i={level:this.selectedLevel,score:this.score,date:new Date().toLocaleDateString(),time:this.timeTaken},e=JSON.parse(localStorage.getItem("training_history")||"[]");e.push(i),localStorage.setItem("training_history",JSON.stringify(e)),this.trainingHistory=e,this.submitScore(i)},async submitScore(i){try{const e=this.userStore.token||localStorage.getItem("token");await L.post(`${A}/training/score`,i,{headers:{Authorization:`Bearer ${e}`}})}catch(e){console.error("Gagal kirim skor:",e)}},restartTraining(){this.gameStarted=!1,this.gameFinished=!1,this.selectedLevel=""},formatTime(i){const e=Math.floor(i/60),l=i%60;return`${e}:${l<10?"0":""}${l}`},getFeedback(){return this.score>=20?"Luar biasa! Anda siap ke level berikutnya.":this.score>=15?"Bagus! Masih ada ruang untuk perbaikan.":"Perlu belajar lebih banyak. Coba lagi!"},formatLevel(i){return{newbie:"Newbie Mechanic",junior:"Junior Mechanic",senior:"Senior Mechanic"}[i]||i}},mounted(){const i=JSON.parse(localStorage.getItem("training_history")||"[]");this.trainingHistory=i}},M={class:"container"},w={key:0,class:"admin-panel"},x={class:"form-group"},q={class:"form-group"},C={class:"form-group"},P={class:"form-group"},B={key:1,class:"start-screen"},D={class:"level-selector"},N={class:"history-section"},F={class:"history-table"},U={key:2,class:"game-screen"},j={class:"header"},J={class:"timer"},O={class:"time"},V={class:"progress"},z={class:"label"},H={class:"question-container"},W={class:"options"},E=["value"],R={key:3,class:"results-screen"},K={class:"result-cards"},G={class:"card"},X={class:"card-value"},Y={class:"card"},Z={class:"card-value"},$={class:"card"},ee={class:"card-value"},te={class:"feedback"};function ie(i,e,l,h,s,a){return u(),o("div",{class:y(["training-page",{"game-active":s.gameActive}])},[t("div",M,[h.isAdmin&&!s.gameStarted?(u(),o("div",w,[e[17]||(e[17]=t("h2",null,"Admin: Manajemen Pelatihan",-1)),t("div",x,[e[13]||(e[13]=t("label",null,"Level Pelatihan",-1)),m(t("select",{"onUpdate:modelValue":e[0]||(e[0]=n=>s.selectedLevel=n),class:"form-control"},e[12]||(e[12]=[t("option",{value:"newbie"},"Newbie Mechanic",-1),t("option",{value:"junior"},"Junior Mechanic",-1),t("option",{value:"senior"},"Senior Mechanic",-1)]),512),[[f,s.selectedLevel]])]),t("div",q,[e[14]||(e[14]=t("label",null,"Judul Pelatihan",-1)),m(t("input",{"onUpdate:modelValue":e[1]||(e[1]=n=>s.trainingTitle=n),class:"form-control",placeholder:"Contoh: Dasar Mesin"},null,512),[[c,s.trainingTitle]])]),t("div",C,[e[15]||(e[15]=t("label",null,"Waktu (detik)",-1)),m(t("input",{"onUpdate:modelValue":e[2]||(e[2]=n=>s.timeLimit=n),type:"number",min:"30",max:"3600",class:"form-control"},null,512),[[c,s.timeLimit,void 0,{number:!0}]])]),t("div",P,[e[16]||(e[16]=t("label",null,"Soal Pelatihan (Format: Pertanyaan|A|B|C|D|Kunci)",-1)),m(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=n=>s.questionInput=n),class:"form-control",rows:"10",placeholder:`Soal 1|A|B|C|D|A
Soal 2|A|B|C|D|C`},null,512),[[c,s.questionInput]])]),t("button",{onClick:e[4]||(e[4]=(...n)=>a.saveQuestions&&a.saveQuestions(...n)),class:"btn btn-primary"},"Simpan Soal")])):d("",!0),!s.gameStarted&&!h.isAdmin?(u(),o("div",B,[t("h1",null,r(s.trainingTitle),1),e[20]||(e[20]=t("p",null,"Pilih level pelatihan untuk memulai.",-1)),t("div",D,[t("button",{onClick:e[5]||(e[5]=n=>a.selectLevel("newbie")),class:"level-btn"},"Newbie Mechanic"),t("button",{onClick:e[6]||(e[6]=n=>a.selectLevel("junior")),class:"level-btn"},"Junior Mechanic"),t("button",{onClick:e[7]||(e[7]=n=>a.selectLevel("senior")),class:"level-btn"},"Senior Mechanic")]),t("div",N,[e[19]||(e[19]=t("h3",null,"Riwayat Pelatihan",-1)),t("table",F,[e[18]||(e[18]=t("thead",null,[t("tr",null,[t("th",null,"Level"),t("th",null,"Skor"),t("th",null,"Waktu")])],-1)),t("tbody",null,[(u(!0),o(v,null,b(s.trainingHistory,n=>(u(),o("tr",{key:n.id},[t("td",null,r(a.formatLevel(n.level)),1),t("td",null,r(n.score)+" / 25",1),t("td",null,r(n.date),1)]))),128))])])]),s.selectedLevel?(u(),o("button",{key:0,onClick:e[8]||(e[8]=(...n)=>a.startTraining&&a.startTraining(...n)),class:"start-btn"}," Mulai Pelatihan ("+r(s.timeLimit)+" detik) ",1)):d("",!0)])):d("",!0),s.gameStarted&&!s.gameFinished?(u(),o("div",U,[t("div",j,[t("div",J,[t("span",O,r(a.formatTime(s.timeLeft)),1),e[21]||(e[21]=t("span",{class:"label"},"WAKTU",-1))]),t("div",V,[t("span",z,"Soal "+r(s.currentQuestionIndex+1)+" / 25",1)])]),t("div",H,[t("h2",null,r(a.currentQuestion.question),1),t("div",W,[(u(!0),o(v,null,b(a.currentQuestion.options,(n,g)=>(u(),o("label",{key:g,class:"option"},[m(t("input",{type:"radio",value:g,"onUpdate:modelValue":e[9]||(e[9]=p=>s.userAnswers[s.currentQuestionIndex]=p)},null,8,E),[[T,s.userAnswers[s.currentQuestionIndex]]]),I(" "+r(n),1)]))),128))])]),t("button",{onClick:e[10]||(e[10]=(...n)=>a.nextQuestion&&a.nextQuestion(...n)),class:"btn btn-next"},r(s.currentQuestionIndex===24?"Selesai":"Soal Selanjutnya"),1)])):d("",!0),s.gameFinished?(u(),o("div",R,[e[25]||(e[25]=t("h1",null,"Hasil Pelatihan",-1)),t("div",K,[t("div",G,[t("div",X,r(a.score),1),e[22]||(e[22]=t("div",{class:"card-label"},"Benar / 25",-1))]),t("div",Y,[t("div",Z,r(a.accuracy)+"%",1),e[23]||(e[23]=t("div",{class:"card-label"},"Akurasi",-1))]),t("div",$,[t("div",ee,r(s.timeTaken)+" detik",1),e[24]||(e[24]=t("div",{class:"card-label"},"Waktu Digunakan",-1))])]),t("div",te,[t("h3",null,r(a.getFeedback()),1)]),t("button",{onClick:e[11]||(e[11]=(...n)=>a.restartTraining&&a.restartTraining(...n)),class:"restart-btn"},"Coba Lagi")])):d("",!0)])],2)}const ne=S(Q,[["render",ie],["__scopeId","data-v-2e0d5d65"]]);export{ne as default};
