import{u as D,r as v,l as S,o as B,s as g,c as f,a as s,p as C,n as y,b as r,v as n,d as P,f as x,V,g as c,h as U,D as N,x as E,E as M}from"./index-DM0HGBBV.js";const T={class:"row"},I={class:"col-xl-6 mx-auto"},_={class:"card"},j={class:"card-body p-4"},A={class:"col-md-12"},L={class:"col-md-12"},R={class:"col-md-12"},q={class:"col-md-12"},z={class:"col-md-12"},G={class:"col-md-12"},H={class:"col-md-12"},J={class:"col-md-12"},K={key:0,class:"text-danger"},O={class:"col-md-12"},Q={key:0,class:"mt-3"},W=["src"],X={class:"col-md-12 mt-4 mb-3 d-flex gap-3"},m="Loading...",$={__name:"ProfileView",setup(Y){const d=D(),b=d.apiBaseUrl+"/profile",o=v({name:m,email:m,phone:m,department:m,position:m,username:m,password:"",confirmPassword:""}),t=new FormData,i=v(),p=v(null),h=l=>{p.value=l.target.files[0]},u=S(()=>o.value.password!==o.value.confirmPassword);B(async()=>{console.log("Photo : ",d.photo);try{const l=await g.get(b,{params:{username:d.username}});i.value=l.data[0],w()}catch(l){console.error("Fetch error:",l)}});const w=()=>{o.value.name=i.value.name,o.value.email=i.value.email,o.value.phone=i.value.phone,o.value.department=i.value.department,o.value.position=i.value.jabatan,o.value.username=d.username,o.value.password="",o.value.confirmPassword=""},F=()=>{w()},k=async()=>{if(!u.value)try{t.append("name",o.value.name),t.append("email",o.value.email),t.append("phone",o.value.phone),t.append("department",o.value.department),t.append("position",o.value.position),t.append("username",o.value.username),o.value.password&&t.append("password",o.value.password),p.value&&t.append("profilePicture",p.value);const l=await g.post(b,t);N("update profile : ",l.data),d.setProfile(l.data.foto),N("user data : ",d.photo),await E(),window.location.reload(),alert("Profile updated successfully!")}catch(l){M("Submit error:",l),alert("Error updating profile.")}};return(l,e)=>(c(),f("div",T,[s("div",I,[s("div",_,[e[19]||(e[19]=s("div",{class:"card-header px-4 py-3"},[s("h5",{class:"mb-0"},"User Settings")],-1)),s("div",j,[s("form",{onSubmit:C(k,["prevent"]),class:"row g-3 needs-validation",novalidate:""},[s("div",A,[e[8]||(e[8]=s("label",{for:"Name",class:"form-label"},"Name",-1)),r(s("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>o.value.name=a),type:"text",class:"form-control",id:"firstName",disabled:""},null,512),[[n,o.value.name]])]),s("div",L,[e[9]||(e[9]=s("label",{for:"phone",class:"form-label"},"E-mail",-1)),r(s("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>o.value.email=a),type:"text",class:"form-control",id:"email"},null,512),[[n,o.value.email]])]),s("div",R,[e[10]||(e[10]=s("label",{for:"phone",class:"form-label"},"Phone",-1)),r(s("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.phone=a),type:"text",class:"form-control",id:"phone"},null,512),[[n,o.value.phone]])]),s("div",q,[e[11]||(e[11]=s("label",{for:"department",class:"form-label"},"Department",-1)),r(s("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>o.value.department=a),type:"text",class:"form-control",id:"department",disabled:""},null,512),[[n,o.value.department]])]),s("div",z,[e[12]||(e[12]=s("label",{for:"position",class:"form-label"},"Position",-1)),r(s("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>o.value.position=a),type:"text",class:"form-control",id:"position",disabled:""},null,512),[[n,o.value.position]])]),s("div",G,[e[13]||(e[13]=s("label",{for:"userName",class:"form-label"},"User Name",-1)),r(s("input",{"onUpdate:modelValue":e[5]||(e[5]=a=>o.value.username=a),type:"userName",class:"form-control",id:"userName",disabled:""},null,512),[[n,o.value.username]])]),s("div",H,[e[14]||(e[14]=s("label",{for:"password",class:"form-label"},"Password",-1)),r(s("input",{"onUpdate:modelValue":e[6]||(e[6]=a=>o.value.password=a),type:"password",class:"form-control",id:"password"},null,512),[[n,o.value.password]])]),s("div",J,[e[15]||(e[15]=s("label",{for:"confirmationPassword",class:"form-label"},"Confirm Password",-1)),r(s("input",{"onUpdate:modelValue":e[7]||(e[7]=a=>o.value.confirmPassword=a),type:"password",class:"form-control",id:"confirmationPassword"},null,512),[[n,o.value.confirmPassword]])]),u.value?(c(),f("small",K," Passwords do not match! ")):y("",!0),s("div",O,[e[16]||(e[16]=s("label",{for:"photo",class:"form-label"},"Upload Photo",-1)),s("input",{type:"file",class:"form-control",id:"photo",onChange:h,accept:"image/*"},null,32),l.previewImage?(c(),f("div",Q,[s("img",{src:l.previewImage,alt:"Preview",class:"img-thumbnail",style:{"max-width":"200px"}},null,8,W)])):y("",!0)]),s("div",X,[P(V,{type:"submit",class:"btn btn-danger",disabled:u.value},{default:x(()=>e[17]||(e[17]=[U("Submit ")])),_:1},8,["disabled"]),P(V,{type:"reset",class:"btn btn-secondary",onClick:F},{default:x(()=>e[18]||(e[18]=[U(" Reset ")])),_:1})])],32)])])])]))}};export{$ as default};
