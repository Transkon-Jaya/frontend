import{_ as Y,r as d,o as Z,l as I,c as o,a as e,n as j,h as m,t as n,F as g,j as k,b as p,k as h,y as x,p as ee,v as U,q as $,A as N,E as te,g as r}from"./index-CtWxdhVx.js";const ae={class:"card border-0 shadow-sm"},le={class:"card-header"},se={class:"d-flex justify-content-between align-items-center"},ne=["disabled"],oe={class:"card-body"},re={key:0,class:"alert alert-danger alert-dismissible fade show"},ue={key:1,class:"text-center py-5"},ie={key:2,class:"table-responsive"},de={class:"table table-hover table-striped table-bordered mb-0"},ve={class:"table-dark"},ce=["onUpdate:modelValue","placeholder"],me={key:0},be=["colspan"],pe={class:"text-center"},fe=["onClick"],ge={class:"text-center"},ke={class:"text-center"},ye={class:"text-center"},_e={class:"text-center"},xe={class:"text-center"},we={class:"text-center"},he={class:"text-center"},Ce={class:"btn-group btn-group-sm",role:"group"},je=["onClick"],Ee=["onClick"],Le={class:"d-flex flex-wrap justify-content-between align-items-center mt-3"},Pe={class:"d-flex align-items-center mb-2"},$e=["value"],Ne={class:"text-muted"},Se={"aria-label":"Page navigation"},Ie={class:"pagination pagination-sm mb-0"},Ue={class:"page-item disabled"},Ve={class:"page-link"},Be={key:0,class:"modal fade show d-block",style:{background:"rgba(0,0,0,0.5)"}},Ae={class:"modal-dialog modal-dialog-centered"},Oe={class:"modal-content border-0 shadow"},qe={class:"modal-title"},Ke={class:"modal-body"},Te={class:"mb-3"},Fe=["disabled"],Me={class:"mb-3"},Re={class:"mb-3"},De=["value"],Je={class:"mb-3"},Ge=["value"],He={class:"mb-3"},ze=["value"],Qe={class:"mb-3"},We=["value"],Xe={class:"mb-3"},Ye=["value"],Ze={class:"modal-footer border-top-0"},et={key:1,class:"modal fade show d-block",style:{background:"rgba(0,0,0,0.5)"}},tt={class:"modal-dialog modal-dialog-centered"},at={class:"modal-content border-0 shadow"},lt={class:"modal-body"},st={__name:"Employee",setup(nt){const F=te(),v=d([]),s=d({departments:[],jabatan:[],placements:[],genders:["L","P"],locations:[]}),E=d(!0),w=d(null),M=d(0),L=d(!1),c=d(!1),u=d({}),V=d(-1),C=d(!1),y=d(null),f=d({username:"",name:"",department:"",jabatan:"",placement:"",gender:"",lokasi:""}),_=d(10),b=d(1),R=[10,20,50,{value:-1,text:"All"}],B=[{text:"NIK",value:"username",align:"center",sortable:!0,filterable:!0},{text:"Nama",value:"name",align:"center",sortable:!0,filterable:!0},{text:"Departemen",value:"department",align:"center",sortable:!0,filterable:!0},{text:"Position",value:"jabatant",align:"center",sortable:!0,filterable:!0},{text:"Penempatan",value:"placement",align:"center",sortable:!0,filterable:!0},{text:"Gender",value:"gender",align:"center",sortable:!0,filterable:!0},{text:"Lokasi",value:"lokasi",align:"center",sortable:!0,filterable:!0},{text:"Actions",value:"actions",align:"center",sortable:!1,filterable:!1}],D=async()=>{var l,t;try{E.value=!0;const a=await $.get(`${N}/users`);v.value=a.data,M.value=v.value.length,s.value.departments=[...new Set(v.value.map(i=>i.department).filter(Boolean))],s.value.jabatan=[...new Set(v.value.map(i=>i.jabatan).filter(Boolean))],s.value.placements=[...new Set(v.value.map(i=>i.placement).filter(Boolean))],s.value.locations=[...new Set(v.value.map(i=>i.lokasi).filter(Boolean))],s.value.site=[...new Set(v.value.map(i=>i.site).filter(Boolean))],E.value=!1}catch(a){w.value=((t=(l=a.response)==null?void 0:l.data)==null?void 0:t.message)||a.message,E.value=!1}};Z(async()=>{await D()});const P=I(()=>v.value.filter(l=>Object.keys(f.value).every(t=>f.value[t]?String(l[t]).toLowerCase().includes(f.value[t].toLowerCase()):!0))),S=I(()=>{if(_.value===-1)return P.value;const l=(b.value-1)*_.value,t=l+_.value;return P.value.slice(l,t)}),A=I(()=>_.value===-1?1:Math.ceil(P.value.length/_.value)),J=()=>{u.value={username:"",name:"",department:s.value.departments[0]||"",department:s.value.jabatan[0]||"",placement:s.value.placements[0]||"",gender:s.value.genders[0]||"L",lokasi:s.value.locations[0]||"",site:s.value.site[0]||""},c.value=!0},G=l=>{V.value=v.value.findIndex(t=>t.username===l.username),u.value=JSON.parse(JSON.stringify(l)),L.value=!0},H=async()=>{var l,t;try{if(c.value){const a=await $.post(`${N}/users`,u.value,{headers:{"Content-Type":"application/json"}});v.value.unshift(a.data),O(a.data),c.value=!1}else{const a=await $.put(`${N}/users`,u.value,{headers:{"Content-Type":"application/json"}});v.value[V.value]=a.data,O(a.data),L.value=!1}u.value={}}catch(a){w.value=((t=(l=a.response)==null?void 0:l.data)==null?void 0:t.error)||a.message,console.error("CRUD Error:",a)}},O=l=>{l.department&&!s.value.departments.includes(l.department)&&s.value.departments.push(l.department),l.jabatan&&!s.value.jabatans.includes(l.jabatan)&&s.value.jabatans.push(l.jabatan),l.placement&&!s.value.placements.includes(l.placement)&&s.value.placements.push(l.placement),l.lokasi&&!s.value.locations.includes(l.lokasi)&&s.value.locations.push(l.lokasi)},z=l=>{y.value=l,C.value=!0},Q=async()=>{var l,t;try{await $.delete(`${N}/users/${y.value.username}`),v.value=v.value.filter(a=>a.username!==y.value.username),C.value=!1,y.value=null}catch(a){w.value=((t=(l=a.response)==null?void 0:l.data)==null?void 0:t.message)||a.message,C.value=!1}},q=()=>{C.value=!1,y.value=null},K=()=>{L.value=!1,c.value=!1,u.value={}},W=l=>{F.push({name:"hr-absensi-detail",params:{username:l}})},X=()=>{Object.keys(f.value).forEach(l=>{f.value[l]=""}),b.value=1};return(l,t)=>(r(),o("div",ae,[e("div",le,[e("div",se,[t[15]||(t[15]=e("h3",{class:"mb-0"},"List Karyawan",-1)),e("div",null,[e("button",{onClick:X,class:"btn btn-sm btn-light me-2",disabled:!Object.values(f.value).some(Boolean)},t[13]||(t[13]=[e("i",{class:"fas fa-filter-circle-xmark me-1"},null,-1),m(" Reset Filters ")]),8,ne),e("button",{onClick:J,class:"btn btn-sm btn-danger"},t[14]||(t[14]=[e("i",{class:"fas fa-plus me-1"},null,-1),m(" Add New ")]))])])]),e("div",oe,[w.value?(r(),o("div",re,[m(n(w.value)+" ",1),e("button",{type:"button",class:"btn-close",onClick:t[0]||(t[0]=a=>w.value=null)})])):j("",!0),E.value?(r(),o("div",ue,t[16]||(t[16]=[e("div",{class:"spinner-border text-primary",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1),e("p",{class:"mt-2"},"Loading data...",-1)]))):(r(),o("div",ie,[e("table",de,[e("thead",ve,[e("tr",null,[(r(),o(g,null,k(B,a=>e("th",{key:a.value,class:x(a.align?`text-${a.align}`:"")},[e("div",null,n(a.text),1),a.filterable?p((r(),o("input",{key:0,"onUpdate:modelValue":i=>f.value[a.value]=i,type:"text",class:"form-control form-control-sm mt-1",placeholder:`Filter ${a.text}`,onInput:t[1]||(t[1]=i=>b.value=1)},null,40,ce)),[[U,f.value[a.value]]]):j("",!0)],2)),64))])]),e("tbody",null,[S.value.length===0?(r(),o("tr",me,[e("td",{colspan:B.length,class:"text-center py-4"},"No data available",8,be)])):j("",!0),(r(!0),o(g,null,k(S.value,(a,i)=>(r(),o("tr",{key:i,class:"align-middle"},[e("td",pe,[e("a",{href:"javascript:void(0)",onClick:T=>W(a.username),class:"text-primary fw-semibold"},n(a.username),9,fe)]),e("td",ge,n(a.name),1),e("td",ke,n(a.department),1),e("td",ye,n(a.jabatan),1),e("td",_e,n(a.placement),1),e("td",xe,[e("span",{class:x(["badge",a.gender==="Laki-laki"?"bg-info":"bg-danger"])},n(a.gender),3)]),e("td",we,n(a.lokasi),1),e("td",he,[e("div",Ce,[e("button",{onClick:T=>G(a),class:"btn btn-warning",title:"Edit"},t[17]||(t[17]=[e("i",{class:"fas fa-edit"},null,-1)]),8,je),e("button",{onClick:T=>z(a),class:"btn btn-danger",title:"Delete",id:"confirm-text"},t[18]||(t[18]=[e("i",{class:"fas fa-trash-alt"},null,-1)]),8,Ee)])])]))),128))])])])),e("div",Le,[e("div",Pe,[p(e("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>_.value=a),class:"form-select form-select-sm me-2",style:{width:"90px"},onChange:t[3]||(t[3]=a=>b.value=1)},[(r(),o(g,null,k(R,a=>e("option",{key:a.value||a,value:a.value||a},n(a.text||a),9,$e)),64))],544),[[h,_.value]]),e("small",Ne," Showing "+n(S.value.length)+" of "+n(P.value.length)+" entries ",1)]),e("nav",Se,[e("ul",Ie,[e("li",{class:x(["page-item",{disabled:b.value===1}])},[e("button",{class:"page-link",onClick:t[4]||(t[4]=a=>b.value--)},t[19]||(t[19]=[e("i",{class:"fas fa-chevron-left"},null,-1)]))],2),e("li",Ue,[e("span",Ve," Page "+n(b.value)+" of "+n(A.value),1)]),e("li",{class:x(["page-item",{disabled:b.value===A.value}])},[e("button",{class:"page-link",onClick:t[5]||(t[5]=a=>b.value++)},t[20]||(t[20]=[e("i",{class:"fas fa-chevron-right"},null,-1)]))],2)])])])]),L.value||c.value?(r(),o("div",Be,[e("div",Ae,[e("div",Oe,[e("div",{class:x(["modal-header",(c.value,"bg-danger text-white")])},[e("h5",qe,n(c.value?"Tambah Karyawan Baru":"Edit Karyawan"),1),e("button",{type:"button",class:x(["btn-close",(c.value,"btn-close-white")]),onClick:K},null,2)],2),e("div",Ke,[e("form",{onSubmit:ee(H,["prevent"])},[e("div",Te,[t[21]||(t[21]=e("label",{class:"form-label"},[m("NIK "),e("span",{class:"text-danger"},"*")],-1)),p(e("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>u.value.username=a),type:"text",class:"form-control",disabled:!c.value,required:""},null,8,Fe),[[U,u.value.username]])]),e("div",Me,[t[22]||(t[22]=e("label",{class:"form-label"},[m("Nama "),e("span",{class:"text-danger"},"*")],-1)),p(e("input",{"onUpdate:modelValue":t[7]||(t[7]=a=>u.value.name=a),type:"text",class:"form-control",required:""},null,512),[[U,u.value.name]])]),e("div",Re,[t[23]||(t[23]=e("label",{class:"form-label"},"Departemen",-1)),p(e("select",{"onUpdate:modelValue":t[8]||(t[8]=a=>u.value.department=a),class:"form-select",required:""},[(r(!0),o(g,null,k(s.value.departments,a=>(r(),o("option",{key:a,value:a},n(a),9,De))),128))],512),[[h,u.value.department]])]),e("div",Je,[t[24]||(t[24]=e("label",{class:"form-label"},"Jabatan",-1)),p(e("select",{"onUpdate:modelValue":t[9]||(t[9]=a=>u.value.jabatan=a),class:"form-select",required:""},[(r(!0),o(g,null,k(s.value.jabatan,a=>(r(),o("option",{key:a,value:a},n(a),9,Ge))),128))],512),[[h,u.value.jabatan]])]),e("div",He,[t[25]||(t[25]=e("label",{class:"form-label"},"Penempatan",-1)),p(e("select",{"onUpdate:modelValue":t[10]||(t[10]=a=>u.value.placement=a),class:"form-select",required:""},[(r(!0),o(g,null,k(s.value.placements,a=>(r(),o("option",{key:a,value:a},n(a),9,ze))),128))],512),[[h,u.value.placement]])]),e("div",Qe,[t[26]||(t[26]=e("label",{class:"form-label"},"Gender",-1)),p(e("select",{"onUpdate:modelValue":t[11]||(t[11]=a=>u.value.gender=a),class:"form-select",required:""},[(r(!0),o(g,null,k(s.value.genders,a=>(r(),o("option",{key:a,value:a},n(a==="L"?"Laki-laki":"Perempuan"),9,We))),128))],512),[[h,u.value.gender]])]),e("div",Xe,[t[28]||(t[28]=e("label",{class:"form-label"},"Lokasi",-1)),p(e("select",{"onUpdate:modelValue":t[12]||(t[12]=a=>u.value.lokasi=a),class:"form-select"},[t[27]||(t[27]=e("option",{value:""},"Pilih Lokasi",-1)),(r(!0),o(g,null,k(s.value.locations,a=>(r(),o("option",{key:a,value:a},n(a),9,Ye))),128))],512),[[h,u.value.lokasi]])]),e("div",Ze,[e("button",{type:"button",class:"btn btn-secondary",onClick:K},t[29]||(t[29]=[e("i",{class:"fas fa-times me-1"},null,-1),m(" Cancel ")])),e("button",{type:"submit",class:x(["btn",(c.value,"btn-danger")])},[t[30]||(t[30]=e("i",{class:"fas fa-save me-1"},null,-1)),m(" "+n(c.value?"Simpan":"Update"),1)],2)])],32)])])])])):j("",!0),C.value?(r(),o("div",et,[e("div",tt,[e("div",at,[e("div",{class:"modal-header bg-danger text-white"},[t[31]||(t[31]=e("h5",{class:"modal-title"},"Konfirmasi Hapus",-1)),e("button",{type:"button",class:"btn-close btn-close-white",onClick:q})]),e("div",lt,[t[34]||(t[34]=e("p",null,"Apakah Anda yakin ingin menghapus karyawan ini?",-1)),e("p",null,[t[32]||(t[32]=e("strong",null,"NIK:",-1)),m(" "+n(y.value.username),1)]),e("p",null,[t[33]||(t[33]=e("strong",null,"Nama:",-1)),m(" "+n(y.value.name),1)]),t[35]||(t[35]=e("p",{class:"text-danger"},"Data yang dihapus tidak dapat dikembalikan!",-1))]),e("div",{class:"modal-footer border-top-0"},[e("button",{type:"button",class:"btn btn-secondary",onClick:q},t[36]||(t[36]=[e("i",{class:"fas fa-times me-1"},null,-1),m(" Batal ")])),e("button",{type:"button",class:"btn btn-danger",onClick:Q},t[37]||(t[37]=[e("i",{class:"fas fa-trash-alt me-1"},null,-1),m(" Hapus ")]))])])])])):j("",!0)]))}},rt=Y(st,[["__scopeId","data-v-6c265a61"]]);export{rt as default};
