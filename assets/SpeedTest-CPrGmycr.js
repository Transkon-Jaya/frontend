import{_,u as T,n as S,r as f,o as A,c as d,a as t,t as l,q as v,F as w,j as x,h as b,p as I,A as C,g as u,z as g,d as j,i as D,b as E,v as M,E as y,s as W}from"./index-CFZ6i4hX.js";const F={class:"p-4"},B={key:0,class:"alert alert-danger text-center py-4 mb-3"},O={key:1,class:"text-center py-4"},G={key:2,class:"leaderboard-wrapper"},P={class:"leaderboard-table"},R={class:"px-2 py-1 border border-gray-300"},z={class:"px-2 py-1 border border-gray-300"},U={class:"px-2 py-1 border border-gray-300"},N={key:0,class:"mt-4 text-sm text-gray-700 bg-blue-50 p-2 rounded"},q={key:1,class:"mt-4 text-sm text-gray-700 bg-green-50 p-2 rounded"},V={key:2,class:"mt-4 text-sm text-gray-700 bg-gray-100 p-2 rounded"},H={__name:"Leaderboard",setup(r){const e=T(),o=S(()=>e.username||""),c=f([]),s=f(null),i=f(!1),m=f(null),n=S(()=>o.value&&c.value.some(p=>p.username===o.value)),h=async()=>{i.value=!0,m.value=null;try{const p=await I.get(`${C}/score`,{params:{limit:10},headers:{Authorization:`Bearer ${e.token}`}});if(p.data.status===200&&Array.isArray(p.data.data)){c.value=p.data.data;const a=c.value.find(k=>k.username===o.value);a?s.value={rank:a.rank,wpm:a.wpm}:s.value=null}else throw new Error("Format respons tidak valid")}catch(p){if(p.response){const a=p.response.status;switch(a){case 401:m.value="Harap login untuk melihat leaderboard.";break;case 403:m.value="Akses ditolak.";break;case 404:m.value="Leaderboard endpoint tidak ditemukan.";break;case 500:m.value="Server mengalami kesalahan internal.";break;default:m.value=`Gagal memuat leaderboard (${a}).`}}else p.request?m.value="Tidak dapat terhubung ke server. Periksa koneksi internet.":m.value="Terjadi kesalahan saat memproses permintaan.";c.value=[]}finally{i.value=!1}};return A(()=>{h()}),(p,a)=>(u(),d("div",F,[a[7]||(a[7]=t("h2",{class:"text-xl font-bold mb-2"},"🏆 Leaderboard (Top 10)",-1)),m.value?(u(),d("div",B,l(m.value),1)):i.value?(u(),d("div",O,a[0]||(a[0]=[t("div",{class:"spinner-border text-primary",role:"status"},null,-1),t("p",{class:"mt-2"},"Memuat leaderboard...",-1)]))):(u(),d("div",G,[t("table",P,[a[1]||(a[1]=t("thead",{class:"bg-gray-200"},[t("tr",null,[t("th",{class:"px-2 py-1 text-left border border-gray-300"},"Rank"),t("th",{class:"px-2 py-1 text-left border border-gray-300"},"Name"),t("th",{class:"px-2 py-1 text-left border border-gray-300"},"WPM")])],-1)),t("tbody",null,[(u(!0),d(w,null,x(c.value,(k,K)=>(u(),d("tr",{key:K,class:g({"bg-yellow-100":k.username===o.value})},[t("td",R,l(k.rank),1),t("td",z,l(k.name||k.username),1),t("td",U,l(k.wpm),1)],2))),128))])]),s.value&&!n.value?(u(),d("div",N,[a[2]||(a[2]=b(" Kamu berada di peringkat ")),t("strong",null,"#"+l(s.value.rank),1),a[3]||(a[3]=b(" dengan skor ")),t("strong",null,l(s.value.wpm)+" WPM",1),a[4]||(a[4]=b(". "))])):s.value&&n.value?(u(),d("div",q,[a[5]||(a[5]=b(" Kamu berada di peringkat ")),t("strong",null,"#"+l(s.value.rank),1),a[6]||(a[6]=b(". "))])):o.value&&!s.value?(u(),d("div",V," Kamu belum memiliki skor. Mainkan game untuk masuk leaderboard! ")):v("",!0)]))]))}},Y=_(H,[["__scopeId","data-v-faafaf45"]]),J=["the","be","to","of","and","a","in","that","have","I","it","for","not","on","with","he","as","you","do","at","this","but","his","by","from","they","we","say","her","she","or","an","will","my","one","all","would","there","their","what","so","up","out","if","about","who","get","which","go","me","when","make","can","like","time","no","just","him","know","take","people","into","year","your","good","some","could","them","see","other","than","then","now","look","only","come","its","over","think","also","back","after","use","two","how","our","work","first","well","way","even","new","want","because","any","these","give","day","most","us","is","are","was","were","has","had","been","being","have","has","do","does","did","will","would","shall","should","may","might","must","can","could","am","quick","brown","fox","jumps","over","lazy","dog","hello","world","computer","keyboard","screen","mouse","internet","website","application","software","development","programming","javascript","python","java","html","css","database","server","client","artificial","intelligence","machine","learning","data","science","algorithm","function","variable","loop","condition","array","object","string","number","boolean","null","undefined","true","false","framework","library","tool","debug","test","deploy","build","compile","run","execute","performance","optimization","security","privacy","encryption","authentication","authorization","api","json","xml","responsive","design","mobile","desktop","web","app","native","hybrid","cross-platform"],Q=["saya","kamu","dia","mereka","kita","aku","anda","beliau","seseorang","siapa","apa","di","ke","dari","dan","atau","tetapi","sedangkan","sementara","karena","oleh","untuk","dengan","tanpa","tentang","antara","melalui","selama","sampai","sejak","adalah","ialah","merupakan","yaitu","berarti","maksudnya","sebagai","seperti","bagai","laksana","akan","akan","telah","sudah","belum","masih","pernah","tidak","bukan","jangan","harus","wajib","perlu","butuh","perlukan","mesti","sebaiknya","seharusnya","semestinya","hendaknya","bisa","dapat","mampu","boleh","mau","ingin","suka","senang","gembira","bahagia","sedih","marah","kesal","bosan","lelah","capek","lapar","haus","dingin","panas","besar","kecil","tinggi","rendah","lebar","sempit","panjang","pendek","tebal","tipis","baru","lama","cepat","lambat","mahal","murah","bagus","jelek","cantik","ganteng","rumah","mobil","motor","sepeda","komputer","telepon","televisi","radio","kulkas","mesin","buku","surat","koran","majalah","pena","tinta","kertas","meja","kursi","tempat","makan","minum","tidur","bangun","berjalan","berlari","bermain","bekerja","belajar","mengajar","menulis","membaca","mendengar","melihat","merasa","berpikir","berbicara","berbisik","berteriak","bernyanyi","air","api","bumi","angin","cahaya","gelap","siang","malam","pagi","sore","hari","minggu","bulan","tahun","musim","panas","dingin","hujan","salju","angin","pohon","bunga","rumput","batu","gunung","sungai","laut","pantai","pulau","negara","kota","desa","jalan","jembatan","stasiun","bandara","pelabuhan","toko","pasar","restoran","sekolah","universitas","perpustakaan","rumah sakit","apotek","bank","kantor","pabrik","pertanian","perkebunan","industri","teknologi","informasi","komunikasi","transportasi","pendidikan","kesehatan","pertahanan","keamanan","ekonomi"],L=["pneumonoultramicroscopicsilicovolcanoconiosiss","antidisestablishmentarianism","floccinaucinihilipilification","supercalifragilisticexpialidocious","pseudopseudohypoparathyroidism","thyroparathyroidectomized","aequeosalinocalcalinoceraceoaluminosocupreovitriolic","incomprehensibilities","honorificabilitudinitatibus","keragaman","ketidakpastian","mempersoalkan","ketidakberdayaan","keterwakilan","keberadaan","ketidakhadiran","kemungkinan","ketidakmungkinan","keterbatasan","kemampuan","keterampilan","pengembangan","pemrograman","implementasi","konfigurasi","autentikasi","otorisasi","enkripsi","dekomposisi","transformasi","rekursif","paradigma","metodologi","asynchronous","synchronous","concurrent","parallel","distributed","scalability","resilience","robustness","maintainability","extensibility","interoperability","usability"],X={name:"TypingTest",components:{Leaderboard:Y},data(){return{gameStarted:!1,gameActive:!1,gameFinished:!1,timeLeft:60,timer:null,words:[],displayedWords:[],maxDisplayedWords:15,displayOffset:0,userInput:"",currentWordIndex:0,currentCharIndex:0,currentWordCorrect:[],wordStatus:[],correctWords:0,incorrectWords:0,totalKeystrokes:0,correctKeystrokes:0,selectedLanguage:"",selectedDifficulty:"medium",baseWordPool:[],leaderboardLoading:!1,leaderboardError:null}},setup(){return{userStore:T()}},computed:{wpm(){if(60-this.timeLeft===0)return 0;const r=(60-this.timeLeft)/60;return Math.round(this.correctKeystrokes/5/r)||0},accuracy(){return this.totalKeystrokes===0?100:Math.round(this.correctKeystrokes/this.totalKeystrokes*100)},currentUser(){return this.userStore.username||""}},methods:{focusInput(){this.$refs.inputField.focus()},startGame(){this.selectedLanguage&&(this.gameStarted=!0,this.gameActive=!0,this.gameFinished=!1,this.timeLeft=60,this.baseWordPool=this.getWordPool(),this.words=this.generateRandomWords(200),this.resetGameState(),this.$nextTick(()=>{this.$refs.inputField.focus()}),this.timer=setInterval(()=>{this.timeLeft--,this.timeLeft<=0&&this.finishGame()},1e3))},getWordPool(){let r=[];return(this.selectedLanguage==="english"||this.selectedLanguage==="mixed")&&(r=r.concat(J)),(this.selectedLanguage==="indonesian"||this.selectedLanguage==="mixed")&&(r=r.concat(Q)),r},generateRandomWords(r){let e=[...this.baseWordPool];this.selectedDifficulty==="hard"?e=e.concat(L):this.selectedDifficulty==="easy"&&(e=e.filter(c=>!L.includes(c)));const o=[];for(let c=0;c<r;c++){const s=Math.floor(Math.random()*e.length);o.push(e[s])}return o},resetGameState(){this.displayedWords=this.words.slice(0,this.maxDisplayedWords),this.userInput="",this.currentWordIndex=0,this.currentCharIndex=0,this.currentWordCorrect=Array(50).fill(!0),this.wordStatus=Array(this.words.length).fill(""),this.correctWords=0,this.incorrectWords=0,this.totalKeystrokes=0,this.correctKeystrokes=0},updateDisplayedWords(){const r=Math.max(0,this.currentWordIndex-this.displayOffset),e=Math.min(this.words.length,r+this.maxDisplayedWords);this.displayedWords=this.words.slice(r,e)},checkInput(){if(!this.gameActive||this.gameFinished)return;this.totalKeystrokes++;const r=this.words[this.currentWordIndex];this.currentWordCorrect.length<=this.userInput.length&&(this.currentWordCorrect=this.currentWordCorrect.concat(Array(20).fill(!0)));const e=this.userInput.slice(-1),o=this.userInput.length-1;e===r[o]?(this.currentWordCorrect[o]=!0,this.correctKeystrokes++):this.currentWordCorrect[o]=!1,this.currentCharIndex=this.userInput.length,this.scrollToCurrentWord()},handleWordEnd(){if(!this.gameActive||this.gameFinished)return;const r=this.words[this.currentWordIndex];this.userInput.trim()===r?(this.wordStatus[this.currentWordIndex]="correct",this.correctWords++):(this.wordStatus[this.currentWordIndex]="incorrect",this.incorrectWords++),this.moveToNextWord()},moveToNextWord(){this.userInput="",this.currentWordIndex++,this.currentCharIndex=0,this.currentWordCorrect=Array(50).fill(!0),this.updateDisplayedWords(),this.scrollToCurrentWord()},handleBackspace(r){if(!(!this.gameActive||this.gameFinished)&&this.userInput.length===0&&this.currentWordIndex>0){r.preventDefault(),this.currentWordIndex--,this.userInput=this.words[this.currentWordIndex],this.currentCharIndex=this.userInput.length,this.wordStatus[this.currentWordIndex]="",this.currentWordCorrect=Array(50).fill(!0);for(let e=0;e<this.userInput.length;e++)this.totalKeystrokes++,this.userInput[e]===this.words[this.currentWordIndex][e]?(this.currentWordCorrect[e]=!0,this.correctKeystrokes++):this.currentWordCorrect[e]=!1;this.updateDisplayedWords(),this.scrollToCurrentWord()}},scrollToCurrentWord(){this.$nextTick(()=>{const r=this.$refs.textDisplay,e=r==null?void 0:r.querySelector(".word.current");if(r&&e){const o=r.getBoundingClientRect(),c=e.getBoundingClientRect(),i=r.scrollTop+(c.top-o.top)-o.height/2+c.height/2;r.scrollTo({top:i,behavior:"smooth"})}})},async finishGame(){clearInterval(this.timer),this.gameActive=!1,this.gameFinished=!0;try{await this.sendScoreToServer(this.wpm),await this.refreshLeaderboard()}catch(r){console.error("Error finishing game:",r)}},async sendScoreToServer(r){try{const e=this.userStore.token||localStorage.getItem("token");if(!e){console.warn("User not logged in, score not saved");return}const o=await I.post(`${C}/score`,{wpm:r},{headers:{Authorization:`Bearer ${e}`}});return console.log("Score saved:",o.data),o.data}catch(e){throw console.error("Failed to save score:",e),e}},async refreshLeaderboard(){try{this.leaderboardLoading=!0,this.leaderboardError=null,this.$refs.leaderboard&&await this.$refs.leaderboard.fetchLeaderboard()}catch(r){console.error("Error refreshing leaderboard:",r),this.leaderboardError="Gagal memuat leaderboard terbaru"}finally{this.leaderboardLoading=!1}},async fetchLeaderboardData(){try{const r=this.userStore.token;return r?(await I.get(`${C}/scores`,{headers:{Authorization:`Bearer ${r}`}})).data.data||[]:[]}catch(r){return console.error("Failed to fetch leaderboard:",r),[]}},restartGame(){this.selectedLanguage="",this.selectedDifficulty="medium",this.gameStarted=!1,this.gameFinished=!1},formatTime(r){const e=Math.floor(r/60),o=r%60;return`${e}:${o<10?"0":""}${o}`}}},Z={class:"container"},$={key:0,class:"start-screen"},ee={class:"leaderboard-container"},te={class:"language-selector"},se={class:"lang-buttons"},re={class:"difficulty-selector"},ae={class:"diff-buttons"},ne=["disabled"],ie={key:1,class:"game-screen"},oe={class:"header"},le={class:"timer"},de={class:"time"},ue={class:"stats"},ce={class:"stat keystrokes"},he={class:"value"},me={class:"stat"},pe={class:"value"},ge={class:"stat"},ke={class:"value"},be={class:"text-display",ref:"textDisplay"},fe=["disabled"],ye={key:2,class:"results-screen"},ve={class:"result-cards"},We={class:"card"},we={class:"card-value"},xe={class:"card"},Ie={class:"card-value"},Ce={class:"card"},Se={class:"card-value"},Le={class:"card"},_e={class:"card-value"},Te={class:"final-stats"};function Ke(r,e,o,c,s,i){const m=D("Leaderboard");return u(),d("div",{class:g(["typing-test",{"game-active":s.gameActive}])},[t("div",Z,[s.gameStarted?v("",!0):(u(),d("div",$,[e[16]||(e[16]=t("h1",null,"Typing Speed Test",-1)),e[17]||(e[17]=t("p",null,"Uji kecepatan mengetikmu dalam 1 menit",-1)),t("div",ee,[j(m)]),t("div",te,[e[14]||(e[14]=t("label",null,"Pilih Bahasa:",-1)),t("div",se,[t("button",{onClick:e[0]||(e[0]=n=>s.selectedLanguage="english"),class:g([{active:s.selectedLanguage==="english"},"lang-btn"])}," English ",2),t("button",{onClick:e[1]||(e[1]=n=>s.selectedLanguage="indonesian"),class:g([{active:s.selectedLanguage==="indonesian"},"lang-btn"])}," Indonesian ",2),t("button",{onClick:e[2]||(e[2]=n=>s.selectedLanguage="mixed"),class:g([{active:s.selectedLanguage==="mixed"},"lang-btn"])}," Mixed ",2)])]),t("div",re,[e[15]||(e[15]=t("label",null,"Tingkat Kesulitan:",-1)),t("div",ae,[t("button",{onClick:e[3]||(e[3]=n=>s.selectedDifficulty="easy"),class:g([{active:s.selectedDifficulty==="easy"},"diff-btn"])}," Mudah ",2),t("button",{onClick:e[4]||(e[4]=n=>s.selectedDifficulty="medium"),class:g([{active:s.selectedDifficulty==="medium"},"diff-btn"])}," Sedang ",2),t("button",{onClick:e[5]||(e[5]=n=>s.selectedDifficulty="hard"),class:g([{active:s.selectedDifficulty==="hard"},"diff-btn"])}," Sulit ",2)])]),t("button",{onClick:e[6]||(e[6]=(...n)=>i.startGame&&i.startGame(...n)),class:"start-btn",disabled:!s.selectedLanguage},"Start Test",8,ne)])),s.gameStarted&&!s.gameFinished?(u(),d("div",ie,[t("div",oe,[t("div",le,[t("span",de,l(i.formatTime(s.timeLeft)),1),e[18]||(e[18]=t("span",{class:"label"},"TIME LEFT",-1))]),t("div",ue,[t("div",ce,[t("span",he,l(s.totalKeystrokes),1),e[19]||(e[19]=t("span",{class:"label"},"KEYSTROKES",-1))]),t("div",me,[t("span",pe,l(i.wpm),1),e[20]||(e[20]=t("span",{class:"label"},"WPM",-1))]),t("div",ge,[t("span",ke,l(i.accuracy)+"%",1),e[21]||(e[21]=t("span",{class:"label"},"ACCURACY",-1))])])]),t("div",be,[(u(!0),d(w,null,x(s.displayedWords,(n,h)=>(u(),d("div",{key:h,class:g(["word",{current:h===s.currentWordIndex-(s.currentWordIndex-s.displayOffset),current:h===s.displayOffset,next:h===s.displayOffset+1,correct:h<s.displayOffset&&s.wordStatus[s.currentWordIndex-s.displayOffset+h]==="correct",incorrect:h<s.displayOffset&&s.wordStatus[s.currentWordIndex-s.displayOffset+h]==="incorrect"}])},[(u(!0),d(w,null,x(n,(p,a)=>(u(),d("span",{key:a,class:g({"current-char":h===s.displayOffset&&a===s.currentCharIndex,"correct-char":h===s.displayOffset&&a<s.currentCharIndex&&s.currentWordCorrect[a],"incorrect-char":h===s.displayOffset&&a<s.currentCharIndex&&!s.currentWordCorrect[a]})},l(p),3))),128))],2))),128))],512),E(t("input",{ref:"inputField","onUpdate:modelValue":e[7]||(e[7]=n=>s.userInput=n),onInput:e[8]||(e[8]=(...n)=>i.checkInput&&i.checkInput(...n)),onKeydown:[e[9]||(e[9]=y(W((...n)=>i.handleWordEnd&&i.handleWordEnd(...n),["prevent"]),["space"])),e[10]||(e[10]=y(W((...n)=>i.handleWordEnd&&i.handleWordEnd(...n),["prevent"]),["enter"])),e[11]||(e[11]=y((...n)=>i.handleBackspace&&i.handleBackspace(...n),["backspace"])),e[12]||(e[12]=y(W((...n)=>i.focusInput&&i.focusInput(...n),["prevent"]),["tab"]))],class:"input-field",placeholder:"Mulai mengetik...",type:"text",disabled:!s.gameActive},null,40,fe),[[M,s.userInput]]),e[22]||(e[22]=t("div",{class:"instructions"},[t("p",null,"Spasi / Enter : Selesai mengetik kata | Backspace : Hapus karakter/kata sebelumnya")],-1))])):v("",!0),s.gameFinished?(u(),d("div",ye,[e[27]||(e[27]=t("h1",null,"Hasil Kamu",-1)),t("div",ve,[t("div",We,[t("div",we,l(i.wpm),1),e[23]||(e[23]=t("div",{class:"card-label"},"Words Per Minute",-1))]),t("div",xe,[t("div",Ie,l(i.accuracy)+"%",1),e[24]||(e[24]=t("div",{class:"card-label"},"Akurasi",-1))]),t("div",Ce,[t("div",Se,l(s.correctWords),1),e[25]||(e[25]=t("div",{class:"card-label"},"Kata Benar",-1))]),t("div",Le,[t("div",_e,l(s.incorrectWords),1),e[26]||(e[26]=t("div",{class:"card-label"},"Kesalahan",-1))])]),t("div",Te,[t("p",null,"Total Keystrokes: "+l(s.totalKeystrokes),1),t("p",null,"Keystrokes Benar: "+l(s.correctKeystrokes),1)]),t("button",{onClick:e[13]||(e[13]=(...n)=>i.restartGame&&i.restartGame(...n)),class:"restart-btn"},"Coba Lagi")])):v("",!0)])],2)}const je=_(X,[["render",Ke],["__scopeId","data-v-4daf7283"]]);export{je as default};
