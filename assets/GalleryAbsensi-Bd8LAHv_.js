import{_ as G,r as l,l as K,o as $,H as O,c as i,a,d as h,C as I,b as z,v as H,f as P,V as q,t as d,F as J,j as Q,s as f,A as y,x as W,g as c,h as X}from"./index-CCav3FzQ.js";import{s as T}from"./vue-multiselect-ryD8xG8K.js";/* empty css                            *//* empty css                                                 */import{M as Y}from"./bootstrap.esm-B0YAJBZY.js";const Z={class:"container-global"},ee={class:"d-flex align-items-end gap-3 flex-wrap"},ae={class:"col-md-4"},te={class:"col-md-4"},se={class:"filter-box flex-grow-1"},le={class:"border rounded p-2 bg-white"},oe={class:"filter-box"},ne={class:"container my-4"},re={key:0,class:"text-center my-5"},de={key:1,class:"alert alert-danger"},ie={key:2,class:"row"},ce={class:"card h-100"},ue=["src","onClick"],me={class:"card-body"},pe={class:"card-title"},ve={class:"card-text text-muted small"},be={class:"modal-dialog modal-dialog-centered modal-lg"},ge={class:"modal-content bg-dark text-white"},_e={class:"modal-header border-0"},he={class:"modal-title",id:"imageModalLabel"},fe={class:"modal-body text-center"},ye=["src"],we={class:"modal-footer justify-content-between border-0"},ke=["disabled"],xe=["disabled"],De={__name:"GalleryAbsensi",setup(Ce){const r=l([]),o=l(0),p=l(null),m=l(!0),v=l(null);l("");let n=null;const b=l(null),w=l(null),k=l([]),x=l([]),B=l({api:{params:[]}}),R=l({api:{params:[]}}),j=l(null),F=l(null),D=s=>{if(!s)return"";const e={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(s).toLocaleDateString("id-ID",e)},C=s=>s?`https://www.transkon-rent.com/uploads/absensi/${s}`:"",g=K(()=>r.value[o.value]||{}),U=async()=>{try{m.value=!0;const e=(await f.get(y+"/data/absensi_all",{params:{params:["","",""]}})).data;if(Array.isArray(e))r.value=e.filter(t=>t.foto_in);else throw new Error("Format data tidak valid")}catch(s){console.error("Error fetching data:",s),v.value=s.message,r.value=[{foto_in:"Tj1023_IN_1746431330.jpg",nama_karyawan:"Contoh Karyawan 1",tanggal:"2023-11-15T08:00:00"},{foto_in:"Tj1023_IN_1746507175.jpg",nama_karyawan:"Contoh Karyawan 2",tanggal:"2023-11-15T08:05:00"}]}finally{m.value=!1}},N=s=>{o.value=s,n==null||n.show()},E=()=>{n==null||n.hide()},A=()=>{o.value<r.value.length-1&&o.value++},V=()=>{o.value>0&&o.value--},M=s=>{var e;if(!(!n||!((e=document.getElementById("imageModal"))!=null&&e.classList.contains("show"))))switch(s.key){case"ArrowRight":A();break;case"ArrowLeft":V();break;case"Escape":E();break}},S=async()=>{try{const s=await f.get(`${y}/dropdowns/department`);k.value=s.data.map(t=>({label:t,value:t}));const e=await f.get(`${y}/dropdowns/name`);x.value=e.data.map(t=>({label:t,value:t}))}catch(s){console.error("Error fetching dropdowns:",s)}},L=async(s,e)=>{var u,_;let t=0;b.value=e,t=3,B.value.api.params[t]=e.value,R.value.api.params[t]=e.value,await((u=j.value)==null?void 0:u.renderChart()),await((_=F.value)==null?void 0:_.renderChart()),await W()};return $(async()=>{p.value&&(n=new Y(p.value)),await U(),await S(),m.value=!1,document.addEventListener("keydown",M)}),O(()=>{document.removeEventListener("keydown",M)}),(s,e)=>(c(),i("div",Z,[a("div",ee,[a("div",ae,[e[5]||(e[5]=a("label",{class:"form-label"},"Department",-1)),h(I(T),{modelValue:b.value,"onUpdate:modelValue":[e[0]||(e[0]=t=>b.value=t),e[1]||(e[1]=t=>L("dep",t))],options:k.value||[],placeholder:"Select...",label:"label","track-by":"value",class:"multiselect no-border"},null,8,["modelValue","options"])]),a("div",te,[e[6]||(e[6]=a("label",{class:"form-label"},"Employee",-1)),h(I(T),{modelValue:w.value,"onUpdate:modelValue":[e[2]||(e[2]=t=>w.value=t),e[3]||(e[3]=t=>L("dep",t))],options:x.value||[],placeholder:"Select...",label:"label","track-by":"value",class:"multiselect no-border"},null,8,["modelValue","options"])]),a("div",se,[e[7]||(e[7]=a("label",{class:"form-label small mb-1 text-muted"},"Date",-1)),a("div",le,[z(a("input",{type:"date",class:"form-control border-0 p-0","onUpdate:modelValue":e[4]||(e[4]=t=>s.selectedDate=t)},null,512),[[H,s.selectedDate]])])]),a("div",oe,[h(q,{type:"button",color:"danger",size:"md",onClick:s.resetFilters,class:"h-100"},{default:P(()=>e[8]||(e[8]=[a("i",{class:"bi bi-arrow-counterclockwise me-2"},null,-1),X(" Reset ")])),_:1},8,["onClick"])])]),a("div",ne,[m.value?(c(),i("div",re,e[9]||(e[9]=[a("div",{class:"spinner-border text-primary",role:"status"},[a("span",{class:"visually-hidden"},"Loading...")],-1),a("p",{class:"mt-2"},"Memuat data absensi...",-1)]))):v.value?(c(),i("div",de," Gagal memuat data: "+d(v.value),1)):(c(),i("div",ie,[(c(!0),i(J,null,Q(r.value,(t,u)=>(c(),i("div",{class:"col-md-3 mb-4",key:u},[a("div",ce,[a("img",{src:C(t.foto_in),class:"card-img-top gallery-img",onClick:_=>N(u),alt:"Foto Absensi"},null,8,ue),a("div",me,[a("h6",pe,d(t.name),1),a("p",ve,d(D(t.hour_in)),1)])])]))),128))])),a("div",{class:"modal fade",id:"imageModal",tabindex:"-1","data-bs-backdrop":"false","aria-labelledby":"imageModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:p},[a("div",be,[a("div",ge,[a("div",_e,[a("h5",he,d(g.value.name||"Karyawan")+" - "+d(D(g.value.hour_in)),1),a("button",{type:"button",class:"btn-close btn-close-white",onClick:E,"aria-label":"Close","data-bs-dismiss":"modal"})]),a("div",fe,[a("img",{src:C(g.value.foto_in),class:"img-fluid rounded portrait-img fixed-modal-image",alt:"Foto Absensi",ref:"modalImage"},null,8,ye)]),a("div",we,[a("button",{type:"button",class:"btn btn-outline-light",onClick:V,disabled:o.value===0}," « Sebelumnya ",8,ke),a("span",null," Gambar "+d(o.value+1)+" dari "+d(r.value.length),1),a("button",{type:"button",class:"btn btn-outline-light",onClick:A,disabled:o.value===r.value.length-1}," Berikutnya » ",8,xe)])])])],512)])]))}},Ie=G(De,[["__scopeId","data-v-f2b122e8"]]);export{Ie as default};
