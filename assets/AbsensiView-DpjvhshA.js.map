{"version":3,"file":"AbsensiView-DpjvhshA.js","sources":["../../src/components/ImageModal.vue","../../src/views/absensi/AbsensiView.vue"],"sourcesContent":["<template>\r\n    <div\r\n      v-if=\"showModal\"\r\n      class=\"modal fade show\"\r\n      tabindex=\"-1\"\r\n      role=\"dialog\"\r\n      aria-labelledby=\"imageModalLabel\"\r\n      style=\"display: block;\"\r\n      aria-hidden=\"false\"\r\n      @click.self=\"closeModal\"\r\n    >\r\n      <div class=\"modal-dialog modal-dialog-centered\" role=\"document\">\r\n        <div class=\"modal-content\" @click.stop>\r\n          <div class=\"modal-header\">\r\n            <h5 class=\"modal-title\" id=\"imageModalLabel\">{{ imageTitle }}</h5>\r\n            <button type=\"button\" class=\"close\" @click=\"closeModal\" aria-label=\"Close\">\r\n              <span aria-hidden=\"true\">&times;</span>\r\n            </button>\r\n          </div>\r\n          <div class=\"modal-body\">\r\n            <img :src=\"imageSrc\" alt=\"Image Preview\" class=\"img-fluid\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </template>\r\n  \r\n  <script>\r\n  export default {\r\n    props: {\r\n      imageSrc: {\r\n        type: String,\r\n        required: true\r\n      },\r\n      imageTitle: {\r\n        type: String,\r\n        default: 'Image Preview'\r\n      },\r\n      showModal: {\r\n        type: Boolean,\r\n        default: false\r\n      }\r\n    },\r\n    methods: {\r\n      closeModal() {\r\n        this.$emit('close');\r\n      },\r\n      handleKeydown(e) {\r\n        if (e.key === 'Escape') {\r\n          this.closeModal();\r\n        }\r\n      }\r\n    },\r\n    mounted() {\r\n      window.addEventListener('keydown', this.handleKeydown);\r\n    },\r\n    beforeUnmount() {\r\n      window.removeEventListener('keydown', this.handleKeydown);\r\n    }\r\n  };\r\n  </script>\r\n  \r\n  <style scoped>\r\n  .modal {\r\n    display: block;\r\n    z-index: 1050;\r\n    background-color: rgba(0, 0, 0, 0.5);\r\n    position: fixed;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n  }\r\n  \r\n  .modal-dialog {\r\n    max-width: 90%;\r\n    width: auto;\r\n  }\r\n  \r\n  .modal-body {\r\n    padding: 0;\r\n    text-align: center;\r\n  }\r\n  \r\n  img {\r\n    max-width: 100%;\r\n    max-height: 70vh;\r\n  }\r\n  </style>\r\n  ","<script setup>\r\nimport { onMounted, ref, computed } from \"vue\";\r\nimport ImageModal from '@/components/ImageModal.vue';\r\nimport axios from \"axios\";\r\nimport { useUserStore } from \"@/stores/user\";\r\nimport { log } from \"@/utils/logger\";\r\n\r\nconst userData = useUserStore();\r\n\r\nconst fileInput = ref(null);\r\nconst default_str = [\"Mengambil Data...\", \"Izin Ditolak\", \"Gagal Memuat\"];\r\nconst ipData = ref({ ipv4: default_str[0], ipv6: default_str[0] });\r\nconst gpsLocation = ref({ lat: default_str[0], lon: default_str[0] });\r\nconst ipLocation = ref({ city: default_str[0], country: default_str[0], lat: \"\", lon: \"\" });\r\nconst gpsMapUrl = ref(\"\");\r\nconst ipMapUrl = ref(\"\");\r\nconst attendanceRecorded = ref(false);\r\nconst selectedLocation = ref(\"\");\r\nconst locations = ref([]);\r\nconst absensiStatusArray = ref([]);\r\nconst isLoadingAbsensiStatus = ref(true);\r\nconst showModal = ref(false);\r\nconst imageSrc = ref('');\r\nconst ZOOM_LEVEL = 12;\r\n\r\nconst dataLoaded = computed(() => {\r\n  return ![\r\n    gpsLocation.value.lat,\r\n    gpsLocation.value.lon,\r\n    ipData.value.ipv4\r\n  ].some(val => default_str.includes(val));\r\n});\r\n\r\nconst tooFar = computed(() => {\r\n  return (selectedLocation.value?.distance ?? 99999) > 1000;\r\n});\r\n\r\nconst absensiStatus = computed(() => {\r\n  const latest = absensiStatusArray.value[0];\r\n  if (!latest) return \"IN\";\r\n  const hourIn = latest.hour_in ? new Date(latest.hour_in) : null;\r\n  const now = new Date();\r\n  const timeDiffHours = hourIn ? (now - hourIn) / (1000 * 60 * 60) : null;\r\n  if (latest.hour_out && timeDiffHours >= 16 || timeDiffHours >= 16) {\r\n    return \"IN\";\r\n  }\r\n  if (!latest.hour_out || latest.hour_out === \"00:00:00\") {\r\n    return \"OUT\";\r\n  }\r\n  return \"DONE\";\r\n});\r\n\r\nconst fetchAbsensiStatus = async () => {\r\n  const responseStatus = await fetch(`${userData.apiBaseUrl}/absensi-status?username=${userData.username}`);\r\n  absensiStatusArray.value = await responseStatus.json();\r\n  if (absensiStatusArray.value.length > 0) {\r\n    absensiStatusArray.value[0].foto_in = `${userData.baseUrl}/uploads/absensi/${absensiStatusArray.value[0].foto_in}`;\r\n    absensiStatusArray.value[0].foto_out = `${userData.baseUrl}/uploads/absensi/${absensiStatusArray.value[0].foto_out}`;\r\n  }\r\n  isLoadingAbsensiStatus.value = false;\r\n};\r\n\r\nconst fetchGPSLocation = () => {\r\n  return new Promise((resolve) => {\r\n    if (\"geolocation\" in navigator) {\r\n      try {\r\n        navigator.geolocation.getCurrentPosition(\r\n          (position) => {\r\n            gpsLocation.value.lat = position.coords.latitude.toFixed(6);\r\n            gpsLocation.value.lon = position.coords.longitude.toFixed(6);\r\n            gpsMapUrl.value = `https://static-maps.yandex.ru/1.x/?lang=en-US&ll=${gpsLocation.value.lon},${gpsLocation.value.lat}&size=450,300&z=${ZOOM_LEVEL}&l=map&pt=${gpsLocation.value.lon},${gpsLocation.value.lat},pm2rdm`;\r\n            resolve(true);\r\n          },\r\n          (error) => {\r\n            console.warn(\"❌ Geolocation permission denied or error:\", error.message);\r\n            gpsLocation.value.lat = default_str[1];\r\n            gpsLocation.value.lon = default_str[1];\r\n            resolve(false);\r\n          },\r\n          {\r\n            enableHighAccuracy: true,\r\n            timeout: 5000,\r\n            maximumAge: 0,\r\n          }\r\n        );\r\n      } catch (err) {\r\n        console.error(\"❌ Unexpected GPS error:\", err);\r\n        gpsLocation.value.lat = default_str[2];\r\n        gpsLocation.value.lon = default_str[2];\r\n        resolve(false);\r\n      }\r\n    } else {\r\n      gpsLocation.value.lat = default_str[2];\r\n      gpsLocation.value.lon = default_str[2];\r\n      resolve(false);\r\n    }\r\n  });\r\n};\r\n\r\nfunction getDistanceFromLatLonInKm(lat1, lon1, lat2, lon2) {\r\n  const R = 6371;\r\n  const dLat = (lat2 - lat1) * Math.PI / 180;\r\n  const dLon = (lon2 - lon1) * Math.PI / 180;\r\n  const a =\r\n    Math.sin(dLat / 2) ** 2 +\r\n    Math.cos(lat1 * Math.PI / 180) *\r\n    Math.cos(lat2 * Math.PI / 180) *\r\n    Math.sin(dLon / 2) ** 2;\r\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n  const distance = R * c * 1000; // meter\r\n  return isNaN(distance) ? 0 : distance.toFixed(2);\r\n}\r\n\r\nconst fetchLokasi = async () => {\r\n  const responseLokasi = await axios.get(`${userData.apiBaseUrl}/hr-lokasi`);\r\n  locations.value = responseLokasi.data.map((item) => {\r\n    const lat = item.latitude ?? null;\r\n    const lon = item.longitude ?? null;\r\n    const distance = (lat !== null && lon !== null && gpsLocation.value.lat && gpsLocation.value.lon)\r\n      ? getDistanceFromLatLonInKm(gpsLocation.value.lat, gpsLocation.value.lon, lat, lon)\r\n      : Infinity;\r\n    return { nama: item.nama ?? \"\", lat, lon, distance };\r\n  });\r\n\r\n  locations.value.sort((a, b) => a.distance - b.distance);\r\n  if (locations.value.length > 0) {\r\n    selectedLocation.value = locations.value[0];\r\n  }\r\n};\r\n\r\nconst fetchIp = async () => {\r\n  try {\r\n    const responseIPv4 = await axios.get(\"https://www.transkon-rent.com/api/ip\");\r\n    ipData.value.ipv4 = responseIPv4.data.ip;\r\n    // console.log(responseIPv4.data);\r\n  } catch (error) {\r\n    console.error(\"Error fetching IP:\", error);\r\n    ipData.value.ipv4 = default_str[2];\r\n  }\r\n};\r\n\r\nconst fetchIPLocation = async () => {\r\n  try {\r\n    const response = await fetch(\"http://ip-api.com/json/\");\r\n    const data = await response.json();\r\n    ipLocation.value = {\r\n      city: data.city || \"Tidak diketahui\",\r\n      country: data.country || \"Tidak diketahui\",\r\n      lat: data.lat ? data.lat.toFixed(6) : \"\",\r\n      lon: data.lon ? data.lon.toFixed(6) : \"\",\r\n    };\r\n    if (data.lon && data.lat) {\r\n      ipMapUrl.value = `https://static-maps.yandex.ru/1.x/?lang=en-US&ll=${data.lon},${data.lat}&size=450,300&z=${ZOOM_LEVEL}&l=map&pt=${data.lon},${data.lat},pm2rdm`;\r\n    }\r\n  } catch (error) {\r\n    console.error(\"Error fetching IP geolocation:\", error);\r\n    ipLocation.value.city = \"Gagal memuat\";\r\n    ipLocation.value.country = \"Gagal memuat\";\r\n  }\r\n};\r\n\r\nconst openModal = (src) => {\r\n  imageSrc.value = src;\r\n  showModal.value = true;\r\n};\r\n\r\nconst closeModal = () => {\r\n  showModal.value = false;\r\n};\r\n\r\nconst openCamera = () => {\r\n  if (!selectedLocation.value) {\r\n    alert(\"Silakan pilih lokasi absen terlebih dahulu!\");\r\n    return;\r\n  }\r\n  document.getElementById(\"cameraInput\").click();\r\n};\r\n\r\nconst getDeviceInfo = () => {\r\n  const dimension = `${window.innerWidth}x${window.innerHeight}`;\r\n  const userAgent = navigator.userAgent;\r\n\r\n  const match = userAgent.match(/\\(([^)]+)\\)/);\r\n  let device = match ? match[1] : `?${userAgent}`;\r\n\r\n  // Cut if too long (safe for VARCHAR(255))\r\n  if (device.length > 250) {\r\n    device = device.substring(0, 250);\r\n  }\r\n\r\n  return {\r\n    dimension,\r\n    device\r\n  };\r\n};\r\n\r\n\r\nconst handlePhoto = async (event) => {\r\n  const file = event.target.files[0];\r\n  if (!file) return;\r\n  try {\r\n    const {dimension, device} = getDeviceInfo();\r\n    const formData = new FormData();\r\n    formData.append(\"foto\", file);\r\n    formData.append(\"id\", absensiStatus.value == \"IN\" ? null : absensiStatusArray.value[0].id);\r\n    formData.append(\"status\", absensiStatus.value);\r\n    formData.append(\"username\", userData.username);\r\n    formData.append(\"lokasi\", selectedLocation.value.nama);\r\n    formData.append(\"jarak\", selectedLocation.value.distance);\r\n    formData.append(\"long\", gpsLocation.value.lon);\r\n    formData.append(\"lang\", gpsLocation.value.lat);\r\n    formData.append(\"ip\", ipData.value.ipv4);\r\n    // log(\"Device Info : \", {dim: dimension, device: device});\r\n    formData.append(\"dim\", dimension);\r\n    formData.append(\"device\", device);\r\n\r\n    const response = await axios.post(\"https://www.transkon-rent.com/api/absensi\", formData, {\r\n      headers: {\r\n        \"Content-Type\": \"multipart/form-data\"\r\n      }\r\n    });\r\n\r\n    const result = response.data;\r\n    if (result.status === \"success\") {\r\n      attendanceRecorded.value = true;\r\n      window.location.reload();\r\n    } else {\r\n      console.error(\"Attendance failed:\", result.message);\r\n    }\r\n  } catch (err) {\r\n    console.error(\"Upload error:\", err);\r\n  }\r\n};\r\n\r\nonMounted(async () => {\r\n  try {\r\n    console.log(\"1. Meminta izin GPS...\");\r\n    const gpsSuccess = await fetchGPSLocation();\r\n    if (!gpsSuccess) {\r\n      console.warn(\"⚠️ Lokasi gagal dimuat. Melanjutkan tanpa GPS...\");\r\n    }\r\n    await Promise.all([\r\n      fetchLokasi(),\r\n      fetchIp(),\r\n      fetchAbsensiStatus()\r\n    ]);\r\n    console.log(\"✅ Semua data berhasil dimuat.\");\r\n  } catch (err) {\r\n    console.error(\"💥 Unhandled error in onMounted:\", err);\r\n  }\r\n});\r\nfunction formatDate(dateString) {\r\n  const months = [\r\n    \"Januari\", \"Februari\", \"Maret\", \"April\", \"Mei\", \"Juni\",\r\n    \"Juli\", \"Agustus\", \"September\", \"Oktober\", \"November\", \"Desember\"\r\n  ];\r\n\r\n  const date = new Date(dateString);\r\n  const day = date.getDate();\r\n  const month = months[date.getMonth()];\r\n  const year = date.getFullYear();\r\n  \r\n  const hours = String(date.getHours()).padStart(2, '0');\r\n  const minutes = String(date.getMinutes()).padStart(2, '0');\r\n  const seconds = String(date.getSeconds()).padStart(2, '0');\r\n\r\n  return `${day} ${month} ${year} ${hours}:${minutes}:${seconds}`;\r\n}\r\n\r\n</script>\r\n\r\n<template>\r\n  <div class=\"app-container\">\r\n    <!-- Main Content -->\r\n    <main class=\"main-content\">\r\n      <h1 class=\"app-title\">Absensi Karyawan</h1>\r\n      <p class=\"app-subtitle\"></p>\r\n      <!-- Attendance Form -->\r\n      <div class=\"container-global attendance-card\">\r\n        <div class=\"form-group\">\r\n          <!-- <label for=\"location\" class=\"form-label\">Lokasi Absensi</label>\r\n          <select v-model=\"selectedLocation\" id=\"location\" class=\"form-select\">\r\n            <option value=\"\" disabled selected>Loading...</option>\r\n            <option v-for=\"(location, index) in locations\" :key=\"index\" :value=\"location\">\r\n              {{ location.nama }}\r\n            </option>\r\n          </select> -->\r\n          <p v-if=\"locations.length > 0\" id=\"location\" class=\"form-control-plaintext\">\r\n            {{ locations[0].nama }}\r\n            <!-- {{ userData.baseUrl + absensiStatusArray[0].foto_in }} -->\r\n          </p>\r\n          <p v-else class=\"form-control-plaintext text-muted\">Loading location...</p>\r\n        </div>\r\n        <div class=\"mb-4\" v-if=\"absensiStatus === 'OUT' || absensiStatus === 'DONE'\">\r\n          <div>{{ formatDate(absensiStatusArray[0].hour_in) }}</div>\r\n          <VButton @click=\"openModal(absensiStatusArray[0].foto_in)\" class=\"btn btn-danger\">Photo In</VButton>\r\n          <ImageModal\r\n            :imageSrc=\"imageSrc\"\r\n            :showModal=\"showModal\"\r\n            @close=\"closeModal\"\r\n          />\r\n        </div>\r\n\r\n        <div class=\"mb-4\" v-if=\"absensiStatus === 'DONE'\">\r\n          <div>{{ formatDate(absensiStatusArray[0]?.hour_out) }}</div>\r\n          <VButton @click=\"openModal(absensiStatusArray[0].foto_out)\" class=\"btn btn-danger\">Photo Out</VButton>\r\n          <ImageModal\r\n            :imageSrc=\"imageSrc\"\r\n            :showModal=\"showModal\"\r\n            @close=\"closeModal\"\r\n          />\r\n        </div>\r\n        <!-- Attendance Button -->\r\n        <div class=\"action-group\">\r\n          <input type=\"file\" accept=\"image/*\" capture=\"environment\" @change=\"handlePhoto\" id=\"cameraInput\" style=\"display: none;\" />\r\n            <Button \r\n              @click=\"openCamera\"\r\n              class=\"primary-btn\" \r\n              :disabled=\"!selectedLocation || absensiStatus === 'DONE' || isLoadingAbsensiStatus || !dataLoaded || tooFar\"\r\n            >\r\n              <i class=\"fa-solid fa-camera\"></i>\r\n              <span v-if=\"isLoadingAbsensiStatus\">Loading...</span>\r\n              <span v-else-if=\"!dataLoaded\">Gagal Memuat</span>\r\n              <span v-else-if=\"tooFar\">Anda Diluar Zona Absensi</span>\r\n              <span v-else>{{ absensiStatus === 'DONE' ? 'Sudah Absen' : absensiStatus === 'OUT' ? 'Absen OUT' : 'Absen IN' }}</span>          \r\n            </Button>\r\n        </div>\r\n\r\n        <!-- Attendance Confirmation -->\r\n        <div v-if=\"attendanceRecorded\" class=\"confirmation-message\">\r\n          <i class=\"fa-solid fa-check-circle success-icon\"></i>\r\n          <span>Absensi berhasil direkam!</span>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Announcement Section -->\r\n      <div class=\"container-global announcement-card\">\r\n        <div class=\"announcement-header\">\r\n          <i class=\"fa-solid fa-bullhorn announcement-icon\"></i>\r\n          <h3>TRJA Memo</h3>\r\n        </div>\r\n        <div class=\"announcement-content\">\r\n          <img src=\"/src/assets/images/avatars/eid.jpg\" \r\n               alt=\"Gambar Lebaran\" \r\n               class=\"announcement-image\" />\r\n          <p class=\"announcement-text\">Selamat Hari Raya Idul Fitri 1445 H</p>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Location Information -->\r\n      <div class=\"container-global info-section-edit\">\r\n        <!-- GPS Info -->\r\n        <div class=\"info-card\">\r\n          <div class=\"info-header\">\r\n            <i class=\"fa-solid fa-map-marker-alt\"></i>\r\n            <h4>Lokasi GPS Anda</h4>\r\n          </div>\r\n          <div class=\"info-content\">\r\n            <div class=\"info-row\">\r\n              <span class=\"info-label\">Latitude:</span>\r\n              <span class=\"info-value\">{{ gpsLocation.lat }}</span>\r\n            </div>\r\n            <div class=\"info-row\">\r\n              <span class=\"info-label\">Longitude:</span>\r\n              <span class=\"info-value\">{{ gpsLocation.lon }}</span>\r\n            </div>\r\n            <div class=\"info-row\">\r\n              <span class=\"info-label\">Jarak:</span>\r\n              <span v-if=\"locations.length > 0\" class=\"info-value\">\r\n                {{ locations[0].distance + \" Meter\" }}\r\n              </span>\r\n              <span v-else class=\"info-value text-muted\">\r\n                Menghitung Jarak..\r\n              </span>\r\n            </div>\r\n            <div class=\"info-row\">\r\n              <span class=\"info-label\">IPv4:</span>\r\n              <span class=\"info-value\">{{ ipData.ipv4 }}</span>\r\n            </div>\r\n            <!-- <div class=\"info-row\">\r\n              <span class=\"info-label\">IPv6:</span>\r\n              <span class=\"info-value\">{{ ipData.ipv6 }}</span>\r\n            </div> -->\r\n            <img :src=\"gpsMapUrl\" alt=\"GPS Map\" v-if=\"gpsMapUrl\" class=\"map-image\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </main>\r\n  </div>\r\n</template>\r\n\r\n\r\n<style>\r\n/* Import Font Awesome CSS */\r\n@import url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css');\r\n\r\n\r\n\r\nbody {\r\n            margin: 0;\r\n            padding: 0;\r\n            display: flex;\r\n            justify-content: center;\r\n            align-items: center;\r\n            min-height: 100vh;\r\n            font-family: Arial, sans-serif;\r\n        }\r\n        \r\n        .main-content {\r\n            text-align: center;\r\n        }\r\n        \r\n        .app-title {\r\n            font-size: 2.5rem;\r\n            margin-bottom: 0.5rem;\r\n\r\n        }\r\n        \r\n        .app-subtitle {\r\n            font-size: 1.5rem;\r\n            margin-top: 0;\r\n        }\r\n/* Base Styles */\r\n:root {\r\n  --primary-color: #3498db;\r\n  --secondary-color: #2980b9;\r\n  --success-color: #2ecc71;\r\n  --danger-color: #e74c3c;\r\n  --warning-color: #f39c12;\r\n  --light-color: #ecf0f1;\r\n  --dark-color: #2c3e50;\r\n  --text-color: #333;\r\n  --text-light: #7f8c8d;\r\n  --border-radius: 8px;\r\n  --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\r\n  --transition: all 0.3s ease;\r\n}\r\n\r\n* {\r\n  box-sizing: border-box;\r\n  margin: 0;\r\n  padding: 0;\r\n}\r\n\r\nbody {\r\n  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\r\n  line-height: 1.6;\r\n  color: var(--text-color);\r\n  background-color: #f5f7fa;\r\n}\r\n\r\n.hidden-input {\r\n  display: none;\r\n}\r\n\r\n/* Layout */\r\n.app-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  min-height: 100vh;\r\n  max-width: 100%;\r\n  overflow-x: hidden;\r\n}\r\n\r\n.main-content {\r\n  flex: 1;\r\n  padding: 1rem;\r\n  max-width: 800px;\r\n  margin: 0 auto;\r\n  width: 100%;\r\n}\r\n\r\n/* Header */\r\n.app-header {\r\n  background-color: var(--primary-color);\r\n  color: white;\r\n  padding: 1.5rem 1rem;\r\n  text-align: center;\r\n  box-shadow: var(--box-shadow);\r\n}\r\n\r\n.app-title {\r\n  font-size: 1.5rem;\r\n  margin-bottom: 0.5rem;\r\n  font-weight: 600;\r\n}\r\n\r\n.app-subtitle {\r\n  font-size: 0.9rem;\r\n  opacity: 0.9;\r\n}\r\n\r\n/* Cards */\r\n.attendance-card,\r\n.announcement-card,\r\n.info-card {\r\n  background: white;\r\n  border-radius: var(--border-radius);\r\n  box-shadow: var(--box-shadow);\r\n  padding: 1.5rem;\r\n  margin-bottom: 1.5rem;\r\n}\r\n\r\n/* Form Elements */\r\n.form-group {\r\n  margin-bottom: 1.5rem;\r\n}\r\n\r\n.form-label {\r\n  display: block;\r\n  margin-bottom: 0.5rem;\r\n  font-weight: 500;\r\n  text-align: left;\r\n}\r\n\r\n.form-select {\r\n  width: 100%;\r\n  padding: 0.75rem;\r\n  border: 1px solid #ddd;\r\n  border-radius: var(--border-radius);\r\n  font-size: 1rem;\r\n  transition: var(--transition);\r\n  background-color: white;\r\n}\r\n\r\n.form-select:focus {\r\n  outline: none;\r\n  border-color: var(--primary-color);\r\n  box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);\r\n}\r\n\r\n/* Buttons */\r\n.primary-btn {\r\n  background-color: #dc3545;\r\n  color: white;\r\n  border: none;\r\n  padding: 0.75rem 1.5rem;\r\n  border-radius: var(--border-radius);\r\n  font-size: 1rem;\r\n  font-weight: 500;\r\n  cursor: pointer;\r\n  transition: var(--transition);\r\n  width: 100%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 0.5rem;\r\n  min-width: 120px; \r\n  height: 40px; \r\n  font-size: 14px; \r\n}\r\n\r\n.primary-btn:hover {\r\n  transform: translateY(-1px);\r\n}\r\n\r\n.primary-btn:disabled {\r\n  background-color: #bdc3c7;\r\n  cursor: not-allowed;\r\n}\r\n\r\n/* Confirmation Message */\r\n.confirmation-message {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 0.5rem;\r\n  color: var(--success-color);\r\n  font-weight: 500;\r\n  margin-top: 1rem;\r\n  padding: 0.75rem;\r\n  background-color: rgba(46, 204, 113, 0.1);\r\n  border-radius: var(--border-radius);\r\n}\r\n\r\n.success-icon {\r\n  font-size: 1.2rem;\r\n}\r\n\r\n/* Announcement Section */\r\n.announcement-header {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.75rem;\r\n  margin-bottom: 1rem;\r\n}\r\n\r\n.announcement-header h3 {\r\n  font-size: 1.2rem;\r\n  color: var(--dark-color);\r\n}\r\n\r\n.announcement-icon {\r\n  color: var(--warning-color);\r\n  font-size: 1.2rem;\r\n}\r\n\r\n.announcement-image {\r\n  width: 100%;      /* Responsif, mengisi lebar container */\r\n  max-width: 800px; /* Batas maksimal lebar */\r\n  height: auto;     /* Menjaga rasio aspek */\r\n  border-radius: 8px; /* Sudut melengkung */\r\n  margin-bottom: 1rem;\r\n}\r\n\r\n.announcement-text {\r\n  text-align: center;\r\n  font-weight: 500;\r\n  color: var(--text-color);\r\n}\r\n\r\n/* Info Sections */\r\n.info-section {\r\n  display: grid;\r\n  grid-template-columns: 1fr;\r\n  gap: 1.5rem;\r\n}\r\n\r\n.info-header {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.75rem;\r\n  margin-bottom: 1rem;\r\n}\r\n\r\n.info-header h4 {\r\n  font-size: 1.1rem;\r\n  color: var(--dark-color);\r\n}\r\n\r\n.info-header i {\r\n  color: var(--primary-color);\r\n  font-size: 1.1rem;\r\n}\r\n\r\n.info-content {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 0.5rem;\r\n}\r\n\r\n.info-row {\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n\r\n.info-label {\r\n  font-weight: 500;\r\n  color: var(--text-light);\r\n}\r\n\r\n.info-value {\r\n  font-weight: 500;\r\n  color: var(--dark-color);\r\n  text-align: right;\r\n}\r\n\r\n.map-image {\r\n  width: 100%;\r\n  border-radius: var(--border-radius);\r\n  margin-top: 1rem;\r\n  border: 1px solid #eee;\r\n}\r\n\r\n/* Footer */\r\n.app-footer {\r\n  background-color: var(--dark-color);\r\n  color: white;\r\n  text-align: center;\r\n  padding: 1.5rem 1rem;\r\n  margin-top: 2rem;\r\n  \r\n}\r\n\r\n.app-footer p {\r\n  margin-bottom: 0.5rem;\r\n}\r\n\r\n.footer-copyright {\r\n  font-size: 0.8rem;\r\n  opacity: 0.8;\r\n}\r\n\r\n/* Responsive Adjustments */\r\n@media (min-width: 768px) {\r\n  .app-title {\r\n    font-size: 2rem;\r\n  }\r\n  \r\n  .app-subtitle {\r\n    font-size: 1rem;\r\n  }\r\n  \r\n  .info-section {\r\n    grid-template-columns: repeat(2, 1fr);\r\n  }\r\n  \r\n  .primary-btn {\r\n    width: auto;\r\n    padding: 0.75rem 2rem;\r\n  }\r\n}\r\n\r\n@media (max-width: 480px) {\r\n  .attendance-card,\r\n  .announcement-card,\r\n  .info-card {\r\n    padding: 1rem;\r\n  }\r\n  \r\n  .app-header {\r\n    padding: 1rem;\r\n  }\r\n  \r\n  .app-title {\r\n    font-size: 1.3rem;\r\n  }\r\n}\r\n</style>"],"names":["_sfc_main","props","imageSrc","type","String","required","imageTitle","default","showModal","Boolean","methods","closeModal","this","$emit","handleKeydown","e","key","mounted","window","addEventListener","beforeUnmount","removeEventListener","class","role","_hoisted_2","id","_hoisted_4","_hoisted_5","$props","_createElementBlock","tabindex","style","display","onClick","_cache","_withModifiers","$options","args","_createElementVNode","_hoisted_1","_hoisted_3","_toDisplayString","src","alt","_createCommentVNode","userData","useUserStore","ref","default_str","ipData","ipv4","ipv6","gpsLocation","lat","lon","city","country","gpsMapUrl","attendanceRecorded","selectedLocation","locations","absensiStatusArray","isLoadingAbsensiStatus","dataLoaded","computed","value","some","val","includes","tooFar","_a","distance","absensiStatus","latest","hourIn","hour_in","Date","timeDiffHours","hour_out","fetchAbsensiStatus","async","responseStatus","fetch","apiBaseUrl","username","json","length","foto_in","baseUrl","foto_out","fetchLokasi","responseLokasi","axios","get","data","map","item","latitude","longitude","lat1","lon1","lat2","lon2","dLat","Math","PI","dLon","a","sin","cos","atan2","sqrt","isNaN","toFixed","getDistanceFromLatLonInKm","Infinity","nama","sort","b","fetchIp","responseIPv4","ip","error","openModal","openCamera","document","getElementById","click","alert","handlePhoto","event","file","target","files","dimension","device","innerWidth","innerHeight","userAgent","navigator","match","substring","getDeviceInfo","formData","FormData","append","response","post","headers","status","location","reload","err","formatDate","dateString","date","getDate","getMonth","getFullYear","getHours","padStart","getMinutes","getSeconds","onMounted","Promise","resolve","geolocation","getCurrentPosition","position","coords","enableHighAccuracy","timeout","maximumAge","all"],"mappings":"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"}