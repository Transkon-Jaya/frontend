{"version":3,"file":"FormIzin-CKB6FeWX.js","sources":["../../src/views/absensi/FormIzin.vue"],"sourcesContent":["<script setup>\r\nimport { ref, onMounted, computed, nextTick, reactive } from \"vue\";\r\nimport axios from \"axios\";\r\nimport { log, logError } from \"@/utils/logger\";\r\nimport VButton from \"@/components/Button.vue\";\r\nimport { API_BASE_URL } from \"@/config/config\";\r\n\r\n// global variables\r\nimport { useUserStore } from \"@/stores/user\";\r\nconst userData = useUserStore();\r\nimport { useThemeStore } from '@/stores/theme';\r\nconst theme = useThemeStore();\r\n\r\n// api\r\nconst urlProfile = API_BASE_URL + \"/perizinan\";\r\n\r\nconst loadingString = \"Loading...\";\r\n\r\nconst user = reactive({\r\n  keterangan: \"\",\r\n  izin: \"\",         // <--- Tambahan untuk dropdown\r\n  izinLabel: \"\",    // <--- Tambahan untuk dropdown\r\n});\r\n\r\nconst formData = new FormData();\r\nconst data = ref();\r\nconst selectedFile = ref(null);\r\n\r\nconst handleFileUpload = (event) => {\r\n  selectedFile.value = event.target.files[0];\r\n};\r\n\r\nconst passwordMismatch = computed(() => user.password !== user.confirmPassword);\r\n\r\n// Fetch data ketika komponen mounted\r\nonMounted(async () => {\r\n  console.log(\"Photo : \", userData.photo);\r\n  try {\r\n    const response = await axios.get(urlProfile, {\r\n      params: {\r\n        username: userData.username,\r\n      },\r\n    });\r\n    data.value = response.data[0];\r\n  } catch (error) {\r\n    console.error(\"Fetch error:\", error);\r\n  }\r\n});\r\n\r\n\r\nconst resetForm = () => {\r\n  user.keterangan = \"\";\r\n  user.izin = \"\";\r\n  user.izinLabel = \"\";\r\n};\r\n\r\nconst submitForm = async () => {\r\n  try {\r\n    if(user.keterangan == \"\"){\r\n      alert(\"Keterangan Masih Kosong\");\r\n      return;\r\n    }\r\n    if(user.izin == \"\"){\r\n      alert(\"Pilih Jenis Perizinan\");\r\n      return;\r\n    }\r\n    if (!selectedFile.value) {\r\n      alert(\"Upload Foto Bukti\")\r\n      return;\r\n    }\r\n    formData.append(\"username\", userData.username);\r\n    formData.append(\"picture\", selectedFile.value);\r\n    formData.append(\"keterangan\", user.keterangan);\r\n    formData.append(\"izin\", user.izin);\r\n\r\n    const response = await axios.post(urlProfile, formData);\r\n    log(\"RESPONSE : \", response.data);\r\n    await nextTick();\r\n    // window.location.reload();\r\n    alert(\"Inserted successfully!\");\r\n  } catch (error) {\r\n    logError(\"Submit error:\", error);\r\n    alert(\"Error updating profile.\");\r\n  }\r\n};\r\n\r\n// Dropdown logic untuk Jenis Izin\r\nconst options = [\r\n  { value: 'datang', label: 'Datang terlambat' },\r\n  { value: 'pulang', label: 'Pulang cepat' },\r\n  { value: 'tidak-masuk', label: 'Tidak masuk' }\r\n];\r\n\r\nconst dropdownOpen = ref(false);\r\n\r\nfunction toggleDropdown() {\r\n  dropdownOpen.value = !dropdownOpen.value;\r\n}\r\n\r\nfunction selectOption(option) {\r\n  user.izin = option.value;\r\n  user.izinLabel = option.label;\r\n  dropdownOpen.value = false;\r\n}\r\n</script>\r\n\r\n\r\n<template>\r\n  <div class=\"row\">\r\n    <div class=\"col-xl-6 mx-auto\">\r\n      <div class=\"card\">\r\n        <div class=\"card-header px-4 py-3\">\r\n          <h5 class=\"mb-0\">Perizinan</h5>\r\n        </div>\r\n        <div class=\"card-body p-4\">\r\n          <form\r\n            @submit.prevent=\"submitForm\"\r\n            class=\"row g-3 needs-validation\"\r\n            novalidate\r\n          >\r\n            <div class=\"col-md-12\">\r\n              <label for=\"keterangan\" class=\"form-label\">Keterangan</label>\r\n              <input\r\n                v-model=\"user.keterangan\"\r\n                type=\"text\"\r\n                class=\"form-control\"\r\n                id=\"keterangan\"\r\n              />\r\n            </div>\r\n\r\n            <div class=\"col-md-12\">\r\n                <label for=\"izin\" class=\"form-label\">Jenis Izin</label>\r\n                <div class=\"dropdown\":class=\"theme.darkMode ? 'bg-dark text-white border-secondary' : 'bg-white text-dark border-secondary'\">\r\n                    <div class=\"dropdown-selected\" @click=\"toggleDropdown\">\r\n                    {{ user.izinLabel || 'Pilih salah satu' }}\r\n                    </div>\r\n                    <transition name=\"slide-fade\">\r\n                      <div\r\n                            v-if=\"dropdownOpen\"\r\n                            class=\"dropdown-options border\"\r\n                            :class=\"theme.darkMode ? 'bg-dark text-white border-secondary' : 'bg-white text-dark border-secondary'\"\r\n                          >\r\n                        <div \r\n                        v-for=\"option in options\" \r\n                        :key=\"option.value\" \r\n                        class=\"dropdown-option\" \r\n                        @click=\"selectOption(option)\" \r\n                        >\r\n                        {{ option.label }}\r\n                        </div>\r\n                    </div>\r\n                    </transition>\r\n                </div>\r\n            </div>\r\n\r\n\r\n            <!-- Upload Foto -->\r\n            <div class=\"col-md-12\">\r\n              <label for=\"photo\" class=\"form-label\">Upload Foto Bukti</label>\r\n              <input type=\"file\" class=\"form-control\" id=\"photo\" @change=\"handleFileUpload\" accept=\"image/*\" />\r\n              <div v-if=\"previewImage\" class=\"mt-3\">\r\n                <img :src=\"previewImage\" alt=\"Preview\" class=\"img-thumbnail\" style=\"max-width: 200px;\" />\r\n              </div>\r\n            </div>\r\n\r\n             <div class=\"col-md-12 mt-4 mb-3 d-flex gap-3\">\r\n              <VButton type=\"submit\" color=\"danger\" size=\"md\" :block=\"false\">\r\n                Submit\r\n              </VButton>\r\n              <VButton type=\"reset\" class=\"btn btn-secondary\" @click=\"resetForm\">\r\n                Reset\r\n              </VButton>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style scoped>\r\n/* style khusus dropdown */\r\n.dropdown-selected {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n.dropdown {\r\n  position: relative;\r\n  cursor: pointer;\r\n  height: 35px; \r\n  border-color: #e6e6e6;\r\n}\r\n.dropdown-options {\r\n  position: absolute;\r\n  width: 100%;\r\n  background-color: var(--dropdown-bg, white);\r\n  color: var(--dropdown-text, black);\r\n  border: 1px solid #ccc;\r\n  z-index: 10;\r\n  margin-top: 5px;\r\n}\r\n\r\n.dropdown-option:hover {\r\n  background: var(--dropdown-hover-bg, #dc3545);\r\n  color: var(--dropdown-hover-text, white);\r\n}\r\n\r\n.dropdown-option {\r\n  padding: 10px;\r\n}\r\n.dropdown-option:hover {\r\n  background: #dc3545;\r\n  color: white;\r\n}\r\n\r\n/* Tambahan animasi */\r\n.slide-fade-enter-active {\r\n  transition: all 0.3s ease;\r\n}\r\n.slide-fade-leave-active {\r\n  transition: all 0.2s ease;\r\n}\r\n.slide-fade-enter-from {\r\n  opacity: 0;\r\n  transform: translateY(-10px);\r\n}\r\n.slide-fade-leave-to {\r\n  opacity: 0;\r\n  transform: translateY(-10px);\r\n}\r\n</style>"],"names":["userData","useUserStore","theme","useThemeStore","urlProfile","API_BASE_URL","user","reactive","keterangan","izin","izinLabel","formData","FormData","data","ref","selectedFile","handleFileUpload","event","value","target","files","computed","password","confirmPassword","onMounted","async","response","axios","get","params","username","error","resetForm","submitForm","alert","append","post","log","nextTick","logError","options","label","dropdownOpen","toggleDropdown","option"],"mappings":"mgBASA,MAAMA,EAAWC,IAEXC,EAAQC,IAGRC,EAAaC,EAAe,aAI5BC,EAAOC,EAAS,CACpBC,WAAY,GACZC,KAAM,GACNC,UAAW,KAGPC,EAAW,IAAIC,SACfC,EAAOC,IACPC,EAAeD,EAAI,MAEnBE,EAAoBC,IACxBF,EAAaG,MAAQD,EAAME,OAAOC,MAAM,EAAC,EAGlBC,GAAS,IAAMf,EAAKgB,WAAahB,EAAKiB,kBAG/DC,GAAUC,UAEJ,IACF,MAAMC,QAAiBC,EAAMC,IAAIxB,EAAY,CAC3CyB,OAAQ,CACNC,SAAU9B,EAAS8B,YAGlBjB,EAAAK,MAAQQ,EAASb,KAAK,EAC5B,OAAQkB,GAER,KAIH,MAAMC,EAAY,KAChB1B,EAAKE,WAAa,GAClBF,EAAKG,KAAO,GACZH,EAAKI,UAAY,EAAA,EAGbuB,EAAaR,UACb,IACC,GAAmB,IAAnBnB,EAAKE,WAEN,YADA0B,MAAM,2BAGL,GAAa,IAAb5B,EAAKG,KAEN,YADAyB,MAAM,yBAGJ,IAACnB,EAAaG,MAEhB,YADAgB,MAAM,qBAGCvB,EAAAwB,OAAO,WAAYnC,EAAS8B,UAC5BnB,EAAAwB,OAAO,UAAWpB,EAAaG,OAC/BP,EAAAwB,OAAO,aAAc7B,EAAKE,YAC1BG,EAAAwB,OAAO,OAAQ7B,EAAKG,MAE7B,MAAMiB,QAAiBC,EAAMS,KAAKhC,EAAYO,GAC1C0B,EAAA,cAAeX,EAASb,YACtByB,IAENJ,MAAM,yBACP,OAAQH,GACPQ,EAAS,gBAAiBR,GAC1BG,MAAM,0BACP,GAIGM,EAAU,CACd,CAAEtB,MAAO,SAAUuB,MAAO,oBAC1B,CAAEvB,MAAO,SAAUuB,MAAO,gBAC1B,CAAEvB,MAAO,cAAeuB,MAAO,gBAG3BC,EAAe5B,GAAI,GAEzB,SAAS6B,IACMD,EAAAxB,OAASwB,EAAaxB,KACrC,qhCAEA,SAAsB0B,GACpBtC,EAAKG,KAAOmC,EAAO1B,MACnBZ,EAAKI,UAAYkC,EAAOH,MACxBC,EAAaxB,OAAQ,CACvB"}