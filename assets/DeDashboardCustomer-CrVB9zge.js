import{s as q}from"./vue-multiselect-DAAKast7.js";import{_ as z,r as s,u as H,A as u,w as O,o as M,G,c as r,m as d,a as e,d as c,z as K,t as v,h as k,F as J,j as Q,f as W,H as X,q as F,C as Y,g as i,y as Z}from"./index-CtekyGin.js";import{C as h}from"./Charts-I3SNnvPB.js";import{R as ee}from"./RouterLink-Bq55f13_.js";import{_ as te}from"./BigTable-CrIB6icB.js";/* empty css                                                                   */import"./xlsx-64ipigSZ.js";const ae={key:0},se={class:"mb-2"},le={class:"text-end"},oe={class:"row text-center mb-4"},ne={class:"col"},re={class:"card border-success"},ie={class:"card-body"},de={class:"text-success"},ue={class:"col"},ce={class:"card border-danger"},ve={class:"card-body"},_e={class:"text-danger",style:{"text-align":"center"}},me={style:{"margin-right":"10px"}},pe={style:{"margin-left":"10px"}},ye={class:"col"},ge={class:"card border-warning"},he={class:"card-body"},be={class:"text-warning",style:{"text-align":"center"}},fe={style:{"margin-right":"10px"}},we={style:{"margin-left":"10px"}},ke={class:"nav nav-tabs"},xe=["onClick"],De={key:1,class:"card mb-4"},Se={class:"card-body"},Ce={key:2,class:"row g-4 mb-4"},Ue={key:0,class:"col-md-12"},Te={key:1,class:"col-md-12"},Be={class:"card h-100"},Ae={key:2,class:"col-md-12"},Fe={class:"card h-100"},Ie={key:3,class:"col-md-12"},Re={class:"card h-100"},Ve={key:4,class:"col-md-12"},Le={class:"card h-100"},$e={__name:"DeDashboardCustomer",setup(Ee){const I=s(null),y=H(),g=s(""),o=s(""),b=s([]),x=s(!0),D=s({title:"Daily Trend",type:"bar",api:{url:u+"/chart/de_running_total",params:[14,o.value,""]},columns:{label:["date"],datas:["running_total","daily_down","daily_done"]},colors:["red","orange","green"],labels:["Total Down","Units Down / Day","Units Done / Day"]}),f=s({title:"Daily Trend",type:"line",api:{url:u+"/chart/de_running_total",params:[14,o.value,""]},columns:{label:["date"],datas:["running_total","daily_down","daily_done"]},colors:["red","orange","green"],labels:["Total Down","Units Down / Day","Units Done / Day"]}),S=s({title:"Unit Summary",type:"pie",api:{url:u+"/chart/de_total_rental",params:[o.value,""]},columns:{datas:["unit_rental","spare_exists_false","spare_exists_true"]},colors:["green","red","orange"],labels:["Unit Rental","PA Unit","PA Rental"]}),R=s({title:"Customer Summary",type:"bar",api:{url:u+"/chart/de_customer_summary"},columns:{label:["customer"],datas:["total_unit","total_break"]},colors:["green","red"],labels:["Total Unit","Total Break"]}),V=s({title:"Location Summary",type:"bar",api:{url:u+"/chart/de_location_summary"},columns:{label:["alt_location"],datas:["total_unit","total_break"]},colors:["green","red"],labels:["Total Unit","Total Break"]}),L=s({title:""}),$=s({firstCol:{label:"TK NO",field:"tk_no",type:"type"},merge:[{fields:["hour_in","hour_out"],to:"hour"},{fields:["jarak_in","jarak_out"],to:"jarak"}],priority:["customer","alt_location"],unpriority:["username","createdAt","lastUpdated"],hidden:["id","done"],toRemove:["vehicle_type","plate_no"],uneditable:["id","plan_hub"],checkbox:["spare_exists"],date:[],datetime:["down_since","estimated_return"]}),E=s({data:`${y.apiBaseUrl}/de_site`,dropdowns:{vehicle_type:{url:y.apiBaseUrl+"/dropdowns/vehicle_type",valueField:"vehicle_type",column:"vehicle_type"},tk_no:{url:y.apiBaseUrl+"/dropdowns/tk_no",valueField:"tk_no",column:"tk_no"}},get:{vehicle_type:{url:y.apiBaseUrl+"/get/vehicle_type",valueField:"vehicle_type",column:"vehicle_type"}}}),l=s(""),N=[{label:"All",value:""},{label:"Site Summary",value:"site-summary"},{label:"Daily Trend",value:"0"},{label:"Unit Summary",value:"1"},{label:"Customer Summary",value:"2"},{label:"Location Summary",value:"3"}],P=async()=>{try{const a=await F.get(u+"/dropdowns/customer");b.value=a.data.map(t=>({label:t,value:t}))}catch(a){console.error("Error fetching dropdown data:",a)}};s();const C=s(),j=async a=>{console.log(a),g.value=a,o.value=g.value.value,D.value.api.params[1]=o.value,f.value.api.params[1]=o.value,await C.value.renderChart(),await w(),await Y()},p=s([0,0]),_=s([0,0]),m=s([0,0]),U=s("");function T(){const a=new Date,t=a.getHours().toString().padStart(2,"0"),n=a.getMinutes().toString().padStart(2,"0"),A=a.getSeconds().toString().padStart(2,"0");U.value=`${t}:${n}:${A}`}const w=async()=>{try{const a=await F.get(u+"/chart/de_total_rental",{params:{params:[o.value,""]}}),t=a.data[0].unit_rental+a.data[0].spare_exists_false+a.data[0].spare_exists_true;p.value[0]=a.data[0].unit_rental,_.value[0]=a.data[0].spare_exists_false+a.data[0].spare_exists_true,m.value[0]=a.data[0].spare_exists_false,t===0?(p.value[1]=0,_.value[1]=0,m.value[1]=0):(p.value[1]=(p.value[0]/t*100).toFixed(2),_.value[1]=(_.value[0]/t*100).toFixed(2),m.value[1]=(m.value[0]/t*100).toFixed(2))}catch(a){console.error("Fetch error:",a)}};O(o.value,async()=>{console.log("selectedItems : ",o.value),D.value.api.params[1]=o.value,f.value.api.params[1]=o.value,S.value.api.params[0]=o.value,await w()});let B;return M(async()=>{await P(),await w(),x.value=!1,console.log("dropdown : ",b.value),T(),B=setInterval(T,1e3)}),G(()=>{clearInterval(B)}),(a,t)=>(i(),r("div",{class:"content",style:X({paddingTop:a.showHeader?"100px":"0px"})},[x.value?d("",!0):(i(),r("div",ae,[t[2]||(t[2]=e("label",{for:"dropdown",class:"form-label"},"Select Customer",-1)),c(K(q),{modelValue:g.value,"onUpdate:modelValue":[t[0]||(t[0]=n=>g.value=n),t[1]||(t[1]=n=>j(n))],options:b.value||[],placeholder:"Select Customer",label:"label","track-by":"value",class:"multiselect no-border"},null,8,["modelValue","options"])])),e("div",se,[t[9]||(t[9]=e("h1",{class:"h4 fw-bold"},"Down Equipment Dashboard",-1)),e("div",le,[t[3]||(t[3]=e("h5",{class:"fw-bold text-primary"},null,-1)),e("div",null,v(U.value),1)]),e("div",oe,[e("div",ne,[e("div",re,[e("div",ie,[e("h3",de,v(p.value[0]),1),t[4]||(t[4]=e("p",{class:"fw-bold mb-0"},"On Hire (UIC)",-1))])])]),e("div",ue,[e("div",ce,[e("div",ve,[e("h3",_e,[e("span",me,v(_.value[1])+"%",1),t[5]||(t[5]=k(" || ")),e("span",pe,v(_.value[0]),1)]),t[6]||(t[6]=e("p",{class:"fw-bold mb-0"},"PA Unit",-1))])])]),e("div",ye,[e("div",ge,[e("div",he,[e("h3",be,[e("span",fe,v(m.value[1])+"%",1),t[7]||(t[7]=k(" || ")),e("span",we,v(m.value[0]),1)]),t[8]||(t[8]=e("p",{class:"fw-bold mb-0"},"PA Rental",-1))])])])])]),e("ul",ke,[(i(),r(J,null,Q(N,n=>e("li",{class:"nav-item",key:n.value},[e("button",{class:Z(["nav-link",{active:l.value===n.value}]),onClick:A=>l.value=n.value},v(n.label),11,xe)])),64))]),l.value===""||l.value==="site-summary"?(i(),r("div",De,[e("div",Se,[t[10]||(t[10]=e("h5",{class:"card-title text-danger"},"Site Summary",-1)),c(te,{ref_key:"bigTableRef",ref:I,settings:L.value,urls:E.value,fields:$.value,canInsert:!1,canUpdate:!1},null,8,["settings","urls","fields"])])])):d("",!0),l.value===""||["0","1","2","3"].includes(l.value)?(i(),r("div",Ce,[l.value===""||l.value==="0"?(i(),r("div",Ue)):d("",!0),l.value===""||l.value==="0"?(i(),r("div",Te,[e("div",Be,[c(h,{ref_key:"chart11",ref:C,settings:f.value},null,8,["settings"])])])):d("",!0),l.value===""||l.value==="1"?(i(),r("div",Ae,[e("div",Fe,[c(h,{settings:S.value},null,8,["settings"])])])):d("",!0),l.value===""||l.value==="2"?(i(),r("div",Ie,[e("div",Re,[c(h,{settings:R.value},null,8,["settings"])])])):d("",!0),l.value===""||l.value==="3"?(i(),r("div",Ve,[e("div",Le,[c(h,{settings:V.value},null,8,["settings"])])])):d("",!0)])):d("",!0),e("div",null,[c(ee,{to:"/de/down-equipment",color:"danger",size:"md"},{default:W(()=>t[11]||(t[11]=[k("Back to Down Equipment")])),_:1})])],4))}},Me=z($e,[["__scopeId","data-v-b4a43938"]]);export{Me as default};
//# sourceMappingURL=DeDashboardCustomer-CrVB9zge.js.map
