import{_ as se,u as oe,r as o,m as p,o as ne,K as re,c as d,a as e,d as A,s as N,b as R,v as K,f as ie,V as de,t as n,p as ue,F as G,j as O,z as E,q as P,x as I,A as B,P as ce,g as u,h as ve}from"./index-Djae-XEA.js";import{s as q}from"./vue-multiselect-BRlKmduE.js";/* empty css                            *//* empty css                                                 */import{M as me}from"./bootstrap.esm-B0YAJBZY.js";const pe={class:"container-global"},be={class:"d-flex align-items-end gap-3 flex-wrap"},ge={class:"col-md-4"},he={class:"col-md-4"},fe={class:"filter-box flex-grow-1"},_e={class:"border rounded p-2 bg-white"},ye={class:"filter-box flex-grow-1"},we={class:"border rounded p-2 bg-white"},ke={class:"filter-box"},xe={class:"container my-4"},Me={key:0,class:"text-center my-5"},Ce={key:1,class:"alert alert-danger"},De={key:2},Ve={class:"row"},Ae={class:"card h-100"},Ee=["src","onClick"],Pe={class:"card-body"},Ie={class:"card-title"},Be={class:"card-text text-muted small"},Le={key:0,"aria-label":"Page navigation"},Se={class:"pagination justify-content-center mt-4"},Te=["onClick"],Ue={class:"text-center text-muted small"},$e={class:"modal-dialog modal-dialog-centered modal-lg"},je={class:"modal-content bg-dark text-white"},ze={class:"modal-header border-0"},Fe={class:"modal-title",id:"imageModalLabel"},Ne={class:"modal-body text-center"},Re=["src"],Ke={class:"modal-footer justify-content-between border-0"},Ge=["disabled"],Oe=["disabled"],v=20,qe={__name:"GalleryAbsensi",setup(He){const x=oe(),i=o([]),r=o(0),M=o(null),b=o(!0),C=o(null);o("");const s=o(1),g=o(""),h=o(""),f=o(""),_=o(""),L=o([]),S=o([]);o({api:{params:[]}}),o({api:{params:[]}}),o(null),o(null);const y=p(()=>Math.ceil(i.value.length/v)),H=p(()=>{const l=(s.value-1)*v,a=l+v;return i.value.slice(l,a)}),J=p(()=>(s.value-1)*v+1),Q=p(()=>Math.min(s.value*v,i.value.length)),W=p(()=>{const l=[];let t=Math.max(1,s.value-Math.floor(2.5)),m=Math.min(y.value,t+5-1);m-t+1<5&&(t=Math.max(1,m-5+1));for(let k=t;k<=m;k++)l.push(k);return l}),T=l=>{if(!l)return"";const a={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(l).toLocaleDateString("id-ID",a)},U=l=>l?`${ce}/absensi/${l}`:"",D=p(()=>i.value[r.value]||{}),X=()=>{s.value<y.value&&s.value++},Y=()=>{s.value>1&&s.value--},Z=l=>{s.value=l},ee=l=>(s.value-1)*v+l,V=async()=>{try{b.value=!0;const a=(await I.get(B+"/absensi-gallery",{headers:{Authorization:`Bearer ${x.token}`},params:{department:g.value.value,name:h.value.value,start_date:f.value,end_date:_.value}})).data;if(Array.isArray(a))i.value=a.filter(t=>t.foto);else throw new Error("Format data tidak valid")}catch(l){console.error("Error fetching data:",l),C.value=l.message,i.value=[{foto:"Tj1023_IN_1746431330.jpg",name:"Contoh Karyawan 1",hour:"2023-11-15T08:00:00",status:"in"},{foto:"Tj1023_IN_1746507175.jpg",name:"Contoh Karyawan 2",hour:"2023-11-15T08:05:00",status:"in"}]}finally{b.value=!1}};let c=null;const ae=l=>{r.value=l,c==null||c.show()},$=()=>{c==null||c.hide()},j=()=>{if(r.value<i.value.length-1){r.value++;const l=Math.floor(r.value/v)+1;l!==s.value&&(s.value=l)}},z=()=>{if(r.value>0){r.value--;const l=Math.floor(r.value/v)+1;l!==s.value&&(s.value=l)}},F=l=>{var a;if(!(!c||!((a=document.getElementById("imageModal"))!=null&&a.classList.contains("show"))))switch(l.key){case"ArrowRight":j();break;case"ArrowLeft":z();break;case"Escape":$();break}},te=async()=>{try{const l=await I.get(`${B}/dropdowns/department`,{headers:{Authorization:`Bearer ${x.token}`}});L.value=l.data.map(t=>({label:t,value:t}));const a=await I.get(`${B}/dropdowns/name`,{headers:{Authorization:`Bearer ${x.token}`}});S.value=a.data.map(t=>({label:t,value:t}))}catch(l){console.error("Error fetching dropdowns:",l)}},w=async(l,a)=>{await V()},le=async()=>{g.value={label:"",value:""},h.value={label:"",value:""},f.value="",_.value="",await V()};return ne(async()=>{M.value&&(c=new me(M.value)),await V(),await te(),b.value=!1,document.addEventListener("keydown",F)}),re(()=>{document.removeEventListener("keydown",F)}),(l,a)=>(u(),d("div",pe,[e("div",be,[e("div",ge,[a[8]||(a[8]=e("label",{class:"form-label"},"Department",-1)),A(N(q),{modelValue:g.value,"onUpdate:modelValue":[a[0]||(a[0]=t=>g.value=t),a[1]||(a[1]=t=>w())],options:L.value||[],placeholder:"Select...",label:"label","track-by":"value",class:"multiselect no-border"},null,8,["modelValue","options"])]),e("div",he,[a[9]||(a[9]=e("label",{class:"form-label"},"Employee",-1)),A(N(q),{modelValue:h.value,"onUpdate:modelValue":[a[2]||(a[2]=t=>h.value=t),a[3]||(a[3]=t=>w())],options:S.value||[],placeholder:"Select...",label:"label","track-by":"value",class:"multiselect no-border"},null,8,["modelValue","options"])]),e("div",fe,[a[10]||(a[10]=e("label",{class:"form-label small mb-1 text-muted"},"Start Date",-1)),e("div",_e,[R(e("input",{type:"date",class:"form-control border-0 p-0","onUpdate:modelValue":a[4]||(a[4]=t=>f.value=t),onChange:a[5]||(a[5]=t=>w("start",t.target.value))},null,544),[[K,f.value]])])]),e("div",ye,[a[11]||(a[11]=e("label",{class:"form-label small mb-1 text-muted"},"End Date",-1)),e("div",we,[R(e("input",{type:"date",class:"form-control border-0 p-0","onUpdate:modelValue":a[6]||(a[6]=t=>_.value=t),onChange:a[7]||(a[7]=t=>w("end",t.target.value))},null,544),[[K,_.value]])])]),e("div",ke,[A(de,{type:"button",color:"danger",size:"md",onClick:le,class:"h-100"},{default:ie(()=>a[12]||(a[12]=[e("i",{class:"bi bi-arrow-counterclockwise me-2"},null,-1),ve(" Reset ")])),_:1})])]),e("div",xe,[b.value?(u(),d("div",Me,a[13]||(a[13]=[e("div",{class:"spinner-border text-primary",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1),e("p",{class:"mt-2"},"Memuat data absensi...",-1)]))):C.value?(u(),d("div",Ce," Gagal memuat data: "+n(C.value),1)):(u(),d("div",De,[e("div",Ve,[(u(!0),d(G,null,O(H.value,(t,m)=>(u(),d("div",{class:"col-md-3 mb-4",key:m},[e("div",Ae,[e("img",{src:U(t.foto),class:"card-img-top gallery-img",onClick:k=>ae(ee(m)),alt:"Foto Absensi"},null,8,Ee),e("div",Pe,[e("h6",Ie,n(t.name),1),e("p",Be,n(t.status)+" - "+n(T(t.hour)),1)])])]))),128))]),y.value>1?(u(),d("nav",Le,[e("ul",Se,[e("li",{class:E(["page-item",{disabled:s.value===1}])},[e("a",{class:"page-link",href:"#",onClick:P(Y,["prevent"])},"«")],2),(u(!0),d(G,null,O(W.value,t=>(u(),d("li",{class:E(["page-item",{active:s.value===t}]),key:t},[e("a",{class:"page-link",href:"#",onClick:P(m=>Z(t),["prevent"])},n(t),9,Te)],2))),128)),e("li",{class:E(["page-item",{disabled:s.value===y.value}])},[e("a",{class:"page-link",href:"#",onClick:P(X,["prevent"])},"»")],2)]),e("div",Ue," Menampilkan "+n(J.value)+"-"+n(Q.value)+" dari "+n(i.value.length)+" foto ",1)])):ue("",!0)])),e("div",{class:"modal fade",id:"imageModal",tabindex:"-1","data-bs-backdrop":"false","aria-labelledby":"imageModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:M},[e("div",$e,[e("div",je,[e("div",ze,[e("h5",Fe,n(D.value.name||"Karyawan")+" - "+n(T(D.value.hour)),1),e("button",{type:"button",class:"btn-close btn-close-white",onClick:$,"aria-label":"Close","data-bs-dismiss":"modal"})]),e("div",Ne,[e("img",{src:U(D.value.foto),class:"img-fluid rounded portrait-img fixed-modal-image",alt:"Foto Absensi",ref:"modalImage"},null,8,Re)]),e("div",Ke,[e("button",{type:"button",class:"btn btn-outline-light",onClick:z,disabled:r.value===0}," « Sebelumnya ",8,Ge),e("span",null," Gambar "+n(r.value+1)+" dari "+n(i.value.length),1),e("button",{type:"button",class:"btn btn-outline-light",onClick:j,disabled:r.value===i.value.length-1}," Berikutnya » ",8,Oe)])])])],512)])]))}},Ze=se(qe,[["__scopeId","data-v-d7dc7a6f"]]);export{Ze as default};
