import{_ as ct,c as m,g as f,a as e,b as g,v as k,q as V,h as _,t as w,F as J,j as K,e as at,u as mt,r as u,n as wt,o as ft,p as z,A as j,z as L,k as yt,s as ut,B as Gt,R as Yt,y as Xt,d as xt}from"./index-B_uv-FNL.js";import{E as kt}from"./jspdf.es.min-B78wzCb_.js";import{a as qt}from"./jspdf.plugin.autotable-CtA5BUKo.js";import{E as Jt}from"./exceljs.min-B07Ji2Oa.js";import{c as ot}from"./_commonjsHelpers-D6-XlEtG.js";const Kt={setup(){const F=mt(),t=u([]),h=u(!0),a=u(!1),A=u(null),T=u(""),o=u(""),D=u(""),i=u(null),s=u(null),d=y=>y?new Date(y).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}):"-",I=async()=>{var y,S;try{h.value=!0,A.value=null;const U=await z.get(`${j}/tracking-invoices`,{headers:{Authorization:`Bearer ${F.token}`}});t.value=U.data.data||[]}catch(U){A.value=((S=(y=U.response)==null?void 0:y.data)==null?void 0:S.error)||"Gagal memuat data invoice",console.error("Fetch Error:",U)}finally{h.value=!1}},p=async y=>{try{a.value=!0;const S={acct:y.acct,tax_dept:y.tax_dept,admin:y.admin,expedisi:y.expedisi,remarks:y.remarks};await z.put(`${j}/tracking-invoices`,S,{params:{ta_id:y.ta_id},headers:{Authorization:`Bearer ${F.token}`}})}catch(S){console.error("Gagal update tracking:",S),alert("Gagal menyimpan perubahan. Coba lagi."),I()}finally{a.value=!1}},C=wt(()=>t.value.filter(y=>{var P;const S=T.value?(P=y.invoiceNo)==null?void 0:P.toLowerCase().includes(T.value.toLowerCase()):!0,U=y.invoiceDate?new Date(y.invoiceDate).toISOString().split("T")[0]:"",N=o.value?U>=o.value:!0,M=D.value?U<=D.value:!0;return S&&N&&M})),W=()=>{T.value="",o.value="",D.value="",i.value&&$(i.value).datepicker("clearDates"),s.value&&$(s.value).datepicker("clearDates")};return ft(()=>{I(),i.value&&$(i.value).datepicker({format:"yyyy-mm-dd",autoclose:!0,language:"id",todayHighlight:!0,clearBtn:!0}).on("changeDate",function(y){o.value=$(this).datepicker("getFormattedDate")}),s.value&&$(s.value).datepicker({format:"yyyy-mm-dd",autoclose:!0,language:"id",todayHighlight:!0,clearBtn:!0}).on("changeDate",function(y){D.value=$(this).datepicker("getFormattedDate")})}),{invoices:t,loading:h,submitting:a,error:A,formatDate:d,updateTracking:p,filterInvoiceNo:T,filterStartDate:o,filterEndDate:D,filteredInvoices:C,resetFilters:W,startDateInput:i,endDateInput:s}}},Qt={class:"info-card"},Zt={class:"card-header d-flex flex-column flex-md-row align-items-md-center justify-content-between"},$t={class:"filters d-flex flex-wrap gap-2"},te={class:"input-group input-group-sm",style:{"max-width":"250px"}},ee={class:"card-body"},ae={key:0,class:"text-center py-5"},oe={key:1,class:"alert alert-danger"},ne={key:2,class:"table-responsive"},le={class:"modern-table"},se={class:"checkbox-cell"},re=["onUpdate:modelValue","onChange","disabled"],ie={class:"checkbox-cell"},de=["onUpdate:modelValue","onChange","disabled"],ue={class:"checkbox-cell"},ce=["onUpdate:modelValue","onChange","disabled"],me={class:"checkbox-cell"},fe=["onUpdate:modelValue","onChange","disabled"],ve=["onUpdate:modelValue","onBlur","disabled"];function pe(F,t,h,a,A,T){return f(),m("div",Qt,[e("div",Zt,[t[5]||(t[5]=e("h3",{class:"card-title mb-2 mb-md-0"},"TRANSMITAL INVOICE INTERNAL",-1)),e("div",$t,[g(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=o=>a.filterInvoiceNo=o),placeholder:"Cari No. Invoice...",class:"form-control form-control-sm",style:{"max-width":"200px"}},null,512),[[k,a.filterInvoiceNo]])]),e("div",te,[g(e("input",{type:"text",ref:"startDateInput","onUpdate:modelValue":t[1]||(t[1]=o=>a.filterStartDate=o),class:"form-control form-control-sm datepicker",placeholder:"Start Date"},null,512),[[k,a.filterStartDate]]),t[4]||(t[4]=e("span",{class:"input-group-text"},"â†’",-1)),g(e("input",{type:"text",ref:"endDateInput","onUpdate:modelValue":t[2]||(t[2]=o=>a.filterEndDate=o),class:"form-control form-control-sm datepicker",placeholder:"End Date"},null,512),[[k,a.filterEndDate]])]),e("button",{class:"btn btn-sm btn-secondary",onClick:t[3]||(t[3]=(...o)=>a.resetFilters&&a.resetFilters(...o))},"Reset")]),e("div",ee,[a.loading?(f(),m("div",ae,t[6]||(t[6]=[e("div",{class:"spinner-border text-primary"},null,-1),e("p",null,"Loading invoices...",-1)]))):V("",!0),a.error?(f(),m("div",oe,[t[7]||(t[7]=e("strong",null,"Error:",-1)),_(" "+w(a.error),1)])):(f(),m("div",ne,[e("table",le,[t[8]||(t[8]=e("thead",null,[e("tr",null,[e("th",null,"No."),e("th",null,"No. Inv"),e("th",null,"Tgl Invoice"),e("th",null,"Acct"),e("th",null,"Tax Dept."),e("th",null,"Admin"),e("th",null,"Expedisi"),e("th",null,"Remarks")])],-1)),e("tbody",null,[(f(!0),m(J,null,K(a.filteredInvoices,(o,D)=>(f(),m("tr",{key:o.ta_id},[e("td",null,w(D+1),1),e("td",null,w(o.invoiceNo),1),e("td",null,w(a.formatDate(o.invoiceDate)),1),e("td",se,[g(e("input",{type:"checkbox","onUpdate:modelValue":i=>o.acct=i,onChange:i=>a.updateTracking(o),class:"form-checkbox",disabled:a.submitting},null,40,re),[[at,o.acct]])]),e("td",ie,[g(e("input",{type:"checkbox","onUpdate:modelValue":i=>o.tax_dept=i,onChange:i=>a.updateTracking(o),class:"form-checkbox",disabled:a.submitting},null,40,de),[[at,o.tax_dept]])]),e("td",ue,[g(e("input",{type:"checkbox","onUpdate:modelValue":i=>o.admin=i,onChange:i=>a.updateTracking(o),class:"form-checkbox",disabled:a.submitting},null,40,ce),[[at,o.admin]])]),e("td",me,[g(e("input",{type:"checkbox","onUpdate:modelValue":i=>o.expedisi=i,onChange:i=>a.updateTracking(o),class:"form-checkbox",disabled:a.submitting},null,40,fe),[[at,o.expedisi]])]),e("td",null,[g(e("input",{type:"text","onUpdate:modelValue":i=>o.remarks=i,onBlur:i=>a.updateTracking(o),class:"form-control form-control-sm",disabled:a.submitting,placeholder:"Catatan"},null,40,ve),[[k,o.remarks]])])]))),128))])])]))])])}const ge=ct(Kt,[["render",pe],["__scopeId","data-v-25544ecf"]]);var nt={exports:{}},be=nt.exports,Dt;function ye(){return Dt||(Dt=1,function(F,t){(function(h,a){a()})(be,function(){function h(s,d){return typeof d>"u"?d={autoBom:!1}:typeof d!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),d={autoBom:!d}),d.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}function a(s,d,I){var p=new XMLHttpRequest;p.open("GET",s),p.responseType="blob",p.onload=function(){i(p.response,d,I)},p.onerror=function(){console.error("could not download file")},p.send()}function A(s){var d=new XMLHttpRequest;d.open("HEAD",s,!1);try{d.send()}catch{}return 200<=d.status&&299>=d.status}function T(s){try{s.dispatchEvent(new MouseEvent("click"))}catch{var d=document.createEvent("MouseEvents");d.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),s.dispatchEvent(d)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof ot=="object"&&ot.global===ot?ot:void 0,D=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),i=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!D?function(s,d,I){var p=o.URL||o.webkitURL,C=document.createElement("a");d=d||s.name||"download",C.download=d,C.rel="noopener",typeof s=="string"?(C.href=s,C.origin===location.origin?T(C):A(C.href)?a(s,d,I):T(C,C.target="_blank")):(C.href=p.createObjectURL(s),setTimeout(function(){p.revokeObjectURL(C.href)},4e4),setTimeout(function(){T(C)},0))}:"msSaveOrOpenBlob"in navigator?function(s,d,I){if(d=d||s.name||"download",typeof s!="string")navigator.msSaveOrOpenBlob(h(s,I),d);else if(A(s))a(s,d,I);else{var p=document.createElement("a");p.href=s,p.target="_blank",setTimeout(function(){T(p)})}}:function(s,d,I,p){if(p=p||open("","_blank"),p&&(p.document.title=p.document.body.innerText="downloading..."),typeof s=="string")return a(s,d,I);var C=s.type==="application/octet-stream",W=/constructor/i.test(o.HTMLElement)||o.safari,y=/CriOS\/[\d]+/.test(navigator.userAgent);if((y||C&&W||D)&&typeof FileReader<"u"){var S=new FileReader;S.onloadend=function(){var M=S.result;M=y?M:M.replace(/^data:[^;]*;/,"data:attachment/file;"),p?p.location.href=M:location=M,p=null},S.readAsDataURL(s)}else{var U=o.URL||o.webkitURL,N=U.createObjectURL(s);p?p.location=N:location.href=N,p=null,setTimeout(function(){U.revokeObjectURL(N)},4e4)}});o.saveAs=i.saveAs=i,F.exports=i})}(nt)),nt.exports}var xe=ye();const ke={setup(){const F=mt(),t=u([]),h=u(!1),a=u(!1),A=u(null),T=u([]),o=u(!1),D=u(!1),i=u(!1),s=u(null),d=u(""),I=u(""),p=u(""),C=u(""),W=u(""),y=u(""),S=u(""),U=u(""),N=u(""),M=u("asc"),P=u({ta_id:"",date:"",from_origin:"",document_type:"",attention:"",company:"",address:"",state:"",awb_reg:"",expeditur:"",receiver_name:"",receive_date:null,ras_status:"",description:"",remarks:""}),O=u(1),vt=u(10),Q=u(1),pt=u(0);let lt=null;const st=u(null),rt=u(null),Z=()=>{lt&&clearTimeout(lt),lt=setTimeout(()=>{O.value=1,H()},1200)},ht=n=>{N.value===n?M.value=M.value==="asc"?"desc":"asc":(N.value=n,M.value="asc"),Z()},H=async()=>{var n,b;try{h.value=!0,A.value=null;const r={page:O.value,limit:vt.value};I.value&&(r.start_date=I.value),p.value&&(r.end_date=p.value),d.value&&(r.ta_id=d.value),C.value&&(r.from_origin=C.value),W.value&&(r.description=W.value),y.value&&(r.company=y.value),S.value&&(r.ras_status=S.value),U.value&&(r.created_by=U.value),N.value&&(r.sort_by=N.value,r.sort_order=M.value);const x=await z.get(`${j}/transmittal`,{params:r,headers:{Authorization:`Bearer ${F.token}`}});t.value=x.data.items||[],Q.value=x.data.totalPages||1,pt.value=x.data.totalCount||0}catch(r){A.value=((b=(n=r.response)==null?void 0:n.data)==null?void 0:b.error)||"Failed to load data",console.error("Fetch Error:",r)}finally{h.value=!1}},Ct=async()=>{try{h.value=!0;const n={page:1,limit:1e4};I.value&&(n.start_date=I.value),d.value&&(n.ta_id=d.value),C.value&&(n.from_origin=C.value),W.value&&(n.description=W.value),y.value&&(n.company=y.value),S.value&&(n.ras_status=S.value),U.value&&(n.created_by=U.value),N.value&&(n.sort_by=N.value,n.sort_order=M.value);const r=(await z.get(`${j}/transmittal`,{params:n,headers:{Authorization:`Bearer ${F.token}`}})).data.items||[];if(r.length===0){alert("Tidak ada data yang sesuai filter untuk diekspor.");return}const x=new Jt.Workbook,c=x.addWorksheet("Transmittal Data");c.addRow(["TA ID","Date","From Origin","Description","Company","Status","Address","State","Attention","AWB/Reg","Expeditur","Receiver Name","Receive Date","Remarks"]),c.getRow(1).eachCell(v=>{v.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFD3D3D3"}},v.font={bold:!0},v.alignment={vertical:"middle",horizontal:"center",wrapText:!0},v.border={style:"thin"}});const E=v=>{if(!v)return"";const R=new Date(v);return`${R.getDate()}/${R.getMonth()+1}/${R.getFullYear()}`};r.forEach(v=>{c.addRow([v.ta_id,E(v.date),v.from_origin,v.description,v.company,v.ras_status,v.address,v.state,v.attention,v.awb_reg,v.expeditur,v.receiver_name,E(v.receive_date),v.remarks])}),c.columns.forEach(v=>{let R=10;v.eachCell({includeEmpty:!0},G=>{if(G.value){const q=G.value.toString().length;q>R&&(R=q)}}),v.width=R<20?20:R});const B=await x.xlsx.writeBuffer(),X=`Transmittal_Data_${new Date().toISOString().split("T")[0]}.xlsx`;xe.saveAs(new Blob([B]),X)}catch(n){console.error("Export Excel gagal:",n),alert("Gagal mengekspor data ke Excel.")}finally{h.value=!1}},_t=n=>["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"][n-1]||"",Tt=async n=>{var b,r;if(!n)return alert("TA ID tidak valid.");try{const c=(await z.get(`${j}/transmittal`,{params:{ta_id:n},headers:{Authorization:`Bearer ${F.token}`}})).data.data;if(!c)throw new Error("Data tidak ditemukan.");const l=new kt({compress:!0,unit:"mm",format:"a4"}),E=new Image;E.src=Yt,E.onload=()=>{l.addImage(E,"PNG",15,15,30,12),l.setFontSize(16).setFont(void 0,"bold"),l.text("TRANSMITTAL ADVICE",105,22,{align:"center"});const B=new Date(c.date),X=_t(B.getMonth()+1),v=B.getFullYear();l.setFontSize(10).setFont(void 0,"normal"),l.text(`No: ${c.ta_id}/${X}/${v}`,105,28,{align:"center"}),l.text(`TA Date: ${bt(c.date)}`,160,28),l.setDrawColor(0),l.line(15,30,195,30),l.setFont(void 0,"bold").setFontSize(10),l.text("PT. TRANSKON JAYA",15,36),l.setFont(void 0,"normal"),l.text(`Attention: ${c.attention||"Account Payable"}`,15,42),l.text(`Company: ${c.company}`,15,48),l.text(`Dept. of Origin: ${c.from_origin}`,15,54);const R="Address : ",G=c.address||"",q=120,it=36,Ot=q+l.getTextWidth(R),tt=l.splitTextToSize(G,70-l.getTextWidth(R));l.text(R+tt[0],q,it);for(let Y=1;Y<tt.length;Y++)l.text(tt[Y],Ot,it+Y*5);const Ht=it+tt.length*5;l.text(`City/State: ${c.state}`,q,Ht),l.line(15,58,195,58),l.text("Undercover this transmittal, We are forwarding you the following:",15,64);const Wt=[["1",(c.description||"").split(",").map(Y=>Y.trim()).filter(Y=>Y).join(", "),c.remarks||""]];qt(l,{head:[["No.","Document Description","Remarks"]],body:Wt,startY:68,theme:"grid",styles:{fontSize:9},headStyles:{fillColor:[51,51,51],textColor:[255,255,255],halign:"center",fontStyle:"bold"},columnStyles:{0:{halign:"center",cellWidth:10},1:{cellWidth:130},2:{cellWidth:40}}});const et=l.lastAutoTable.finalY+100;l.text("Received By:",15,et+60),l.text("Date:",15,et+90),l.setFontSize(8),l.text("Please Acknowledge Receipt by returning the copy of this Transmittal to PT. Transkon Jaya",15,et+95),l.text("or Return by Fax (0542) 770403",15,et+100);const dt=document.createElement("a");dt.href=URL.createObjectURL(l.output("blob")),dt.download=`Transmittal_${c.ta_id}.pdf`,dt.click()}}catch(x){alert("Gagal mengunduh PDF: "+(((r=(b=x.response)==null?void 0:b.data)==null?void 0:r.error)||x.message))}},It=async n=>{var b,r;if(!n)return alert("TA ID tidak valid.");try{const c=(await z.get(`${j}/transmittal`,{params:{ta_id:n},headers:{Authorization:`Bearer ${F.token}`}})).data.data;if(!c)throw new Error("Data tidak ditemukan.");const l=new kt({unit:"mm",format:"a4"}),E=20,B=20,X=170;l.rect(E,B,X,60),l.setFont(void 0,"bold").setFontSize(12),l.text(`To : ${c.company||""}`,E+3,B+8),l.setFontSize(10),l.text("Attn :",E+3,B+18),l.setFont(void 0,"normal"),l.text(c.attention||"",E+25,B+18),l.setFont(void 0,"bold"),l.text("Address:",E+3,B+28);const v=l.splitTextToSize(c.address||"",X-25);v.length>0&&l.text(v[0],E+25,B+28);for(let G=1;G<v.length;G++)l.text(v[G],E+25,B+28+G*5);const R=B+28+v.length*5;l.text(c.state||"",E+25,R),l.setFont(void 0,"bold"),l.text("Phone :",E+3,R+10),l.setFont(void 0,"normal"),l.text("",E+25,R+10),l.save(`Address_${c.company}.pdf`)}catch(x){alert("Gagal unduh alamat: "+(((r=(b=x.response)==null?void 0:b.data)==null?void 0:r.error)||x.message))}},Ft=async n=>{const b=n.target.value;if(b.length<2){T.value=[];return}try{const r=await z.get(`${j}/customers_dropdown`,{params:{search:b},headers:{Authorization:`Bearer ${F.token}`}});T.value=r.data.data||[]}catch{T.value=[]}},At=n=>{P.value.company=n.name,P.value.address=n.address||"",P.value.state=n.state||"",T.value=[]},St=async()=>{var n,b;try{h.value=!0;const x=(await Et()).number,c="TRJA"+String(x).padStart(4,"0");P.value={ta_id:c,date:"",from_origin:"",document_type:"",attention:"",company:"",address:"",state:"",awb_reg:"",expeditur:"",receiver_name:"",receive_date:null,ras_status:"",description:"",remarks:""},i.value=!1,o.value=!0}catch(r){A.value=((b=(n=r.response)==null?void 0:n.data)==null?void 0:b.error)||"Failed to generate new TA ID",console.error("Generate ID Error:",r)}finally{h.value=!1}},Et=async()=>(await z.get(`${j}/get-next-ta-id`,{headers:{Authorization:`Bearer ${F.token}`}})).data,Ut=async n=>{var b,r;try{h.value=!0;const c=(await z.get(`${j}/transmittal`,{params:{ta_id:n},headers:{Authorization:`Bearer ${F.token}`}})).data.data;P.value={...c,receive_date:c.receive_date||null},i.value=!0,o.value=!0}catch(x){A.value="Gagal muat data: "+(((r=(b=x.response)==null?void 0:b.data)==null?void 0:r.error)||x.message)}finally{h.value=!1}},gt=()=>{o.value=!1,P.value={ta_id:"",date:"",from_origin:"",document_type:"",attention:"",company:"",address:"",state:"",awb_reg:"",expeditur:"",receiver_name:"",receive_date:null,ras_status:"",description:"",remarks:""}},Rt=async()=>{var n,b;try{a.value=!0,P.value.receive_date===""&&(P.value.receive_date=null);const r=i.value?"put":"post",x=i.value?{ta_id:P.value.ta_id}:{},c=await z[r](`${j}/transmittal`,P.value,{params:x,headers:{Authorization:`Bearer ${F.token}`,"Content-Type":"application/json"}});if(c.data.status===200||c.data.status===201)gt(),H();else throw new Error(c.data.error||"Simpan gagal")}catch(r){A.value=((b=(n=r.response)==null?void 0:n.data)==null?void 0:b.error)||r.message}finally{a.value=!1}},Vt=n=>{s.value=n,D.value=!0},Mt=async()=>{var n,b;try{a.value=!0,await z.delete(`${j}/transmittal`,{params:{ta_id:s.value},headers:{Authorization:`Bearer ${F.token}`}}),D.value=!1,H()}catch(r){A.value="Hapus gagal: "+(((b=(n=r.response)==null?void 0:n.data)==null?void 0:b.error)||r.message)}finally{a.value=!1}},Pt=()=>{O.value<Q.value&&(O.value++,H())},Nt=()=>{O.value>1&&(O.value--,H())},Bt=n=>{O.value=n,H()},Lt=()=>{O.value=1,H()},bt=n=>n?new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-",zt=n=>({Pending:"badge bg-warning",Received:"badge bg-info",Completed:"badge bg-success"})[n]||"badge bg-secondary",jt=wt(()=>{const n=[];let r=Math.max(1,O.value-2),x=Math.min(Q.value,r+5-1);x-r+1<5&&(r=Math.max(1,x-5+1));for(let c=r;c<=x;c++)n.push(c);return n});return ft(async()=>{try{if(await Gt(),typeof $>"u"){console.warn("jQuery tidak tersedia. Datepicker tidak akan diinisialisasi."),H();return}H(),st.value&&$(st.value).datepicker({format:"yyyy-mm-dd",autoclose:!0,language:"id",todayHighlight:!0,clearBtn:!0}).on("changeDate",function(){I.value=$(this).datepicker("getFormattedDate"),Z()}),rt.value&&$(rt.value).datepicker({format:"yyyy-mm-dd",autoclose:!0,language:"id",todayHighlight:!0,clearBtn:!0}).on("changeDate",function(){p.value=$(this).datepicker("getFormattedDate"),Z()})}catch(n){A.value="Inisialisasi gagal: "+n.message,console.error(n)}}),{transmittals:t,loading:h,error:A,submitting:a,customers:T,showModal:o,isEditing:i,showDeleteModal:D,deleteTaId:s,formData:P,filterTaId:d,filterStartDate:I,filterEndDate:p,filterFromOrigin:C,filterNoInv:W,filterCompany:y,filterStatus:S,filterCreatedBy:U,startDateInput:st,endDateInput:rt,sortData:ht,sortColumn:N,sortDirection:M,currentPage:O,itemsPerPage:vt,totalPages:Q,totalCount:pt,visiblePages:jt,fetchTransmittals:H,openAddModal:St,openEditModal:Ut,submitForm:Rt,downloadPdf:Tt,downloadAddress:It,exportExcel:Ct,confirmDelete:Vt,deleteTransmittal:Mt,closeModal:gt,nextPage:Pt,prevPage:Nt,goToPage:Bt,resetPagination:Lt,applyFilters:Z,formatDate:bt,statusBadgeClass:zt,handleCompanyInput:Ft,selectCustomer:At}}},De={class:"container-fluid"},we={class:"card border-0 shadow"},he={class:"card-header bg-black text-white"},Ce={class:"d-flex justify-content-between align-items-center"},_e=["disabled"],Te=["disabled"],Ie=["disabled"],Fe={class:"card-body"},Ae={class:"d-flex align-items-center gap-2 mb-2"},Se={key:0,class:"alert alert-danger alert-dismissible fade show mb-4"},Ee={key:1,class:"text-center py-5"},Ue={key:2,class:"text-center py-5"},Re={key:3},Ve={class:"table-responsive"},Me={class:"table table-hover table-bordered"},Pe={class:"table-light"},Ne={class:"mt-1"},Be={key:0,class:"text-muted"},Le={class:"mt-1"},ze={key:0,class:"text-muted"},je={class:"mt-1"},Oe={key:0,class:"text-muted"},He={class:"mt-1"},We={key:0,class:"text-muted"},Ge={class:"mt-1"},Ye={key:0,class:"text-muted"},Xe={class:"mt-1"},qe={key:0,class:"text-muted"},Je={class:"text-center"},Ke={class:"d-flex justify-content-center gap-2"},Qe=["onClick"],Ze=["onClick"],$e=["onClick"],ta=["onClick"],ea={class:"d-flex justify-content-between align-items-center mt-4"},aa={class:"text-muted"},oa={class:"pagination pagination-sm"},na=["onClick"],la={class:"form-group mb-0",style:{width:"120px"}},sa={class:"modal-content border-0 shadow"},ra={class:"modal-header bg-black text-white"},ia={class:"modal-title"},da={class:"modal-body"},ua={class:"row g-3"},ca={class:"col-md-6"},ma=["readonly","placeholder"],fa={class:"col-md-6"},va={class:"col-md-6"},pa={class:"col-md-6"},ga={class:"col-md-6 position-relative"},ba={key:0,class:"list-group mt-1",style:{position:"absolute","z-index":"1000",width:"calc(100% - 2px)","max-height":"200px","overflow-y":"auto"}},ya=["onClick"],xa={class:"col-md-6"},ka={class:"col-md-6"},Da={class:"col-md-6"},wa={class:"col-md-6"},ha={class:"col-md-12"},Ca={class:"col-md-6"},_a={class:"col-md-6"},Ta={class:"col-md-6"},Ia={class:"col-md-6"},Fa={class:"col-md-6"},Aa={class:"modal-footer border-top-0 mt-4"},Sa=["disabled"],Ea={key:0,class:"spinner-border spinner-border-sm me-1"},Ua={class:"modal-content border-0 shadow"},Ra={class:"modal-header bg-danger text-white"},Va={class:"modal-body"},Ma={class:"modal-footer border-top-0"},Pa=["disabled"],Na={key:0,class:"spinner-border spinner-border-sm me-1"};function Ba(F,t,h,a,A,T){return f(),m("div",De,[e("div",we,[e("div",he,[e("div",Ce,[t[62]||(t[62]=e("h3",{class:"mb-0"},"Transmittal Management",-1)),e("div",null,[e("button",{onClick:t[0]||(t[0]=(...o)=>a.openAddModal&&a.openAddModal(...o)),class:"btn btn-sm btn-light me-2",disabled:a.loading},t[59]||(t[59]=[e("i",{class:"fas fa-plus me-1"},null,-1),_(" Add New ")]),8,_e),e("button",{onClick:t[1]||(t[1]=(...o)=>a.fetchTransmittals&&a.fetchTransmittals(...o)),class:"btn btn-sm btn-light me-2",disabled:a.loading},[e("i",{class:L(["fas fa-sync",{"fa-spin":a.loading}])},null,2),t[60]||(t[60]=_(" Refresh "))],8,Te),e("button",{onClick:t[2]||(t[2]=(...o)=>a.exportExcel&&a.exportExcel(...o)),class:"btn btn-sm btn-success",disabled:a.loading},[t[61]||(t[61]=e("i",{class:"fas fa-file-excel me-1"},null,-1)),_(" "+w(a.loading?"Downloading...":"Download All to Excel"),1)],8,Ie)])])]),e("div",Fe,[e("div",Ae,[g(e("input",{ref:"startDateInput",type:"text","onUpdate:modelValue":t[3]||(t[3]=o=>a.filterStartDate=o),class:"form-control form-control-sm datepicker",placeholder:"Start",onChange:t[4]||(t[4]=(...o)=>a.applyFilters&&a.applyFilters(...o)),style:{"max-width":"120px"}},null,544),[[k,a.filterStartDate]]),g(e("input",{ref:"endDateInput",type:"text","onUpdate:modelValue":t[5]||(t[5]=o=>a.filterEndDate=o),class:"form-control form-control-sm datepicker",placeholder:"End",onChange:t[6]||(t[6]=(...o)=>a.applyFilters&&a.applyFilters(...o)),style:{"max-width":"120px"}},null,544),[[k,a.filterEndDate]])]),a.error?(f(),m("div",Se,[t[63]||(t[63]=e("strong",null,"Error:",-1)),_(" "+w(a.error)+" ",1),e("button",{type:"button",class:"btn-close",onClick:t[7]||(t[7]=o=>a.error=null)})])):V("",!0),a.loading&&!a.showModal?(f(),m("div",Ee,t[64]||(t[64]=[e("div",{class:"spinner-border text-primary",role:"status"},null,-1),e("p",{class:"mt-2"},"Loading transmittals...",-1)]))):a.transmittals.length===0&&!a.loading?(f(),m("div",Ue,[t[66]||(t[66]=e("i",{class:"fas fa-database fa-3x text-muted mb-3"},null,-1)),t[67]||(t[67]=e("h5",null,"No Transmittals Found",-1)),t[68]||(t[68]=e("p",{class:"text-muted"},"There are no transmittal records available",-1)),e("button",{onClick:t[8]||(t[8]=(...o)=>a.openAddModal&&a.openAddModal(...o)),class:"btn btn-primary me-2"},t[65]||(t[65]=[e("i",{class:"fas fa-plus me-1"},null,-1),_(" Create New ")]))])):(f(),m("div",Re,[e("div",Ve,[e("table",Me,[e("thead",Pe,[e("tr",null,[e("th",{onClick:t[11]||(t[11]=o=>a.sortData("ta_id")),style:{cursor:"pointer"}},[t[69]||(t[69]=_(" TA ID ")),e("div",Ne,[g(e("input",{"onUpdate:modelValue":t[9]||(t[9]=o=>a.filterTaId=o),type:"text",class:"form-control form-control-sm",placeholder:"Filter...",onInput:t[10]||(t[10]=(...o)=>a.applyFilters&&a.applyFilters(...o))},null,544),[[k,a.filterTaId]])]),a.sortColumn==="ta_id"?(f(),m("small",Be,[e("i",{class:L(["fas",a.sortDirection==="asc"?"fa-sort-up":"fa-sort-down"])},null,2)])):V("",!0)]),e("th",{onClick:t[14]||(t[14]=o=>a.sortData("date")),style:{cursor:"pointer"}},[t[70]||(t[70]=_(" Date ")),e("div",Le,[g(e("input",{ref:"startDateInput",type:"text","onUpdate:modelValue":t[12]||(t[12]=o=>a.filterStartDate=o),class:"form-control form-control-sm datepicker",placeholder:"Start",onChange:t[13]||(t[13]=(...o)=>a.applyFilters&&a.applyFilters(...o)),style:{"max-width":"120px"}},null,544),[[k,a.filterStartDate]])]),a.sortColumn==="date"?(f(),m("small",ze,[e("i",{class:L(["fas",a.sortDirection==="asc"?"fa-sort-up":"fa-sort-down"])},null,2)])):V("",!0)]),e("th",{onClick:t[17]||(t[17]=o=>a.sortData("from_origin")),style:{cursor:"pointer"}},[t[71]||(t[71]=_(" From Origin ")),e("div",je,[g(e("input",{"onUpdate:modelValue":t[15]||(t[15]=o=>a.filterFromOrigin=o),type:"text",class:"form-control form-control-sm",placeholder:"Filter...",onInput:t[16]||(t[16]=(...o)=>a.applyFilters&&a.applyFilters(...o))},null,544),[[k,a.filterFromOrigin]])]),a.sortColumn==="from_origin"?(f(),m("small",Oe,[e("i",{class:L(["fas",a.sortDirection==="asc"?"fa-sort-up":"fa-sort-down"])},null,2)])):V("",!0)]),e("th",{onClick:t[20]||(t[20]=o=>a.sortData("description")),style:{cursor:"pointer"}},[t[72]||(t[72]=_(" No. Inv ")),e("div",He,[g(e("input",{"onUpdate:modelValue":t[18]||(t[18]=o=>a.filterNoInv=o),type:"text",class:"form-control form-control-sm",placeholder:"Filter...",onInput:t[19]||(t[19]=(...o)=>a.applyFilters&&a.applyFilters(...o))},null,544),[[k,a.filterNoInv]])]),a.sortColumn==="description"?(f(),m("small",We,[e("i",{class:L(["fas",a.sortDirection==="asc"?"fa-sort-up":"fa-sort-down"])},null,2)])):V("",!0)]),e("th",{onClick:t[23]||(t[23]=o=>a.sortData("company")),style:{cursor:"pointer"}},[t[73]||(t[73]=_(" Company ")),e("div",Ge,[g(e("input",{"onUpdate:modelValue":t[21]||(t[21]=o=>a.filterCompany=o),type:"text",class:"form-control form-control-sm",placeholder:"Filter...",onInput:t[22]||(t[22]=(...o)=>a.applyFilters&&a.applyFilters(...o))},null,544),[[k,a.filterCompany]])]),a.sortColumn==="company"?(f(),m("small",Ye,[e("i",{class:L(["fas",a.sortDirection==="asc"?"fa-sort-up":"fa-sort-down"])},null,2)])):V("",!0)]),e("th",{onClick:t[26]||(t[26]=o=>a.sortData("created_by")),style:{cursor:"pointer"}},[t[74]||(t[74]=_(" Created by ")),e("div",Xe,[g(e("input",{"onUpdate:modelValue":t[24]||(t[24]=o=>a.filterCreatedBy=o),type:"text",class:"form-control form-control-sm",placeholder:"Filter...",onInput:t[25]||(t[25]=(...o)=>a.applyFilters&&a.applyFilters(...o))},null,544),[[k,a.filterCreatedBy]])]),a.sortColumn==="created_by"?(f(),m("small",qe,[e("i",{class:L(["fas",a.sortDirection==="asc"?"fa-sort-up":"fa-sort-down"])},null,2)])):V("",!0)]),t[75]||(t[75]=e("th",{class:"text-center align-middle",style:{"vertical-align":"middle !important","text-align":"center"}},"Actions",-1)),t[76]||(t[76]=e("th",{class:"text-center align-middle",style:{"vertical-align":"middle !important","text-align":"center"}},"Download",-1)),t[77]||(t[77]=e("th",{class:"text-center align-middle",style:{"vertical-align":"middle !important","text-align":"center"}},"Address",-1))])]),e("tbody",null,[(f(!0),m(J,null,K(a.transmittals,o=>(f(),m("tr",{key:o.ta_id},[e("td",null,[e("code",null,w(o.ta_id),1)]),e("td",null,w(a.formatDate(o.date)),1),e("td",null,w(o.from_origin),1),e("td",null,w(o.description),1),e("td",null,w(o.company),1),e("td",null,w(o.created_by),1),e("td",Je,[e("div",Ke,[e("button",{onClick:D=>a.openEditModal(o.ta_id),class:"btn btn-sm btn-warning"},t[78]||(t[78]=[e("i",{class:"fas fa-edit"},null,-1)]),8,Qe),e("button",{onClick:D=>a.confirmDelete(o.ta_id),class:"btn btn-sm btn-danger"},t[79]||(t[79]=[e("i",{class:"fas fa-trash"},null,-1)]),8,Ze)])]),e("td",null,[e("button",{onClick:D=>a.downloadPdf(o.ta_id),class:"btn btn-sm btn-light"},t[80]||(t[80]=[e("i",{class:"fas fa-download me-1"},null,-1),_(" pdf ")]),8,$e)]),e("td",null,[e("button",{onClick:D=>a.downloadAddress(o.ta_id),class:"btn btn-sm btn-light"},t[81]||(t[81]=[e("i",{class:"fas fa-download me-1"},null,-1),_(" adr ")]),8,ta)])]))),128))])])]),e("div",ea,[e("div",aa," Page "+w(a.currentPage)+" of "+w(a.totalPages)+" ("+w(a.totalCount)+" records) ",1),e("nav",null,[e("ul",oa,[e("li",{class:L(["page-item",{disabled:a.currentPage===1}])},[e("button",{class:"page-link",onClick:t[27]||(t[27]=(...o)=>a.prevPage&&a.prevPage(...o))},"Â«")],2),(f(!0),m(J,null,K(a.visiblePages,o=>(f(),m("li",{key:o,class:L(["page-item",{active:o===a.currentPage}])},[e("button",{class:"page-link",onClick:D=>a.goToPage(o)},w(o),9,na)],2))),128)),e("li",{class:L(["page-item",{disabled:a.currentPage===a.totalPages}])},[e("button",{class:"page-link",onClick:t[28]||(t[28]=(...o)=>a.nextPage&&a.nextPage(...o))},"Â»")],2)])]),e("div",la,[g(e("select",{"onUpdate:modelValue":t[29]||(t[29]=o=>a.itemsPerPage=o),class:"form-select form-select-sm",onChange:t[30]||(t[30]=(...o)=>a.resetPagination&&a.resetPagination(...o))},t[82]||(t[82]=[e("option",{value:"10"},"10 / page",-1),e("option",{value:"25"},"25 / page",-1),e("option",{value:"50"},"50 / page",-1)]),544),[[yt,a.itemsPerPage]])])])]))])]),a.showModal?(f(),m("div",{key:0,class:"modal fade show d-block",style:{"z-index":"1050",background:"rgba(0,0,0,0.5)"},onClick:t[53]||(t[53]=(...o)=>a.closeModal&&a.closeModal(...o))},[e("div",{class:"modal-dialog modal-dialog-centered modal-lg",onClick:t[52]||(t[52]=ut(()=>{},["stop"]))},[e("div",sa,[e("div",ra,[e("h5",ia,w(a.isEditing?"Edit Transmittal":"Add New Transmittal"),1),e("button",{type:"button",class:"btn-close btn-close-white",onClick:t[31]||(t[31]=(...o)=>a.closeModal&&a.closeModal(...o))})]),e("div",da,[e("form",{onSubmit:t[51]||(t[51]=ut((...o)=>a.submitForm&&a.submitForm(...o),["prevent"]))},[e("div",ua,[e("div",ca,[t[83]||(t[83]=e("label",{class:"form-label"},"TA ID",-1)),g(e("input",{"onUpdate:modelValue":t[32]||(t[32]=o=>a.formData.ta_id=o),type:"text",class:"form-control",readonly:a.isEditing,placeholder:a.isEditing?"":"Auto-generated on save",required:""},null,8,ma),[[k,a.formData.ta_id]])]),e("div",fa,[t[84]||(t[84]=e("label",{class:"form-label"},[_("Date "),e("span",{class:"text-danger"},"*")],-1)),g(e("input",{"onUpdate:modelValue":t[33]||(t[33]=o=>a.formData.date=o),type:"date",class:"form-control",required:""},null,512),[[k,a.formData.date]])]),e("div",va,[t[85]||(t[85]=e("label",{class:"form-label"},[_("From Origin "),e("span",{class:"text-danger"},"*")],-1)),g(e("input",{"onUpdate:modelValue":t[34]||(t[34]=o=>a.formData.from_origin=o),type:"text",class:"form-control",required:""},null,512),[[k,a.formData.from_origin]])]),e("div",pa,[t[86]||(t[86]=e("label",{class:"form-label"},"Document Type",-1)),g(e("input",{"onUpdate:modelValue":t[35]||(t[35]=o=>a.formData.document_type=o),type:"text",class:"form-control"},null,512),[[k,a.formData.document_type]])]),e("div",ga,[t[87]||(t[87]=e("label",{class:"form-label"},"Company",-1)),g(e("input",{"onUpdate:modelValue":t[36]||(t[36]=o=>a.formData.company=o),type:"text",class:"form-control",onInput:t[37]||(t[37]=(...o)=>a.handleCompanyInput&&a.handleCompanyInput(...o)),onBlur:t[38]||(t[38]=o=>a.customers.value=[]),placeholder:"Ketik untuk cari customer"},null,544),[[k,a.formData.company]]),a.customers.length>0?(f(),m("ul",ba,[(f(!0),m(J,null,K(a.customers,o=>(f(),m("li",{key:o.name,class:"list-group-item list-group-item-action",onClick:D=>a.selectCustomer(o),style:{cursor:"pointer"}},w(o.name)+" - "+w(o.address||"No address"),9,ya))),128))])):V("",!0)]),e("div",xa,[t[88]||(t[88]=e("label",{class:"form-label"},"Attention",-1)),g(e("input",{"onUpdate:modelValue":t[39]||(t[39]=o=>a.formData.attention=o),type:"text",class:"form-control"},null,512),[[k,a.formData.attention]])]),e("div",ka,[t[89]||(t[89]=e("label",{class:"form-label"},"Address",-1)),g(e("textarea",{"onUpdate:modelValue":t[40]||(t[40]=o=>a.formData.address=o),rows:"2",class:"form-control"},null,512),[[k,a.formData.address]])]),e("div",Da,[t[90]||(t[90]=e("label",{class:"form-label"},"State",-1)),g(e("input",{"onUpdate:modelValue":t[41]||(t[41]=o=>a.formData.state=o),type:"text",class:"form-control"},null,512),[[k,a.formData.state]])]),e("div",wa,[t[91]||(t[91]=e("label",{class:"form-label"},"Description",-1)),g(e("input",{"onUpdate:modelValue":t[42]||(t[42]=o=>a.formData.description=o),type:"text",class:"form-control"},null,512),[[k,a.formData.description]])]),e("div",ha,[t[92]||(t[92]=e("label",{class:"form-label"},"Remarks",-1)),g(e("textarea",{"onUpdate:modelValue":t[43]||(t[43]=o=>a.formData.remarks=o),rows:"2",class:"form-control"},null,512),[[k,a.formData.remarks]])]),e("div",Ca,[t[93]||(t[93]=e("label",{class:"form-label"},"AWB/Reg",-1)),g(e("input",{"onUpdate:modelValue":t[44]||(t[44]=o=>a.formData.awb_reg=o),type:"text",class:"form-control"},null,512),[[k,a.formData.awb_reg]])]),e("div",_a,[t[94]||(t[94]=e("label",{class:"form-label"},"Expeditur",-1)),g(e("input",{"onUpdate:modelValue":t[45]||(t[45]=o=>a.formData.expeditur=o),type:"text",class:"form-control"},null,512),[[k,a.formData.expeditur]])]),e("div",Ta,[t[95]||(t[95]=e("label",{class:"form-label"},"Receiver Name",-1)),g(e("input",{"onUpdate:modelValue":t[46]||(t[46]=o=>a.formData.receiver_name=o),type:"text",class:"form-control"},null,512),[[k,a.formData.receiver_name]])]),e("div",Ia,[t[96]||(t[96]=e("label",{class:"form-label"},"Receive Date (Optional)",-1)),g(e("input",{"onUpdate:modelValue":t[47]||(t[47]=o=>a.formData.receive_date=o),type:"date",class:"form-control",onInput:t[48]||(t[48]=(...o)=>F.handleReceiveDateInput&&F.handleReceiveDateInput(...o))},null,544),[[k,a.formData.receive_date]])]),e("div",Fa,[t[98]||(t[98]=e("label",{class:"form-label"},"Status",-1)),g(e("select",{"onUpdate:modelValue":t[49]||(t[49]=o=>a.formData.ras_status=o),class:"form-select"},t[97]||(t[97]=[e("option",{value:""},"-- Pilih Status --",-1),e("option",{value:"Pending"},"Pending",-1),e("option",{value:"Received"},"Received",-1),e("option",{value:"Completed"},"Completed",-1)]),512),[[yt,a.formData.ras_status]])])]),e("div",Aa,[e("button",{type:"button",class:"btn btn-secondary",onClick:t[50]||(t[50]=(...o)=>a.closeModal&&a.closeModal(...o))},"Cancel"),e("button",{type:"submit",class:"btn btn-primary",disabled:a.submitting},[a.submitting?(f(),m("span",Ea)):V("",!0),_(" "+w(a.isEditing?"Update":"Create"),1)],8,Sa)])],32)])])])])):V("",!0),a.showDeleteModal?(f(),m("div",{key:1,class:"modal fade show d-block",style:{"z-index":"1060",background:"rgba(0,0,0,0.5)"},onClick:t[58]||(t[58]=o=>a.showDeleteModal=!1)},[e("div",{class:"modal-dialog modal-dialog-centered",onClick:t[57]||(t[57]=ut(()=>{},["stop"]))},[e("div",Ua,[e("div",Ra,[t[99]||(t[99]=e("h5",{class:"modal-title"},"Confirm Delete",-1)),e("button",{type:"button",class:"btn-close btn-close-white",onClick:t[54]||(t[54]=o=>a.showDeleteModal=!1)})]),e("div",Va,[t[101]||(t[101]=e("p",null,"Are you sure you want to delete this transmittal?",-1)),e("p",null,[t[100]||(t[100]=e("strong",null,"TA ID:",-1)),_(" "+w(a.deleteTaId),1)]),t[102]||(t[102]=e("p",{class:"text-danger"},"This action cannot be undone!",-1))]),e("div",Ma,[e("button",{type:"button",class:"btn btn-secondary",onClick:t[55]||(t[55]=o=>a.showDeleteModal=!1)},"Cancel"),e("button",{type:"button",class:"btn btn-danger",onClick:t[56]||(t[56]=(...o)=>a.deleteTransmittal&&a.deleteTransmittal(...o)),disabled:a.submitting},[a.submitting?(f(),m("span",Na)):V("",!0),t[103]||(t[103]=_(" Delete "))],8,Pa)])])])])):V("",!0)])}const La=ct(ke,[["render",Ba],["__scopeId","data-v-9ab90ed2"]]),za={key:0,class:"text-center py-5"},ja={key:1,class:"container-fluid px-3"},Oa={class:"d-flex justify-content-between align-items-center mb-3"},Ha={class:"text-muted mb-0"},Wa={class:"text-primary"},Ga={class:"text-end"},Ya={class:"fs-6 fw-bold"},Xa={class:"nav nav-tabs mb-4"},qa=["onClick"],Ja={class:"tab-content"},Ka={key:0,class:"tab-pane fade show active"},Qa={key:1,class:"tab-pane fade show active"},Za={key:2,class:"tab-pane fade show active text-center py-5"},$a={__name:"Dashboard",setup(F){const t=mt();u(null);const h=u(!0),a=u("0"),A=[{label:"Transmittal Management",value:"0"},{label:"Transmittal Invoice Internal",value:"1"},{label:"Coming Soon",value:"2"}],T=u(),o=()=>{const D=new Date,i=D.getHours().toString().padStart(2,"0"),s=D.getMinutes().toString().padStart(2,"0"),d=D.getSeconds().toString().padStart(2,"0");T.value=`${i}:${s}:${d}`};return ft(()=>{o(),setInterval(o,1e3),setTimeout(()=>{h.value=!1},800)}),(D,i)=>h.value?(f(),m("div",za,i[0]||(i[0]=[e("div",{class:"spinner-border text-primary"},null,-1),e("p",{class:"mt-2"},"Loading dashboard...",-1)]))):(f(),m("div",ja,[e("div",Oa,[e("div",null,[i[2]||(i[2]=e("h1",{class:"h3 fw-bold mb-1"},[e("i",{class:"fa-solid fa-business-time me-2"}),_(" Commercial Dashboard ")],-1)),e("p",Ha,[i[1]||(i[1]=_("Hi, ")),e("strong",Wa,w(Xt(t).name),1)])]),e("div",Ga,[e("div",Ya,w(T.value),1)])]),e("ul",Xa,[(f(),m(J,null,K(A,s=>e("li",{class:"nav-item",key:s.value},[e("button",{class:L(["nav-link",{active:a.value===s.value}]),onClick:d=>a.value=s.value},w(s.label),11,qa)])),64))]),e("div",Ja,[a.value==="0"?(f(),m("div",Ka,[xt(La)])):V("",!0),a.value==="1"?(f(),m("div",Qa,[xt(ge)])):V("",!0),a.value==="2"?(f(),m("div",Za,i[3]||(i[3]=[e("i",{class:"fa-solid fa-clock fa-3x text-muted mb-3"},null,-1),e("h4",null,"Feature Coming Soon",-1),e("p",{class:"text-muted"},"This section is under development.",-1)]))):V("",!0)])]))}},so=ct($a,[["__scopeId","data-v-3e5aa6dd"]]);export{so as default};
