import{_ as se,u as ne,r as m,o as R,y as L,I as oe,p as $,A as D,n as N,w as ie,c as n,a as e,q as B,h as f,t as u,F as c,j as p,b as v,k as b,z as P,s as ue,v as A,H as re,g as o}from"./index-BjyKRxJM.js";import{f as z,i as H}from"./id-CB5qm485.js";const de={class:"card border-0 shadow-sm"},ve={class:"card-header"},me={class:"d-flex justify-content-between align-items-center"},ce=["disabled"],pe={class:"card-body"},be={key:0,class:"alert alert-danger alert-dismissible fade show"},fe={key:1,class:"text-center py-5"},ge={key:2,class:"table-responsive"},ke={class:"table table-hover table-striped table-bordered mb-0"},ye={class:"table-dark"},_e=["onUpdate:modelValue","placeholder"],we={key:0},xe=["colspan"],he={class:"text-center"},Ce=["onClick"],Se={class:"text-center"},Be={class:"text-center"},Ue={class:"text-center"},Ie={class:"text-center"},Ve={class:"text-center"},$e={class:"text-center"},De={class:"text-center"},Pe={class:"btn-group btn-group-sm",role:"group"},je=["onClick"],Ee=["onClick"],Le={class:"d-flex flex-wrap justify-content-between align-items-center mt-3"},Ne={class:"d-flex align-items-center mb-2"},Ae=["value"],qe={class:"text-muted"},Fe={"aria-label":"Page navigation"},Ke={class:"pagination pagination-sm mb-0"},Te={class:"page-item disabled"},Oe={class:"page-link"},Me={key:0,class:"modal fade show d-block",style:{background:"rgba(0,0,0,0.5)"}},Re={class:"modal-dialog modal-dialog-centered modal-lg"},ze={class:"modal-content border-0 shadow"},He={class:"modal-header bg-danger text-white"},Je={class:"modal-title"},Ge={class:"modal-body"},Ye={class:"row g-3"},Qe={class:"col-md-6"},We=["disabled"],Xe={class:"col-md-6"},Ze={class:"col-md-6"},ea=["value"],aa={class:"col-md-6"},la={class:"col-md-6"},ta=["value"],sa={class:"col-md-6"},na=["value"],oa={class:"col-md-6"},ia=["value"],ua={class:"col-md-6"},ra=["value"],da={class:"col-md-6"},va=["value"],ma={class:"col-md-6"},ca=["value"],pa={class:"col-md-6"},ba=["value"],fa={class:"col-md-6"},ga=["value"],ka={class:"col-md-6"},ya=["value"],_a={class:"col-md-6"},wa=["value"],xa={class:"col-md-6"},ha=["value"],Ca={class:"modal-footer border-top-0"},Sa={type:"submit",class:"btn btn-danger"},Ba={key:1,class:"modal fade show d-block",style:{background:"rgba(0,0,0,0.5)"}},Ua={class:"modal-dialog modal-dialog-centered"},Ia={class:"modal-content border-0 shadow"},Va={class:"modal-body"},$a={__name:"Employee",setup(Da){const q=ne(),J=re(),d=m([]),t=m({departments:[],jabatan:[],placements:[],genders:["L","P"],locations:[],hub_placement:[],status:[],divisi:[],section:[],kepegawaian:[],klasifikasi:[],salary_code:[],id_company:[]}),j=m(null);let y=null;R(async()=>{await I(),await L(),y=z(j.value,{locale:H.Indonesian,dateFormat:"Y-m-d",allowInput:!0,onChange:(r,a)=>{s.value.dob=a}})}),oe(()=>{y&&y.destroy()});const U=m(!0),_=m(null),G=m(0),C=m(!1),g=m(!1),s=m({}),Y=m(-1),S=m(!1),h=m(null),w=m({username:"",name:"",department:"",jabatan:"",placement:"",gender:"",lokasi:""}),x=m(10),k=m(1),Q=[10,20,50,{value:-1,text:"All"}],F=[{text:"Id  ",value:"username",align:"center",sortable:!0,filterable:!0},{text:"Nama",value:"name",align:"center",sortable:!0,filterable:!0},{text:"Departemen",value:"department",align:"center",sortable:!0,filterable:!0},{text:"Position",value:"jabatan",align:"center",sortable:!0,filterable:!0},{text:"Penempatan",value:"placement",align:"center",sortable:!0,filterable:!0},{text:"Gender",value:"gender",align:"center",sortable:!0,filterable:!0},{text:"Lokasi",value:"lokasi",align:"center",sortable:!0,filterable:!0},{text:"Actions",value:"actions",align:"center",sortable:!1,filterable:!1}],I=async()=>{var r,a;try{U.value=!0;const l=await $.get(`${D}/users`,{headers:{Authorization:`Bearer ${q.token}`}});d.value=l.data,G.value=d.value.length,t.value.departments=[...new Set(d.value.map(i=>i.department).filter(Boolean))],t.value.jabatan=[...new Set(d.value.map(i=>i.jabatan).filter(Boolean))],t.value.placements=[...new Set(d.value.map(i=>i.placement).filter(Boolean))],t.value.locations=[...new Set(d.value.map(i=>i.lokasi).filter(Boolean))],t.value.site=[...new Set(d.value.map(i=>i.site).filter(Boolean))],t.value.hub_placement=[...new Set(d.value.map(i=>i.hub_placement).filter(Boolean))],t.value.status=[...new Set(d.value.map(i=>i.status).filter(Boolean))],t.value.divisi=[...new Set(d.value.map(i=>i.divisi).filter(Boolean))],t.value.section=[...new Set(d.value.map(i=>i.section).filter(Boolean))],t.value.kepegawaian=[...new Set(d.value.map(i=>i.kepegawaian).filter(Boolean))],t.value.klasifikasi=[...new Set(d.value.map(i=>i.klasifikasi).filter(Boolean))],t.value.salary_code=[...new Set(d.value.map(i=>i.salary_code).filter(Boolean))],t.value.id_company=[...new Set(d.value.map(i=>i.id_company).filter(Boolean))],U.value=!1}catch(l){_.value=((a=(r=l.response)==null?void 0:r.data)==null?void 0:a.message)||l.message,U.value=!1}};R(async()=>{await I()});const V=N(()=>d.value.filter(r=>Object.keys(w.value).every(a=>w.value[a]?String(r[a]).toLowerCase().includes(w.value[a].toLowerCase()):!0))),E=N(()=>{if(x.value===-1)return V.value;const r=(k.value-1)*x.value,a=r+x.value;return V.value.slice(r,a)}),K=N(()=>x.value===-1?1:Math.ceil(V.value.length/x.value)),W=()=>{s.value={username:"",name:"",dob:"",placement:t.value.placements[0]||"",gender:t.value.genders[0]||"L",lokasi:t.value.locations[0]||"",hub_placement:t.value.hub_placement[0]||"",status:t.value.status[0]||"",department:t.value.jabatan[0]||"",department:t.value.departments[0]||"",divisi:t.value.divisi[0]||"",section:t.value.section[0]||"",kepegawaian:t.value.kepegawaian[0]||"",klasifikasi:t.value.klasifikasi[0]||"",salary_code:t.value.salary_code[0]||"",klasifikasi:t.value.klasifikasi[0]||"",id_company:t.value.id_company[0]||"",site:t.value.site[0]||""},g.value=!0,L(()=>{y&&y.open()})},X=r=>{Y.value=d.value.findIndex(a=>a.username===r.username),s.value=JSON.parse(JSON.stringify(r)),C.value=!0},Z=async()=>{var r,a;try{const l={headers:{"Content-Type":"application/json",Authorization:`Bearer ${q.token}`}};g.value?(await $.post(`${D}/users`,s.value,l),g.value=!1):(await $.put(`${D}/users`,s.value,l),C.value=!1),s.value={},await I()}catch(l){l.response?_.value=`Error ${l.response.status}: ${((r=l.response.data)==null?void 0:r.error)||((a=l.response.data)==null?void 0:a.message)||l.message}`:l.request?_.value="No response received from server.":_.value=`Request Error: ${l.message}`,console.error("CRUD Error:",l)}},ee=r=>{h.value=r,S.value=!0},ae=async()=>{var r,a;try{await $.delete(`${D}/users?username=${h.value.username}`),S.value=!1,h.value=null,await I()}catch(l){_.value=((a=(r=l.response)==null?void 0:r.data)==null?void 0:a.message)||l.message,S.value=!1}},T=()=>{S.value=!1,h.value=null},O=()=>{C.value=!1,g.value=!1,s.value={}},le=r=>{J.push({name:"hr-absensi-detail",params:{username:r}})},te=()=>{Object.keys(w.value).forEach(r=>{w.value[r]=""}),k.value=1};return ie([g,C],async([r,a])=>{(r||a)&&(await L(),y&&y.destroy(),y=z(j.value,{locale:H.Indonesian,dateFormat:"Y-m-d",allowInput:!0,defaultDate:s.value.dob||null,onChange:(l,i)=>{s.value.dob=i}}))}),(r,a)=>(o(),n("div",de,[e("div",ve,[e("div",me,[a[22]||(a[22]=e("h3",{class:"mb-0"},"List Karyawan",-1)),e("div",null,[e("button",{onClick:te,class:"btn btn-sm btn-light me-2",disabled:!Object.values(w.value).some(Boolean)},a[20]||(a[20]=[e("i",{class:"fas fa-filter-circle-xmark me-1"},null,-1),f(" Reset Filters ")]),8,ce),e("button",{onClick:W,class:"btn btn-sm btn-danger"},a[21]||(a[21]=[e("i",{class:"fas fa-plus me-1"},null,-1),f(" Add New ")]))])])]),e("div",pe,[_.value?(o(),n("div",be,[f(u(_.value)+" ",1),e("button",{type:"button",class:"btn-close",onClick:a[0]||(a[0]=l=>_.value=null)})])):B("",!0),U.value?(o(),n("div",fe,a[23]||(a[23]=[e("div",{class:"spinner-border text-primary",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1),e("p",{class:"mt-2"},"Loading data...",-1)]))):(o(),n("div",ge,[e("table",ke,[e("thead",ye,[e("tr",null,[(o(),n(c,null,p(F,l=>e("th",{key:l.value,class:P(["text-center",{"filter-cell":l.filterable}])},[e("div",null,u(l.text),1),l.filterable?v((o(),n("input",{key:0,"onUpdate:modelValue":i=>w.value[l.value]=i,type:"text",class:"form-control form-control-sm mt-1 text-center",placeholder:`Filter ${l.text}`,onInput:a[1]||(a[1]=i=>k.value=1)},null,40,_e)),[[A,w.value[l.value]]]):B("",!0)],2)),64))])]),e("tbody",null,[E.value.length===0?(o(),n("tr",we,[e("td",{colspan:F.length,class:"text-center py-4"},"No data available",8,xe)])):B("",!0),(o(!0),n(c,null,p(E.value,(l,i)=>(o(),n("tr",{key:i,class:"align-middle"},[e("td",he,[e("a",{href:"javascript:void(0)",onClick:M=>le(l.username),class:"text-primary fw-semibold"},u(l.username),9,Ce)]),e("td",Se,u(l.name),1),e("td",Be,u(l.department),1),e("td",Ue,u(l.jabatan),1),e("td",Ie,u(l.placement),1),e("td",Ve,[e("span",{class:P(["badge",l.gender==="Laki-laki"?"bg-info":"bg-danger"])},u(l.gender),3)]),e("td",$e,u(l.lokasi),1),e("td",De,[e("div",Pe,[e("button",{onClick:M=>X(l),class:"btn btn-warning",title:"Edit"},a[24]||(a[24]=[e("i",{class:"fas fa-edit"},null,-1)]),8,je),e("button",{onClick:M=>ee(l),class:"btn btn-danger",title:"Delete",id:"confirm-text"},a[25]||(a[25]=[e("i",{class:"fas fa-trash-alt"},null,-1)]),8,Ee)])])]))),128))])])])),e("div",Le,[e("div",Ne,[v(e("select",{"onUpdate:modelValue":a[2]||(a[2]=l=>x.value=l),class:"form-select form-select-sm me-2",style:{width:"90px"},onChange:a[3]||(a[3]=l=>k.value=1)},[(o(),n(c,null,p(Q,l=>e("option",{key:l.value||l,value:l.value||l},u(l.text||l),9,Ae)),64))],544),[[b,x.value]]),e("small",qe," Showing "+u(E.value.length)+" of "+u(V.value.length)+" entries ",1)]),e("nav",Fe,[e("ul",Ke,[e("li",{class:P(["page-item",{disabled:k.value===1}])},[e("button",{class:"page-link",onClick:a[4]||(a[4]=l=>k.value--)},a[26]||(a[26]=[e("i",{class:"fas fa-chevron-left"},null,-1)]))],2),e("li",Te,[e("span",Oe," Page "+u(k.value)+" of "+u(K.value),1)]),e("li",{class:P(["page-item",{disabled:k.value===K.value}])},[e("button",{class:"page-link",onClick:a[5]||(a[5]=l=>k.value++)},a[27]||(a[27]=[e("i",{class:"fas fa-chevron-right"},null,-1)]))],2)])])])]),C.value||g.value?(o(),n("div",Me,[e("div",Re,[e("div",ze,[e("div",He,[e("h5",Je,u(g.value?"Tambah Karyawan Baru":"Edit Karyawan"),1),e("button",{type:"button",class:"btn-close btn-close-white",onClick:O})]),e("div",Ge,[e("form",{onSubmit:ue(Z,["prevent"])},[e("div",Ye,[e("div",Qe,[a[28]||(a[28]=e("label",{class:"form-label"},[f("NIK "),e("span",{class:"text-danger"},"*")],-1)),v(e("input",{"onUpdate:modelValue":a[6]||(a[6]=l=>s.value.username=l),type:"text",class:"form-control",disabled:!g.value,required:""},null,8,We),[[A,s.value.username]])]),e("div",Xe,[a[29]||(a[29]=e("label",{class:"form-label"},[f("Nama "),e("span",{class:"text-danger"},"*")],-1)),v(e("input",{"onUpdate:modelValue":a[7]||(a[7]=l=>s.value.name=l),type:"text",class:"form-control",required:""},null,512),[[A,s.value.name]])]),e("div",Ze,[a[30]||(a[30]=e("label",{class:"form-label"},"Tanggal Lahir",-1)),e("input",{ref_key:"dobInput",ref:j,type:"text",class:"form-control flatpickr-input",value:s.value.dob,placeholder:"Pilih tanggal"},null,8,ea)]),e("div",aa,[a[32]||(a[32]=e("label",{class:"form-label"},"Gender",-1)),v(e("select",{"onUpdate:modelValue":a[8]||(a[8]=l=>s.value.gender=l),class:"form-select",required:""},a[31]||(a[31]=[e("option",{value:"L"},"Laki-laki",-1),e("option",{value:"P"},"Perempuan",-1)]),512),[[b,s.value.gender]])]),e("div",la,[a[33]||(a[33]=e("label",{class:"form-label"},"Departemen",-1)),v(e("select",{"onUpdate:modelValue":a[9]||(a[9]=l=>s.value.department=l),class:"form-select",required:""},[(o(!0),n(c,null,p(t.value.departments,l=>(o(),n("option",{value:l},u(l),9,ta))),256))],512),[[b,s.value.department]])]),e("div",sa,[a[34]||(a[34]=e("label",{class:"form-label"},"Jabatan",-1)),v(e("select",{"onUpdate:modelValue":a[10]||(a[10]=l=>s.value.jabatan=l),class:"form-select",required:""},[(o(!0),n(c,null,p(t.value.jabatan,l=>(o(),n("option",{value:l},u(l),9,na))),256))],512),[[b,s.value.jabatan]])]),e("div",oa,[a[35]||(a[35]=e("label",{class:"form-label"},"Penempatan",-1)),v(e("select",{"onUpdate:modelValue":a[11]||(a[11]=l=>s.value.placement=l),class:"form-select",required:""},[(o(!0),n(c,null,p(t.value.placements,l=>(o(),n("option",{value:l},u(l),9,ia))),256))],512),[[b,s.value.placement]])]),e("div",ua,[a[37]||(a[37]=e("label",{class:"form-label"},"Lokasi",-1)),v(e("select",{"onUpdate:modelValue":a[12]||(a[12]=l=>s.value.lokasi=l),class:"form-select"},[a[36]||(a[36]=e("option",{value:""},"Pilih Lokasi",-1)),(o(!0),n(c,null,p(t.value.locations,l=>(o(),n("option",{value:l},u(l),9,ra))),256))],512),[[b,s.value.lokasi]])]),e("div",da,[a[38]||(a[38]=e("label",{class:"form-label"},"Hub",-1)),v(e("select",{"onUpdate:modelValue":a[13]||(a[13]=l=>s.value.hub_placement=l),class:"form-select"},[(o(!0),n(c,null,p(t.value.hub_placement,l=>(o(),n("option",{value:l},u(l),9,va))),256))],512),[[b,s.value.hub_placement]])]),e("div",ma,[a[39]||(a[39]=e("label",{class:"form-label"},"Status",-1)),v(e("select",{"onUpdate:modelValue":a[14]||(a[14]=l=>s.value.status=l),class:"form-select"},[(o(!0),n(c,null,p(t.value.status,l=>(o(),n("option",{value:l},u(l),9,ca))),256))],512),[[b,s.value.status]])]),e("div",pa,[a[40]||(a[40]=e("label",{class:"form-label"},"Divisi",-1)),v(e("select",{"onUpdate:modelValue":a[15]||(a[15]=l=>s.value.divisi=l),class:"form-select"},[(o(!0),n(c,null,p(t.value.divisi,l=>(o(),n("option",{value:l},u(l),9,ba))),256))],512),[[b,s.value.divisi]])]),e("div",fa,[a[41]||(a[41]=e("label",{class:"form-label"},"Section",-1)),v(e("select",{"onUpdate:modelValue":a[16]||(a[16]=l=>s.value.section=l),class:"form-select"},[(o(!0),n(c,null,p(t.value.section,l=>(o(),n("option",{value:l},u(l),9,ga))),256))],512),[[b,s.value.section]])]),e("div",ka,[a[42]||(a[42]=e("label",{class:"form-label"},"Kepegawaian",-1)),v(e("select",{"onUpdate:modelValue":a[17]||(a[17]=l=>s.value.kepegawaian=l),class:"form-select"},[(o(!0),n(c,null,p(t.value.kepegawaian,l=>(o(),n("option",{value:l},u(l),9,ya))),256))],512),[[b,s.value.kepegawaian]])]),e("div",_a,[a[43]||(a[43]=e("label",{class:"form-label"},"Klasifikasi",-1)),v(e("select",{"onUpdate:modelValue":a[18]||(a[18]=l=>s.value.klasifikasi=l),class:"form-select"},[(o(!0),n(c,null,p(t.value.klasifikasi,l=>(o(),n("option",{value:l},u(l),9,wa))),256))],512),[[b,s.value.klasifikasi]])]),e("div",xa,[a[44]||(a[44]=e("label",{class:"form-label"},"Salary Code",-1)),v(e("select",{"onUpdate:modelValue":a[19]||(a[19]=l=>s.value.salary_code=l),class:"form-select"},[(o(!0),n(c,null,p(t.value.salary_code,l=>(o(),n("option",{value:l},u(l),9,ha))),256))],512),[[b,s.value.salary_code]])])]),e("div",Ca,[e("button",{type:"button",class:"btn btn-secondary",onClick:O},a[45]||(a[45]=[e("i",{class:"fas fa-times me-1"},null,-1),f(" Cancel ")])),e("button",Sa,[a[46]||(a[46]=e("i",{class:"fas fa-save me-1"},null,-1)),f(" "+u(g.value?"Simpan":"Update"),1)])])],32)])])])])):B("",!0),S.value?(o(),n("div",Ba,[e("div",Ua,[e("div",Ia,[e("div",{class:"modal-header bg-danger text-white"},[a[47]||(a[47]=e("h5",{class:"modal-title"},"Konfirmasi Hapus",-1)),e("button",{type:"button",class:"btn-close btn-close-white",onClick:T})]),e("div",Va,[a[50]||(a[50]=e("p",null,"Apakah Anda yakin ingin menghapus karyawan ini?",-1)),e("p",null,[a[48]||(a[48]=e("strong",null,"NIK:",-1)),f(" "+u(h.value.username),1)]),e("p",null,[a[49]||(a[49]=e("strong",null,"Nama:",-1)),f(" "+u(h.value.name),1)]),a[51]||(a[51]=e("p",{class:"text-danger"},"Data yang dihapus tidak dapat dikembalikan!",-1))]),e("div",{class:"modal-footer border-top-0"},[e("button",{type:"button",class:"btn btn-secondary",onClick:T},a[52]||(a[52]=[e("i",{class:"fas fa-times me-1"},null,-1),f(" Batal ")])),e("button",{type:"button",class:"btn btn-danger",onClick:ae},a[53]||(a[53]=[e("i",{class:"fas fa-trash-alt me-1"},null,-1),f(" Hapus ")]))])])])])):B("",!0)]))}},Ea=se($a,[["__scopeId","data-v-ef653538"]]);export{Ea as default};
