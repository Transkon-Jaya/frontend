import{_ as A,r as f,l as x,o as Q,c as a,a as n,b as y,t as c,v as M,F as d,j as h,n as S,k as N,y as U,s as R,g as o,h as $}from"./index-mqQHQ1O9.js";/* empty css                                                                  */const W={class:"container mt-4"},G={class:"card p-4 shadow-sm"},H={class:"d-flex justify-content-between align-items-center mb-3"},J={class:"fw-bold"},K=["placeholder"],X={class:"table-responsive"},Y={class:"table table-hover align-middle"},Z={class:"table-light"},ee={class:"filter-row"},te=["placeholder","onUpdate:modelValue"],le=["onUpdate:modelValue"],se={value:""},ne=["value"],ae=["onClick"],oe={key:0},ue=["checked"],re=["onUpdate:modelValue"],ce={key:0},ie=["colspan"],de={class:"d-flex justify-content-between align-items-center mt-3 flex-wrap gap-2"},me={class:"d-flex align-items-center gap-2"},ve=["value"],fe={class:"pagination mb-0"},he=["onClick","disabled"],ge={__name:"MiniTable",props:{settings:Object,urls:Object,fields:Object},setup(v){const g=v,C=f([]),k=f(""),b=f({}),B=f({}),r=f({column:null,ascending:!0}),m=f(1),_=f(10),z=[10,25,50,100],L=s=>g.fields.columns.some(l=>l.column===s&&l.dropdown),O=(s,l)=>{var e;return((e=g.fields[s])==null?void 0:e.includes(l))||!1},w=(s,l)=>{const e=g.fields.merge.find(t=>t.to===l);if(e){for(let t=e.fields.length-1;t>=0;t--){const u=e.fields[t],i=s[u];if(i!==null&&i!=="")return i}return""}return s[l]},E=async()=>{try{const s=await R.get(g.urls.data);C.value=s.data,g.fields.columns.forEach(l=>{L(l.column)&&(B.value[l.column]=[...new Set(C.value.map(e=>e[l.column]))])})}catch(s){console.error("Fetch error:",s)}},V=x(()=>{let s=C.value.filter(l=>{const e=k.value===""||Object.values(l).join(" ").toLowerCase().includes(k.value.toLowerCase()),t=Object.entries(b.value).every(([u,i])=>{if(!i)return!0;const p=i.toLowerCase(),F=g.fields.merge.find(D=>D.to===u);return F?F.fields.some(D=>(l[D]||"").toString().toLowerCase().includes(p)):(l[u]||"").toString().toLowerCase().includes(p)});return e&&t});return r.value.column&&s.sort((l,e)=>{const t=w(l,r.value.column),u=w(e,r.value.column);return t<u?r.value.ascending?-1:1:t>u?r.value.ascending?1:-1:0}),s}),I=s=>{r.value.column===s?r.value.ascending=!r.value.ascending:(r.value.column=s,r.value.ascending=!0)},P=x(()=>Math.ceil(V.value.length/_.value)),T=x(()=>{const s=(m.value-1)*_.value;return V.value.slice(s,s+_.value)}),j=s=>{s>=1&&s<=P.value&&(m.value=s)},q=x(()=>{const s=P.value,l=m.value,e=2,t=[],u=Math.max(2,l-e),i=Math.min(s-1,l+e);for(let p=u;p<=i;p++)t.push(p);return u>2&&t.unshift("..."),i<s-1&&t.push("..."),t.unshift(1),s>1&&t.push(s),t});return Q(E),(s,l)=>(o(),a("div",W,[n("div",G,[n("div",H,[n("h2",J,c(v.settings.title),1),y(n("input",{type:"text",class:"form-control w-25",placeholder:v.settings.searchText||"Search...","onUpdate:modelValue":l[0]||(l[0]=e=>k.value=e)},null,8,K),[[M,k.value]])]),n("div",X,[n("table",Y,[n("thead",Z,[n("tr",ee,[(o(!0),a(d,null,h(v.fields.columns,e=>(o(),a("th",{key:"filter-"+e.column},[e.filterText?(o(),a(d,{key:0},[L(e.column)?y((o(),a("select",{key:1,class:"form-select form-select-sm","onUpdate:modelValue":t=>b.value[e.column]=t},[n("option",se,c(e.filterText),1),(o(!0),a(d,null,h(B.value[e.column]||[],t=>(o(),a("option",{key:t,value:t},c(t),9,ne))),128))],8,le)),[[N,b.value[e.column]]]):y((o(),a("input",{key:0,type:"text",class:"form-control form-control-sm",placeholder:e.filterText,"onUpdate:modelValue":t=>b.value[e.column]=t},null,8,te)),[[M,b.value[e.column]]])],64)):S("",!0)]))),128))]),n("tr",null,[(o(!0),a(d,null,h(v.fields.columns,e=>(o(),a("th",{key:"header-"+e.column,onClick:t=>I(e.column),class:"sortable"},[$(c(e.label)+" ",1),s.sortBy===e.column?(o(),a("span",oe,c(r.value.ascending==="asc"?"▲":"▼"),1)):S("",!0)],8,ae))),128))])]),n("tbody",null,[(o(!0),a(d,null,h(T.value,e=>(o(),a("tr",{key:e.id,class:"clickable-row"},[(o(!0),a(d,null,h(v.fields.columns,t=>(o(),a("td",{key:"cell-"+t.column,contenteditable:""},[O("checkbox",t.column)?(o(),a("input",{key:0,type:"checkbox",checked:!!parseInt(w(e,t.column)),style:{"align-content":"center"}},null,8,ue)):O("datetime",t.column)?y((o(),a("input",{key:1,type:"datetime-local","onUpdate:modelValue":u=>e[t.column]=u,style:{"font-size":"9px"}},null,8,re)),[[M,e[t.column]]]):(o(),a(d,{key:2},[$(c(w(e,t.column)),1)],64))]))),128))]))),128)),T.value.length===0?(o(),a("tr",ce,[n("td",{colspan:v.fields.columns.length,class:"text-center text-muted py-4"}," No data found ",8,ie)])):S("",!0)])])]),n("div",de,[n("div",me,[l[4]||(l[4]=n("label",{for:"itemsPerPage",class:"form-label mb-0"},"Rows per page:",-1)),y(n("select",{id:"itemsPerPage",class:"form-select form-select-sm w-auto","onUpdate:modelValue":l[1]||(l[1]=e=>_.value=e)},[(o(),a(d,null,h(z,e=>n("option",{key:e,value:e},c(e),9,ve)),64))],512),[[N,_.value]])]),n("div",null," Showing "+c(T.value.length)+" of "+c(V.value.length)+" filtered results ",1),n("nav",null,[n("ul",fe,[n("li",{class:U(["page-item",{disabled:m.value===1}])},[n("button",{class:"page-link",onClick:l[2]||(l[2]=e=>j(m.value-1))},"«")],2),(o(!0),a(d,null,h(q.value,e=>(o(),a("li",{key:"page-"+e,class:U(["page-item",{active:e===m.value,disabled:e==="..."}])},[n("button",{class:"page-link",onClick:t=>typeof e=="number"&&j(e),disabled:e==="..."},c(e),9,he)],2))),128)),n("li",{class:U(["page-item",{disabled:m.value===P.value}])},[n("button",{class:"page-link",onClick:l[3]||(l[3]=e=>j(m.value+1))},"»")],2)])])])])]))}},_e=A(ge,[["__scopeId","data-v-561a7187"]]);export{_e as default};
