import{_ as le,u as oe,r as o,l as h,o as ne,K as re,c,a as s,d as C,C as z,b as ie,v as de,f as ce,V as ue,t as r,n as me,F as K,j as G,y as M,p as D,q as V,A,s as ve,g as u,h as pe}from"./index-DBf8bQas.js";import{s as O}from"./vue-multiselect-BSZ1NUSM.js";/* empty css                            *//* empty css                                                 */import{M as he}from"./bootstrap.esm-B0YAJBZY.js";const be={class:"container-global"},ge={class:"d-flex align-items-end gap-3 flex-wrap"},_e={class:"col-md-4"},fe={class:"col-md-4"},ye={class:"filter-box flex-grow-1"},we={class:"border rounded p-2 bg-white"},ke={class:"filter-box"},xe={class:"container my-4"},Ce={key:0,class:"text-center my-5"},Me={key:1,class:"alert alert-danger"},De={key:2},Ve={class:"row"},Ae={class:"card h-100"},Ee=["src","onClick"],Ie={class:"card-body"},Pe={class:"card-title"},Be={class:"card-text text-muted small"},Le={key:0,"aria-label":"Page navigation"},Te={class:"pagination justify-content-center mt-4"},$e=["onClick"],je={class:"text-center text-muted small"},Re={class:"modal-dialog modal-dialog-centered modal-lg"},Ue={class:"modal-content bg-dark text-white"},Fe={class:"modal-header border-0"},Ne={class:"modal-title",id:"imageModalLabel"},Se={class:"modal-body text-center"},ze=["src"],Ke={class:"modal-footer justify-content-between border-0"},Ge=["disabled"],Oe=["disabled"],v=20,qe={__name:"GalleryAbsensi",setup(He){const f=oe(),i=o([]),n=o(0),y=o(null),b=o(!0),w=o(null);o("");const l=o(1),g=o(null),k=o(null),E=o([]),I=o([]),P=o({api:{params:[]}}),B=o({api:{params:[]}}),L=o(null),T=o(null),_=h(()=>Math.ceil(i.value.length/v)),q=h(()=>{const e=(l.value-1)*v,a=e+v;return i.value.slice(e,a)}),H=h(()=>(l.value-1)*v+1),J=h(()=>Math.min(l.value*v,i.value.length)),Q=h(()=>{const e=[];let t=Math.max(1,l.value-Math.floor(2.5)),d=Math.min(_.value,t+5-1);d-t+1<5&&(t=Math.max(1,d-5+1));for(let p=t;p<=d;p++)e.push(p);return e}),$=e=>{if(!e)return"";const a={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(e).toLocaleDateString("id-ID",a)},j=e=>e?`https://www.transkon-rent.com/uploads/absensi/${e}`:"",x=h(()=>i.value[n.value]||{}),W=()=>{l.value<_.value&&l.value++},X=()=>{l.value>1&&l.value--},Y=e=>{l.value=e},Z=e=>(l.value-1)*v+e,ee=async()=>{try{b.value=!0;const a=(await V.get(A+"/data/absensi_all",{headers:{Authorization:`Bearer ${f.token}`},params:{params:["","",""]}})).data;if(Array.isArray(a))i.value=a.filter(t=>t.foto_in);else throw new Error("Format data tidak valid")}catch(e){console.error("Error fetching data:",e),w.value=e.message,i.value=[{foto_in:"Tj1023_IN_1746431330.jpg",name:"Contoh Karyawan 1",hour_in:"2023-11-15T08:00:00"},{foto_in:"Tj1023_IN_1746507175.jpg",name:"Contoh Karyawan 2",hour_in:"2023-11-15T08:05:00"}]}finally{b.value=!1}};let m=null;const ae=e=>{n.value=e,m==null||m.show()},R=()=>{m==null||m.hide()},U=()=>{if(n.value<i.value.length-1){n.value++;const e=Math.floor(n.value/v)+1;e!==l.value&&(l.value=e)}},F=()=>{if(n.value>0){n.value--;const e=Math.floor(n.value/v)+1;e!==l.value&&(l.value=e)}},N=e=>{var a;if(!(!m||!((a=document.getElementById("imageModal"))!=null&&a.classList.contains("show"))))switch(e.key){case"ArrowRight":U();break;case"ArrowLeft":F();break;case"Escape":R();break}},te=async()=>{try{const e=await V.get(`${A}/dropdowns/department`,{headers:{Authorization:`Bearer ${f.token}`}});E.value=e.data.map(t=>({label:t,value:t}));const a=await V.get(`${A}/dropdowns/name`,{headers:{Authorization:`Bearer ${f.token}`}});I.value=a.data.map(t=>({label:t,value:t}))}catch(e){console.error("Error fetching dropdowns:",e)}},S=async(e,a)=>{var d,p;let t=0;g.value=a,t=3,P.value.api.params[t]=a.value,B.value.api.params[t]=a.value,await((d=L.value)==null?void 0:d.renderChart()),await((p=T.value)==null?void 0:p.renderChart()),await ve()},se=async()=>{var e,a;g.value="",k.value="";for(let t=2;t<5;t++)P.value.api.params[t]="",B.value.api.params[t]="";await((e=L.value)==null?void 0:e.renderChart()),await((a=T.value)==null?void 0:a.renderChart())};return ne(async()=>{y.value&&(m=new he(y.value)),await ee(),await te(),b.value=!1,document.addEventListener("keydown",N)}),re(()=>{document.removeEventListener("keydown",N)}),(e,a)=>(u(),c("div",be,[s("div",ge,[s("div",_e,[a[5]||(a[5]=s("label",{class:"form-label"},"Department",-1)),C(z(O),{modelValue:g.value,"onUpdate:modelValue":[a[0]||(a[0]=t=>g.value=t),a[1]||(a[1]=t=>S("dep",t))],options:E.value||[],placeholder:"Select...",label:"label","track-by":"value",class:"multiselect no-border"},null,8,["modelValue","options"])]),s("div",fe,[a[6]||(a[6]=s("label",{class:"form-label"},"Employee",-1)),C(z(O),{modelValue:k.value,"onUpdate:modelValue":[a[2]||(a[2]=t=>k.value=t),a[3]||(a[3]=t=>S("dep",t))],options:I.value||[],placeholder:"Select...",label:"label","track-by":"value",class:"multiselect no-border"},null,8,["modelValue","options"])]),s("div",ye,[a[7]||(a[7]=s("label",{class:"form-label small mb-1 text-muted"},"Date",-1)),s("div",we,[ie(s("input",{type:"date",class:"form-control border-0 p-0","onUpdate:modelValue":a[4]||(a[4]=t=>e.selectedDate=t)},null,512),[[de,e.selectedDate]])])]),s("div",ke,[C(ue,{type:"button",color:"danger",size:"md",onClick:se,class:"h-100"},{default:ce(()=>a[8]||(a[8]=[s("i",{class:"bi bi-arrow-counterclockwise me-2"},null,-1),pe(" Reset ")])),_:1})])]),s("div",xe,[b.value?(u(),c("div",Ce,a[9]||(a[9]=[s("div",{class:"spinner-border text-primary",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"mt-2"},"Memuat data absensi...",-1)]))):w.value?(u(),c("div",Me," Gagal memuat data: "+r(w.value),1)):(u(),c("div",De,[s("div",Ve,[(u(!0),c(K,null,G(q.value,(t,d)=>(u(),c("div",{class:"col-md-3 mb-4",key:d},[s("div",Ae,[s("img",{src:j(t.foto_in),class:"card-img-top gallery-img",onClick:p=>ae(Z(d)),alt:"Foto Absensi"},null,8,Ee),s("div",Ie,[s("h6",Pe,r(t.name),1),s("p",Be,r($(t.hour_in)),1)])])]))),128))]),_.value>1?(u(),c("nav",Le,[s("ul",Te,[s("li",{class:M(["page-item",{disabled:l.value===1}])},[s("a",{class:"page-link",href:"#",onClick:D(X,["prevent"])},"«")],2),(u(!0),c(K,null,G(Q.value,t=>(u(),c("li",{class:M(["page-item",{active:l.value===t}]),key:t},[s("a",{class:"page-link",href:"#",onClick:D(d=>Y(t),["prevent"])},r(t),9,$e)],2))),128)),s("li",{class:M(["page-item",{disabled:l.value===_.value}])},[s("a",{class:"page-link",href:"#",onClick:D(W,["prevent"])},"»")],2)]),s("div",je," Menampilkan "+r(H.value)+"-"+r(J.value)+" dari "+r(i.value.length)+" foto ",1)])):me("",!0)])),s("div",{class:"modal fade",id:"imageModal",tabindex:"-1","data-bs-backdrop":"false","aria-labelledby":"imageModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:y},[s("div",Re,[s("div",Ue,[s("div",Fe,[s("h5",Ne,r(x.value.name||"Karyawan")+" - "+r($(x.value.hour_in)),1),s("button",{type:"button",class:"btn-close btn-close-white",onClick:R,"aria-label":"Close","data-bs-dismiss":"modal"})]),s("div",Se,[s("img",{src:j(x.value.foto_in),class:"img-fluid rounded portrait-img fixed-modal-image",alt:"Foto Absensi",ref:"modalImage"},null,8,ze)]),s("div",Ke,[s("button",{type:"button",class:"btn btn-outline-light",onClick:F,disabled:n.value===0}," « Sebelumnya ",8,Ge),s("span",null," Gambar "+r(n.value+1)+" dari "+r(i.value.length),1),s("button",{type:"button",class:"btn btn-outline-light",onClick:U,disabled:n.value===i.value.length-1}," Berikutnya » ",8,Oe)])])])],512)])]))}},Ze=le(qe,[["__scopeId","data-v-1e240264"]]);export{Ze as default};
