import{_ as ut,c as p,g,a as e,b as v,v as k,q as z,h as I,t as D,F as q,j as J,e as Z,u as ct,r as u,n as xt,o as mt,p as P,A as B,z as X,k as it,s as dt,B as jt,Q as Ot,y as Ht,d as gt}from"./index-DtjpuImB.js";import{E as bt,a as Wt}from"./jspdf.plugin.autotable-DHXztOUJ.js";import{E as Gt}from"./exceljs.min-D7XX8oil.js";import{c as tt}from"./_commonjsHelpers-Cpj98o6Y.js";const Yt={setup(){const S=ct(),t=u([]),C=u(!0),a=u(!1),A=u(null),_=u(""),o=u(""),y=u(""),r=u(null),s=u(null),i=b=>b?new Date(b).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}):"-",F=async()=>{var b,E;try{C.value=!0,A.value=null;const h=await P.get(`${B}/tracking-invoices`,{headers:{Authorization:`Bearer ${S.token}`}});t.value=h.data.data||[]}catch(h){A.value=((E=(b=h.response)==null?void 0:b.data)==null?void 0:E.error)||"Gagal memuat data invoice",console.error("Fetch Error:",h)}finally{C.value=!1}},f=async b=>{try{a.value=!0;const E={acct:b.acct,tax_dept:b.tax_dept,admin:b.admin,expedisi:b.expedisi,remarks:b.remarks};await P.put(`${B}/tracking-invoices`,E,{params:{ta_id:b.ta_id},headers:{Authorization:`Bearer ${S.token}`}})}catch(E){console.error("Gagal update tracking:",E),alert("Gagal menyimpan perubahan. Coba lagi."),F()}finally{a.value=!1}},T=xt(()=>t.value.filter(b=>{var W;const E=_.value?(W=b.invoiceNo)==null?void 0:W.toLowerCase().includes(_.value.toLowerCase()):!0,h=b.invoiceDate?new Date(b.invoiceDate).toISOString().split("T")[0]:"",R=o.value?h>=o.value:!0,N=y.value?h<=y.value:!0;return E&&R&&N})),j=()=>{_.value="",o.value="",y.value="",r.value&&$(r.value).datepicker("clearDates"),s.value&&$(s.value).datepicker("clearDates")};return mt(()=>{F(),r.value&&$(r.value).datepicker({format:"yyyy-mm-dd",autoclose:!0,language:"id",todayHighlight:!0,clearBtn:!0}).on("changeDate",function(b){o.value=$(this).datepicker("getFormattedDate")}),s.value&&$(s.value).datepicker({format:"yyyy-mm-dd",autoclose:!0,language:"id",todayHighlight:!0,clearBtn:!0}).on("changeDate",function(b){y.value=$(this).datepicker("getFormattedDate")})}),{invoices:t,loading:C,submitting:a,error:A,formatDate:i,updateTracking:f,filterInvoiceNo:_,filterStartDate:o,filterEndDate:y,filteredInvoices:T,resetFilters:j,startDateInput:r,endDateInput:s}}},Xt={class:"info-card"},qt={class:"card-header d-flex flex-column flex-md-row align-items-md-center justify-content-between"},Jt={class:"filters d-flex flex-wrap gap-2"},Kt={class:"input-group input-group-sm",style:{"max-width":"250px"}},Qt={class:"card-body"},Zt={key:0,class:"text-center py-5"},$t={key:1,class:"alert alert-danger"},te={key:2,class:"table-responsive"},ee={class:"modern-table"},ae={class:"checkbox-cell"},oe=["onUpdate:modelValue","onChange","disabled"],ne={class:"checkbox-cell"},le=["onUpdate:modelValue","onChange","disabled"],se={class:"checkbox-cell"},re=["onUpdate:modelValue","onChange","disabled"],ie={class:"checkbox-cell"},de=["onUpdate:modelValue","onChange","disabled"],ue=["onUpdate:modelValue","onBlur","disabled"];function ce(S,t,C,a,A,_){return g(),p("div",Xt,[e("div",qt,[t[5]||(t[5]=e("h3",{class:"card-title mb-2 mb-md-0"},"TRANSMITAL INVOICE INTERNAL",-1)),e("div",Jt,[v(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=o=>a.filterInvoiceNo=o),placeholder:"Cari No. Invoice...",class:"form-control form-control-sm",style:{"max-width":"200px"}},null,512),[[k,a.filterInvoiceNo]])]),e("div",Kt,[v(e("input",{type:"text",ref:"startDateInput","onUpdate:modelValue":t[1]||(t[1]=o=>a.filterStartDate=o),class:"form-control form-control-sm datepicker",placeholder:"Start Date"},null,512),[[k,a.filterStartDate]]),t[4]||(t[4]=e("span",{class:"input-group-text"},"→",-1)),v(e("input",{type:"text",ref:"endDateInput","onUpdate:modelValue":t[2]||(t[2]=o=>a.filterEndDate=o),class:"form-control form-control-sm datepicker",placeholder:"End Date"},null,512),[[k,a.filterEndDate]])]),e("button",{class:"btn btn-sm btn-secondary",onClick:t[3]||(t[3]=(...o)=>a.resetFilters&&a.resetFilters(...o))},"Reset")]),e("div",Qt,[a.loading?(g(),p("div",Zt,t[6]||(t[6]=[e("div",{class:"spinner-border text-primary"},null,-1),e("p",null,"Loading invoices...",-1)]))):z("",!0),a.error?(g(),p("div",$t,[t[7]||(t[7]=e("strong",null,"Error:",-1)),I(" "+D(a.error),1)])):(g(),p("div",te,[e("table",ee,[t[8]||(t[8]=e("thead",null,[e("tr",null,[e("th",null,"No."),e("th",null,"No. Inv"),e("th",null,"Tgl Invoice"),e("th",null,"Acct"),e("th",null,"Tax Dept."),e("th",null,"Admin"),e("th",null,"Expedisi"),e("th",null,"Remarks")])],-1)),e("tbody",null,[(g(!0),p(q,null,J(a.filteredInvoices,(o,y)=>(g(),p("tr",{key:o.ta_id},[e("td",null,D(y+1),1),e("td",null,D(o.invoiceNo),1),e("td",null,D(a.formatDate(o.invoiceDate)),1),e("td",ae,[v(e("input",{type:"checkbox","onUpdate:modelValue":r=>o.acct=r,onChange:r=>a.updateTracking(o),class:"form-checkbox",disabled:a.submitting},null,40,oe),[[Z,o.acct]])]),e("td",ne,[v(e("input",{type:"checkbox","onUpdate:modelValue":r=>o.tax_dept=r,onChange:r=>a.updateTracking(o),class:"form-checkbox",disabled:a.submitting},null,40,le),[[Z,o.tax_dept]])]),e("td",se,[v(e("input",{type:"checkbox","onUpdate:modelValue":r=>o.admin=r,onChange:r=>a.updateTracking(o),class:"form-checkbox",disabled:a.submitting},null,40,re),[[Z,o.admin]])]),e("td",ie,[v(e("input",{type:"checkbox","onUpdate:modelValue":r=>o.expedisi=r,onChange:r=>a.updateTracking(o),class:"form-checkbox",disabled:a.submitting},null,40,de),[[Z,o.expedisi]])]),e("td",null,[v(e("input",{type:"text","onUpdate:modelValue":r=>o.remarks=r,onBlur:r=>a.updateTracking(o),class:"form-control form-control-sm",disabled:a.submitting,placeholder:"Catatan"},null,40,ue),[[k,o.remarks]])])]))),128))])])]))])])}const me=ut(Yt,[["render",ce],["__scopeId","data-v-25544ecf"]]);var et={exports:{}},fe=et.exports,yt;function ve(){return yt||(yt=1,function(S,t){(function(C,a){a()})(fe,function(){function C(s,i){return typeof i>"u"?i={autoBom:!1}:typeof i!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}function a(s,i,F){var f=new XMLHttpRequest;f.open("GET",s),f.responseType="blob",f.onload=function(){r(f.response,i,F)},f.onerror=function(){console.error("could not download file")},f.send()}function A(s){var i=new XMLHttpRequest;i.open("HEAD",s,!1);try{i.send()}catch{}return 200<=i.status&&299>=i.status}function _(s){try{s.dispatchEvent(new MouseEvent("click"))}catch{var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),s.dispatchEvent(i)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof tt=="object"&&tt.global===tt?tt:void 0,y=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),r=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!y?function(s,i,F){var f=o.URL||o.webkitURL,T=document.createElement("a");i=i||s.name||"download",T.download=i,T.rel="noopener",typeof s=="string"?(T.href=s,T.origin===location.origin?_(T):A(T.href)?a(s,i,F):_(T,T.target="_blank")):(T.href=f.createObjectURL(s),setTimeout(function(){f.revokeObjectURL(T.href)},4e4),setTimeout(function(){_(T)},0))}:"msSaveOrOpenBlob"in navigator?function(s,i,F){if(i=i||s.name||"download",typeof s!="string")navigator.msSaveOrOpenBlob(C(s,F),i);else if(A(s))a(s,i,F);else{var f=document.createElement("a");f.href=s,f.target="_blank",setTimeout(function(){_(f)})}}:function(s,i,F,f){if(f=f||open("","_blank"),f&&(f.document.title=f.document.body.innerText="downloading..."),typeof s=="string")return a(s,i,F);var T=s.type==="application/octet-stream",j=/constructor/i.test(o.HTMLElement)||o.safari,b=/CriOS\/[\d]+/.test(navigator.userAgent);if((b||T&&j||y)&&typeof FileReader<"u"){var E=new FileReader;E.onloadend=function(){var N=E.result;N=b?N:N.replace(/^data:[^;]*;/,"data:attachment/file;"),f?f.location.href=N:location=N,f=null},E.readAsDataURL(s)}else{var h=o.URL||o.webkitURL,R=h.createObjectURL(s);f?f.location=R:location.href=R,f=null,setTimeout(function(){h.revokeObjectURL(R)},4e4)}});o.saveAs=r.saveAs=r,S.exports=r})}(et)),et.exports}var pe=ve();const ge={setup(){const S=ct(),t=u([]),C=u(!1),a=u(!1),A=u(null),_=u([]),o=u(!1),y=u(!1),r=u(!1),s=u(null),i=u(""),F=u(""),f=u(""),T=u(""),j=u(""),b=u(""),E=u(""),h=u({ta_id:"",date:"",from_origin:"",document_type:"",attention:"",company:"",address:"",state:"",awb_reg:"",expeditur:"",receiver_name:"",receive_date:null,ras_status:"",description:"",remarks:""}),R=u(1),N=u(10),W=u(1),ft=u(0);let at=null;const ot=u(null),nt=u(null),lt=()=>{at&&clearTimeout(at),at=setTimeout(()=>{R.value=1,L()},300)},L=async()=>{var n,x;try{C.value=!0,A.value=null;const d={page:R.value,limit:N.value};F.value&&(d.start_date=F.value),f.value&&(d.end_date=f.value),i.value&&(d.ta_id=i.value),T.value&&(d.from_origin=T.value),j.value&&(d.description=j.value),b.value&&(d.company=b.value),E.value&&(d.ras_status=E.value);const w=await P.get(`${B}/transmittal`,{params:d,headers:{Authorization:`Bearer ${S.token}`}});t.value=w.data.items||[],W.value=w.data.totalPages||1,ft.value=w.data.totalCount||0}catch(d){A.value=((x=(n=d.response)==null?void 0:n.data)==null?void 0:x.error)||"Failed to load data",console.error("Fetch Error:",d)}finally{C.value=!1}},kt=async()=>{try{C.value=!0;const n={page:1,limit:1e4};F.value&&(n.start_date=F.value),i.value&&(n.ta_id=i.value),T.value&&(n.from_origin=T.value),j.value&&(n.description=j.value),b.value&&(n.company=b.value),E.value&&(n.ras_status=E.value);const d=(await P.get(`${B}/transmittal`,{params:n,headers:{Authorization:`Bearer ${S.token}`}})).data.items||[];if(d.length===0){alert("Tidak ada data yang sesuai filter untuk diekspor.");return}const w=new Gt.Workbook,c=w.addWorksheet("Transmittal Data");c.addRow(["TA ID","Date","From Origin","Description","Company","Status","Address","State","Attention","AWB/Reg","Expeditur","Receiver Name","Receive Date","Remarks"]),c.getRow(1).eachCell(m=>{m.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFD3D3D3"}},m.font={bold:!0},m.alignment={vertical:"middle",horizontal:"center",wrapText:!0},m.border={style:"thin"}});const U=m=>{if(!m)return"";const V=new Date(m);return`${V.getDate()}/${V.getMonth()+1}/${V.getFullYear()}`};d.forEach(m=>{c.addRow([m.ta_id,U(m.date),m.from_origin,m.description,m.company,m.ras_status,m.address,m.state,m.attention,m.awb_reg,m.expeditur,m.receiver_name,U(m.receive_date),m.remarks])}),c.columns.forEach(m=>{let V=10;m.eachCell({includeEmpty:!0},O=>{if(O.value){const Y=O.value.toString().length;Y>V&&(V=Y)}}),m.width=V<20?20:V});const M=await w.xlsx.writeBuffer(),G=`Transmittal_Data_${new Date().toISOString().split("T")[0]}.xlsx`;pe.saveAs(new Blob([M]),G)}catch(n){console.error("Export Excel gagal:",n),alert("Gagal mengekspor data ke Excel.")}finally{C.value=!1}},wt=n=>["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"][n-1]||"",Dt=async n=>{var x,d;if(!n)return alert("TA ID tidak valid.");try{const c=(await P.get(`${B}/transmittal`,{params:{ta_id:n},headers:{Authorization:`Bearer ${S.token}`}})).data.data;if(!c)throw new Error("Data tidak ditemukan.");const l=new bt({compress:!0,unit:"mm",format:"a4"}),U=new Image;U.src=Ot,U.onload=()=>{l.addImage(U,"PNG",15,15,30,12),l.setFontSize(16).setFont(void 0,"bold"),l.text("TRANSMITTAL ADVICE",105,22,{align:"center"});const M=new Date(c.date),G=wt(M.getMonth()+1),m=M.getFullYear();l.setFontSize(10).setFont(void 0,"normal"),l.text(`No: ${c.ta_id}/${G}/${m}`,105,28,{align:"center"}),l.text(`TA Date: ${pt(c.date)}`,160,28),l.setDrawColor(0),l.line(15,30,195,30),l.setFont(void 0,"bold").setFontSize(10),l.text("PT. TRANSKON JAYA",15,36),l.setFont(void 0,"normal"),l.text(`Attention: ${c.attention||"Account Payable"}`,15,42),l.text(`Company: ${c.company}`,15,48),l.text(`Dept. of Origin: ${c.from_origin}`,15,54);const V="Address : ",O=c.address||"",Y=120,st=36,Nt=Y+l.getTextWidth(V),K=l.splitTextToSize(O,70-l.getTextWidth(V));l.text(V+K[0],Y,st);for(let H=1;H<K.length;H++)l.text(K[H],Nt,st+H*5);const Lt=st+K.length*5;l.text(`City/State: ${c.state}`,Y,Lt),l.line(15,58,195,58),l.text("Undercover this transmittal, We are forwarding you the following:",15,64);const zt=[["1",(c.description||"").split(",").map(H=>H.trim()).filter(H=>H).join(", "),c.remarks||""]];Wt(l,{head:[["No.","Document Description","Remarks"]],body:zt,startY:68,theme:"grid",styles:{fontSize:9},headStyles:{fillColor:[51,51,51],textColor:[255,255,255],halign:"center",fontStyle:"bold"},columnStyles:{0:{halign:"center",cellWidth:10},1:{cellWidth:130},2:{cellWidth:40}}});const Q=l.lastAutoTable.finalY+100;l.text("Received By:",15,Q+60),l.text("Date:",15,Q+90),l.setFontSize(8),l.text("Please Acknowledge Receipt by returning the copy of this Transmittal to PT. Transkon Jaya",15,Q+95),l.text("or Return by Fax (0542) 770403",15,Q+100);const rt=document.createElement("a");rt.href=URL.createObjectURL(l.output("blob")),rt.download=`Transmittal_${c.ta_id}.pdf`,rt.click()}}catch(w){alert("Gagal mengunduh PDF: "+(((d=(x=w.response)==null?void 0:x.data)==null?void 0:d.error)||w.message))}},ht=async n=>{var x,d;if(!n)return alert("TA ID tidak valid.");try{const c=(await P.get(`${B}/transmittal`,{params:{ta_id:n},headers:{Authorization:`Bearer ${S.token}`}})).data.data;if(!c)throw new Error("Data tidak ditemukan.");const l=new bt({unit:"mm",format:"a4"}),U=20,M=20,G=170;l.rect(U,M,G,60),l.setFont(void 0,"bold").setFontSize(12),l.text(`To : ${c.company||""}`,U+3,M+8),l.setFontSize(10),l.text("Attn :",U+3,M+18),l.setFont(void 0,"normal"),l.text(c.attention||"",U+25,M+18),l.setFont(void 0,"bold"),l.text("Address:",U+3,M+28);const m=l.splitTextToSize(c.address||"",G-25);m.length>0&&l.text(m[0],U+25,M+28);for(let O=1;O<m.length;O++)l.text(m[O],U+25,M+28+O*5);const V=M+28+m.length*5;l.text(c.state||"",U+25,V),l.setFont(void 0,"bold"),l.text("Phone :",U+3,V+10),l.setFont(void 0,"normal"),l.text("",U+25,V+10),l.save(`Address_${c.company}.pdf`)}catch(w){alert("Gagal unduh alamat: "+(((d=(x=w.response)==null?void 0:x.data)==null?void 0:d.error)||w.message))}},Ct=async()=>(await P.get(`${B}/get-next-ta-id`,{headers:{Authorization:`Bearer ${S.token}`}})).data.ta_id,Tt=async n=>{const x=n.target.value;if(x.length<2){_.value=[];return}try{const d=await P.get(`${B}/customers_dropdown`,{params:{search:x},headers:{Authorization:`Bearer ${S.token}`}});_.value=d.data.data||[]}catch{_.value=[]}},It=n=>{h.value.company=n.name,h.value.address=n.address||"",h.value.state=n.state||"",_.value=[]},_t=async()=>{try{C.value=!0;const n=await Ct();h.value={ta_id:n,date:"",from_origin:"",document_type:"",attention:"",company:"",address:"",state:"",awb_reg:"",expeditur:"",receiver_name:"",receive_date:null,ras_status:"",description:"",remarks:""},r.value=!1,o.value=!0}catch{A.value="Gagal generate TA ID"}finally{C.value=!1}},Ft=async n=>{var x,d;try{C.value=!0;const c=(await P.get(`${B}/transmittal`,{params:{ta_id:n},headers:{Authorization:`Bearer ${S.token}`}})).data.data;h.value={...c,receive_date:c.receive_date||null},r.value=!0,o.value=!0}catch(w){A.value="Gagal muat data: "+(((d=(x=w.response)==null?void 0:x.data)==null?void 0:d.error)||w.message)}finally{C.value=!1}},vt=()=>{o.value=!1,h.value={ta_id:"",date:"",from_origin:"",document_type:"",attention:"",company:"",address:"",state:"",awb_reg:"",expeditur:"",receiver_name:"",receive_date:null,ras_status:"",description:"",remarks:""}},St=async()=>{var n,x;try{a.value=!0,h.value.receive_date===""&&(h.value.receive_date=null);const d=r.value?"put":"post",w=r.value?{ta_id:h.value.ta_id}:{},c=await P[d](`${B}/transmittal`,h.value,{params:w,headers:{Authorization:`Bearer ${S.token}`,"Content-Type":"application/json"}});if(c.data.status===200||c.data.status===201)vt(),L();else throw new Error(c.data.error||"Simpan gagal")}catch(d){A.value=((x=(n=d.response)==null?void 0:n.data)==null?void 0:x.error)||d.message}finally{a.value=!1}},At=n=>{s.value=n,y.value=!0},Et=async()=>{var n,x;try{a.value=!0,await P.delete(`${B}/transmittal`,{params:{ta_id:s.value},headers:{Authorization:`Bearer ${S.token}`}}),y.value=!1,L()}catch(d){A.value="Hapus gagal: "+(((x=(n=d.response)==null?void 0:n.data)==null?void 0:x.error)||d.message)}finally{a.value=!1}},Ut=()=>{R.value<W.value&&(R.value++,L())},Rt=()=>{R.value>1&&(R.value--,L())},Vt=n=>{R.value=n,L()},Mt=()=>{R.value=1,L()},pt=n=>n?new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-",Pt=n=>({Pending:"badge bg-warning",Received:"badge bg-info",Completed:"badge bg-success"})[n]||"badge bg-secondary",Bt=xt(()=>{const n=[];let d=Math.max(1,R.value-2),w=Math.min(W.value,d+5-1);w-d+1<5&&(d=Math.max(1,w-5+1));for(let c=d;c<=w;c++)n.push(c);return n});return mt(async()=>{try{if(await jt(),typeof $>"u"){console.warn("jQuery tidak tersedia. Datepicker tidak akan diinisialisasi."),L();return}L(),ot.value&&$(ot.value).datepicker({format:"yyyy-mm-dd",autoclose:!0,language:"id",todayHighlight:!0,clearBtn:!0}).on("changeDate",function(){F.value=$(this).datepicker("getFormattedDate"),lt()}),nt.value&&$(nt.value).datepicker({format:"yyyy-mm-dd",autoclose:!0,language:"id",todayHighlight:!0,clearBtn:!0}).on("changeDate",function(){f.value=$(this).datepicker("getFormattedDate"),lt()})}catch(n){A.value="Inisialisasi gagal: "+n.message,console.error(n)}}),{transmittals:t,loading:C,error:A,submitting:a,customers:_,showModal:o,isEditing:r,showDeleteModal:y,deleteTaId:s,formData:h,filterTaId:i,filterStartDate:F,filterEndDate:f,filterFromOrigin:T,filterNoInv:j,filterCompany:b,filterStatus:E,startDateInput:ot,endDateInput:nt,currentPage:R,itemsPerPage:N,totalPages:W,totalCount:ft,visiblePages:Bt,fetchTransmittals:L,openAddModal:_t,openEditModal:Ft,submitForm:St,downloadPdf:Dt,downloadAddress:ht,exportExcel:kt,confirmDelete:At,deleteTransmittal:Et,closeModal:vt,nextPage:Ut,prevPage:Rt,goToPage:Vt,resetPagination:Mt,applyFilters:lt,formatDate:pt,statusBadgeClass:Pt,handleCompanyInput:Tt,selectCustomer:It}}},be={class:"container-fluid"},ye={class:"card border-0 shadow"},xe={class:"card-header bg-black text-white"},ke={class:"d-flex justify-content-between align-items-center"},we=["disabled"],De=["disabled"],he=["disabled"],Ce={class:"card-body"},Te={class:"d-flex align-items-center gap-2 mb-2"},Ie={key:0,class:"alert alert-danger alert-dismissible fade show mb-4"},_e={key:1,class:"text-center py-5"},Fe={key:2,class:"text-center py-5"},Se={key:3},Ae={class:"table-responsive"},Ee={class:"table table-hover table-bordered"},Ue={class:"table-light"},Re={class:"mt-1"},Ve={class:"mt-1"},Me={class:"mt-1"},Pe={class:"mt-1"},Be={class:"mt-1"},Ne={class:"mt-1"},Le={class:"text-center"},ze={class:"d-flex justify-content-center gap-2"},je=["onClick"],Oe=["onClick"],He=["onClick"],We=["onClick"],Ge={class:"d-flex justify-content-between align-items-center mt-4"},Ye={class:"text-muted"},Xe={class:"pagination pagination-sm"},qe=["onClick"],Je={class:"form-group mb-0",style:{width:"120px"}},Ke={class:"modal-content border-0 shadow"},Qe={class:"modal-header bg-black text-white"},Ze={class:"modal-title"},$e={class:"modal-body"},ta={class:"row g-3"},ea={class:"col-md-6"},aa=["readonly","placeholder"],oa={class:"col-md-6"},na={class:"col-md-6"},la={class:"col-md-6"},sa={class:"col-md-6 position-relative"},ra={key:0,class:"list-group mt-1",style:{position:"absolute","z-index":"1000",width:"calc(100% - 2px)","max-height":"200px","overflow-y":"auto"}},ia=["onClick"],da={class:"col-md-6"},ua={class:"col-md-6"},ca={class:"col-md-6"},ma={class:"col-md-6"},fa={class:"col-md-12"},va={class:"col-md-6"},pa={class:"col-md-6"},ga={class:"col-md-6"},ba={class:"col-md-6"},ya={class:"col-md-6"},xa={class:"modal-footer border-top-0 mt-4"},ka=["disabled"],wa={key:0,class:"spinner-border spinner-border-sm me-1"},Da={class:"modal-content border-0 shadow"},ha={class:"modal-header bg-danger text-white"},Ca={class:"modal-body"},Ta={class:"modal-footer border-top-0"},Ia=["disabled"],_a={key:0,class:"spinner-border spinner-border-sm me-1"};function Fa(S,t,C,a,A,_){return g(),p("div",be,[e("div",ye,[e("div",xe,[e("div",ke,[t[56]||(t[56]=e("h3",{class:"mb-0"},"Transmittal Management",-1)),e("div",null,[e("button",{onClick:t[0]||(t[0]=(...o)=>a.openAddModal&&a.openAddModal(...o)),class:"btn btn-sm btn-light me-2",disabled:a.loading},t[53]||(t[53]=[e("i",{class:"fas fa-plus me-1"},null,-1),I(" Add New ")]),8,we),e("button",{onClick:t[1]||(t[1]=(...o)=>a.fetchTransmittals&&a.fetchTransmittals(...o)),class:"btn btn-sm btn-light me-2",disabled:a.loading},[e("i",{class:X(["fas fa-sync",{"fa-spin":a.loading}])},null,2),t[54]||(t[54]=I(" Refresh "))],8,De),e("button",{onClick:t[2]||(t[2]=(...o)=>a.exportExcel&&a.exportExcel(...o)),class:"btn btn-sm btn-success",disabled:a.loading},[t[55]||(t[55]=e("i",{class:"fas fa-file-excel me-1"},null,-1)),I(" "+D(a.loading?"Downloading...":"Download All to Excel"),1)],8,he)])])]),e("div",Ce,[e("div",Te,[v(e("input",{ref:"startDateInput",type:"text","onUpdate:modelValue":t[3]||(t[3]=o=>a.filterStartDate=o),class:"form-control form-control-sm datepicker",placeholder:"Start",onChange:t[4]||(t[4]=(...o)=>a.applyFilters&&a.applyFilters(...o)),style:{"max-width":"120px"}},null,544),[[k,a.filterStartDate]]),v(e("input",{ref:"endDateInput",type:"text","onUpdate:modelValue":t[5]||(t[5]=o=>a.filterEndDate=o),class:"form-control form-control-sm datepicker",placeholder:"End",onChange:t[6]||(t[6]=(...o)=>a.applyFilters&&a.applyFilters(...o)),style:{"max-width":"120px"}},null,544),[[k,a.filterEndDate]])]),a.error?(g(),p("div",Ie,[t[57]||(t[57]=e("strong",null,"Error:",-1)),I(" "+D(a.error)+" ",1),e("button",{type:"button",class:"btn-close",onClick:t[7]||(t[7]=o=>a.error=null)})])):z("",!0),a.loading&&!a.showModal?(g(),p("div",_e,t[58]||(t[58]=[e("div",{class:"spinner-border text-primary",role:"status"},null,-1),e("p",{class:"mt-2"},"Loading transmittals...",-1)]))):a.transmittals.length===0&&!a.loading?(g(),p("div",Fe,[t[60]||(t[60]=e("i",{class:"fas fa-database fa-3x text-muted mb-3"},null,-1)),t[61]||(t[61]=e("h5",null,"No Transmittals Found",-1)),t[62]||(t[62]=e("p",{class:"text-muted"},"There are no transmittal records available",-1)),e("button",{onClick:t[8]||(t[8]=(...o)=>a.openAddModal&&a.openAddModal(...o)),class:"btn btn-primary me-2"},t[59]||(t[59]=[e("i",{class:"fas fa-plus me-1"},null,-1),I(" Create New ")]))])):(g(),p("div",Se,[e("div",Ae,[e("table",Ee,[e("thead",Ue,[e("tr",null,[e("th",null,[t[63]||(t[63]=I("TA ID ")),e("div",Re,[v(e("input",{"onUpdate:modelValue":t[9]||(t[9]=o=>a.filterTaId=o),type:"text",class:"form-control form-control-sm",placeholder:"Filter...",onInput:t[10]||(t[10]=(...o)=>a.applyFilters&&a.applyFilters(...o))},null,544),[[k,a.filterTaId]])])]),e("th",null,[t[64]||(t[64]=I("Date ")),e("div",Ve,[v(e("input",{ref:"startDateInput",type:"text","onUpdate:modelValue":t[11]||(t[11]=o=>a.filterStartDate=o),class:"form-control form-control-sm datepicker",placeholder:"Start",onChange:t[12]||(t[12]=(...o)=>a.applyFilters&&a.applyFilters(...o)),style:{"max-width":"120px"}},null,544),[[k,a.filterStartDate]])])]),e("th",null,[t[65]||(t[65]=I("From Origin ")),e("div",Me,[v(e("input",{"onUpdate:modelValue":t[13]||(t[13]=o=>a.filterFromOrigin=o),type:"text",class:"form-control form-control-sm",placeholder:"Filter...",onInput:t[14]||(t[14]=(...o)=>a.applyFilters&&a.applyFilters(...o))},null,544),[[k,a.filterFromOrigin]])])]),e("th",null,[t[66]||(t[66]=I("No. Inv ")),e("div",Pe,[v(e("input",{"onUpdate:modelValue":t[15]||(t[15]=o=>a.filterNoInv=o),type:"text",class:"form-control form-control-sm",placeholder:"Filter...",onInput:t[16]||(t[16]=(...o)=>a.applyFilters&&a.applyFilters(...o))},null,544),[[k,a.filterNoInv]])])]),e("th",null,[t[67]||(t[67]=I("Company ")),e("div",Be,[v(e("input",{"onUpdate:modelValue":t[17]||(t[17]=o=>a.filterCompany=o),type:"text",class:"form-control form-control-sm",placeholder:"Filter...",onInput:t[18]||(t[18]=(...o)=>a.applyFilters&&a.applyFilters(...o))},null,544),[[k,a.filterCompany]])])]),e("th",null,[t[69]||(t[69]=I("Status ")),e("div",Ne,[v(e("select",{"onUpdate:modelValue":t[19]||(t[19]=o=>a.filterStatus=o),class:"form-select form-select-sm",onChange:t[20]||(t[20]=(...o)=>a.applyFilters&&a.applyFilters(...o))},t[68]||(t[68]=[e("option",{value:""},"All",-1),e("option",{value:"Pending"},"Pending",-1),e("option",{value:"Received"},"Received",-1),e("option",{value:"Completed"},"Completed",-1)]),544),[[it,a.filterStatus]])])]),t[70]||(t[70]=e("th",null,"Actions",-1)),t[71]||(t[71]=e("th",null,"Download",-1)),t[72]||(t[72]=e("th",null,"Address",-1))])]),e("tbody",null,[(g(!0),p(q,null,J(a.transmittals,o=>(g(),p("tr",{key:o.ta_id},[e("td",null,[e("code",null,D(o.ta_id),1)]),e("td",null,D(a.formatDate(o.date)),1),e("td",null,D(o.from_origin),1),e("td",null,D(o.description),1),e("td",null,D(o.company),1),e("td",null,[e("span",{class:X(a.statusBadgeClass(o.ras_status))},D(o.ras_status),3)]),e("td",Le,[e("div",ze,[e("button",{onClick:y=>a.openEditModal(o.ta_id),class:"btn btn-sm btn-warning"},t[73]||(t[73]=[e("i",{class:"fas fa-edit"},null,-1)]),8,je),e("button",{onClick:y=>a.confirmDelete(o.ta_id),class:"btn btn-sm btn-danger"},t[74]||(t[74]=[e("i",{class:"fas fa-trash"},null,-1)]),8,Oe)])]),e("td",null,[e("button",{onClick:y=>a.downloadPdf(o.ta_id),class:"btn btn-sm btn-light"},t[75]||(t[75]=[e("i",{class:"fas fa-download me-1"},null,-1),I(" pdf ")]),8,He)]),e("td",null,[e("button",{onClick:y=>a.downloadAddress(o.ta_id),class:"btn btn-sm btn-light"},t[76]||(t[76]=[e("i",{class:"fas fa-download me-1"},null,-1),I(" adr ")]),8,We)])]))),128))])])]),e("div",Ge,[e("div",Ye," Page "+D(a.currentPage)+" of "+D(a.totalPages)+" ("+D(a.totalCount)+" records) ",1),e("nav",null,[e("ul",Xe,[e("li",{class:X(["page-item",{disabled:a.currentPage===1}])},[e("button",{class:"page-link",onClick:t[21]||(t[21]=(...o)=>a.prevPage&&a.prevPage(...o))},"«")],2),(g(!0),p(q,null,J(a.visiblePages,o=>(g(),p("li",{key:o,class:X(["page-item",{active:o===a.currentPage}])},[e("button",{class:"page-link",onClick:y=>a.goToPage(o)},D(o),9,qe)],2))),128)),e("li",{class:X(["page-item",{disabled:a.currentPage===a.totalPages}])},[e("button",{class:"page-link",onClick:t[22]||(t[22]=(...o)=>a.nextPage&&a.nextPage(...o))},"»")],2)])]),e("div",Je,[v(e("select",{"onUpdate:modelValue":t[23]||(t[23]=o=>a.itemsPerPage=o),class:"form-select form-select-sm",onChange:t[24]||(t[24]=(...o)=>a.resetPagination&&a.resetPagination(...o))},t[77]||(t[77]=[e("option",{value:"10"},"10 / page",-1),e("option",{value:"25"},"25 / page",-1),e("option",{value:"50"},"50 / page",-1)]),544),[[it,a.itemsPerPage]])])])]))])]),a.showModal?(g(),p("div",{key:0,class:"modal fade show d-block",style:{"z-index":"1050",background:"rgba(0,0,0,0.5)"},onClick:t[47]||(t[47]=(...o)=>a.closeModal&&a.closeModal(...o))},[e("div",{class:"modal-dialog modal-dialog-centered modal-lg",onClick:t[46]||(t[46]=dt(()=>{},["stop"]))},[e("div",Ke,[e("div",Qe,[e("h5",Ze,D(a.isEditing?"Edit Transmittal":"Add New Transmittal"),1),e("button",{type:"button",class:"btn-close btn-close-white",onClick:t[25]||(t[25]=(...o)=>a.closeModal&&a.closeModal(...o))})]),e("div",$e,[e("form",{onSubmit:t[45]||(t[45]=dt((...o)=>a.submitForm&&a.submitForm(...o),["prevent"]))},[e("div",ta,[e("div",ea,[t[78]||(t[78]=e("label",{class:"form-label"},"TA ID",-1)),v(e("input",{"onUpdate:modelValue":t[26]||(t[26]=o=>a.formData.ta_id=o),type:"text",class:"form-control",readonly:a.isEditing,placeholder:a.isEditing?"":"Auto-generated on save",required:""},null,8,aa),[[k,a.formData.ta_id]])]),e("div",oa,[t[79]||(t[79]=e("label",{class:"form-label"},[I("Date "),e("span",{class:"text-danger"},"*")],-1)),v(e("input",{"onUpdate:modelValue":t[27]||(t[27]=o=>a.formData.date=o),type:"date",class:"form-control",required:""},null,512),[[k,a.formData.date]])]),e("div",na,[t[80]||(t[80]=e("label",{class:"form-label"},[I("From Origin "),e("span",{class:"text-danger"},"*")],-1)),v(e("input",{"onUpdate:modelValue":t[28]||(t[28]=o=>a.formData.from_origin=o),type:"text",class:"form-control",required:""},null,512),[[k,a.formData.from_origin]])]),e("div",la,[t[81]||(t[81]=e("label",{class:"form-label"},"Document Type",-1)),v(e("input",{"onUpdate:modelValue":t[29]||(t[29]=o=>a.formData.document_type=o),type:"text",class:"form-control"},null,512),[[k,a.formData.document_type]])]),e("div",sa,[t[82]||(t[82]=e("label",{class:"form-label"},"Company",-1)),v(e("input",{"onUpdate:modelValue":t[30]||(t[30]=o=>a.formData.company=o),type:"text",class:"form-control",onInput:t[31]||(t[31]=(...o)=>a.handleCompanyInput&&a.handleCompanyInput(...o)),onBlur:t[32]||(t[32]=o=>a.customers.value=[]),placeholder:"Ketik untuk cari customer"},null,544),[[k,a.formData.company]]),a.customers.length>0?(g(),p("ul",ra,[(g(!0),p(q,null,J(a.customers,o=>(g(),p("li",{key:o.name,class:"list-group-item list-group-item-action",onClick:y=>a.selectCustomer(o),style:{cursor:"pointer"}},D(o.name)+" - "+D(o.address||"No address"),9,ia))),128))])):z("",!0)]),e("div",da,[t[83]||(t[83]=e("label",{class:"form-label"},"Attention",-1)),v(e("input",{"onUpdate:modelValue":t[33]||(t[33]=o=>a.formData.attention=o),type:"text",class:"form-control"},null,512),[[k,a.formData.attention]])]),e("div",ua,[t[84]||(t[84]=e("label",{class:"form-label"},"Address",-1)),v(e("textarea",{"onUpdate:modelValue":t[34]||(t[34]=o=>a.formData.address=o),rows:"2",class:"form-control"},null,512),[[k,a.formData.address]])]),e("div",ca,[t[85]||(t[85]=e("label",{class:"form-label"},"State",-1)),v(e("input",{"onUpdate:modelValue":t[35]||(t[35]=o=>a.formData.state=o),type:"text",class:"form-control"},null,512),[[k,a.formData.state]])]),e("div",ma,[t[86]||(t[86]=e("label",{class:"form-label"},"Description",-1)),v(e("input",{"onUpdate:modelValue":t[36]||(t[36]=o=>a.formData.description=o),type:"text",class:"form-control"},null,512),[[k,a.formData.description]])]),e("div",fa,[t[87]||(t[87]=e("label",{class:"form-label"},"Remarks",-1)),v(e("textarea",{"onUpdate:modelValue":t[37]||(t[37]=o=>a.formData.remarks=o),rows:"2",class:"form-control"},null,512),[[k,a.formData.remarks]])]),e("div",va,[t[88]||(t[88]=e("label",{class:"form-label"},"AWB/Reg",-1)),v(e("input",{"onUpdate:modelValue":t[38]||(t[38]=o=>a.formData.awb_reg=o),type:"text",class:"form-control"},null,512),[[k,a.formData.awb_reg]])]),e("div",pa,[t[89]||(t[89]=e("label",{class:"form-label"},"Expeditur",-1)),v(e("input",{"onUpdate:modelValue":t[39]||(t[39]=o=>a.formData.expeditur=o),type:"text",class:"form-control"},null,512),[[k,a.formData.expeditur]])]),e("div",ga,[t[90]||(t[90]=e("label",{class:"form-label"},"Receiver Name",-1)),v(e("input",{"onUpdate:modelValue":t[40]||(t[40]=o=>a.formData.receiver_name=o),type:"text",class:"form-control"},null,512),[[k,a.formData.receiver_name]])]),e("div",ba,[t[91]||(t[91]=e("label",{class:"form-label"},"Receive Date (Optional)",-1)),v(e("input",{"onUpdate:modelValue":t[41]||(t[41]=o=>a.formData.receive_date=o),type:"date",class:"form-control",onInput:t[42]||(t[42]=(...o)=>S.handleReceiveDateInput&&S.handleReceiveDateInput(...o))},null,544),[[k,a.formData.receive_date]])]),e("div",ya,[t[93]||(t[93]=e("label",{class:"form-label"},"Status",-1)),v(e("select",{"onUpdate:modelValue":t[43]||(t[43]=o=>a.formData.ras_status=o),class:"form-select"},t[92]||(t[92]=[e("option",{value:""},"-- Pilih Status --",-1),e("option",{value:"Pending"},"Pending",-1),e("option",{value:"Received"},"Received",-1),e("option",{value:"Completed"},"Completed",-1)]),512),[[it,a.formData.ras_status]])])]),e("div",xa,[e("button",{type:"button",class:"btn btn-secondary",onClick:t[44]||(t[44]=(...o)=>a.closeModal&&a.closeModal(...o))},"Cancel"),e("button",{type:"submit",class:"btn btn-primary",disabled:a.submitting},[a.submitting?(g(),p("span",wa)):z("",!0),I(" "+D(a.isEditing?"Update":"Create"),1)],8,ka)])],32)])])])])):z("",!0),a.showDeleteModal?(g(),p("div",{key:1,class:"modal fade show d-block",style:{"z-index":"1060",background:"rgba(0,0,0,0.5)"},onClick:t[52]||(t[52]=o=>a.showDeleteModal=!1)},[e("div",{class:"modal-dialog modal-dialog-centered",onClick:t[51]||(t[51]=dt(()=>{},["stop"]))},[e("div",Da,[e("div",ha,[t[94]||(t[94]=e("h5",{class:"modal-title"},"Confirm Delete",-1)),e("button",{type:"button",class:"btn-close btn-close-white",onClick:t[48]||(t[48]=o=>a.showDeleteModal=!1)})]),e("div",Ca,[t[96]||(t[96]=e("p",null,"Are you sure you want to delete this transmittal?",-1)),e("p",null,[t[95]||(t[95]=e("strong",null,"TA ID:",-1)),I(" "+D(a.deleteTaId),1)]),t[97]||(t[97]=e("p",{class:"text-danger"},"This action cannot be undone!",-1))]),e("div",Ta,[e("button",{type:"button",class:"btn btn-secondary",onClick:t[49]||(t[49]=o=>a.showDeleteModal=!1)},"Cancel"),e("button",{type:"button",class:"btn btn-danger",onClick:t[50]||(t[50]=(...o)=>a.deleteTransmittal&&a.deleteTransmittal(...o)),disabled:a.submitting},[a.submitting?(g(),p("span",_a)):z("",!0),t[98]||(t[98]=I(" Delete "))],8,Ia)])])])])):z("",!0)])}const Sa=ut(ge,[["render",Fa],["__scopeId","data-v-dd6d925f"]]),Aa={key:0,class:"text-center py-5"},Ea={key:1,class:"container-fluid px-3"},Ua={class:"d-flex justify-content-between align-items-center mb-3"},Ra={class:"text-muted mb-0"},Va={class:"text-primary"},Ma={class:"text-end"},Pa={class:"fs-6 fw-bold"},Ba={class:"nav nav-tabs mb-4"},Na=["onClick"],La={class:"tab-content"},za={key:0,class:"tab-pane fade show active"},ja={key:1,class:"tab-pane fade show active"},Oa={key:2,class:"tab-pane fade show active text-center py-5"},Ha={__name:"Dashboard",setup(S){const t=ct();u(null);const C=u(!0),a=u("0"),A=[{label:"Transmittal Management",value:"0"},{label:"Transmittal Invoice Internal",value:"1"},{label:"Coming Soon",value:"2"}],_=u(),o=()=>{const y=new Date,r=y.getHours().toString().padStart(2,"0"),s=y.getMinutes().toString().padStart(2,"0"),i=y.getSeconds().toString().padStart(2,"0");_.value=`${r}:${s}:${i}`};return mt(()=>{o(),setInterval(o,1e3),setTimeout(()=>{C.value=!1},800)}),(y,r)=>C.value?(g(),p("div",Aa,r[0]||(r[0]=[e("div",{class:"spinner-border text-primary"},null,-1),e("p",{class:"mt-2"},"Loading dashboard...",-1)]))):(g(),p("div",Ea,[e("div",Ua,[e("div",null,[r[2]||(r[2]=e("h1",{class:"h3 fw-bold mb-1"},[e("i",{class:"fa-solid fa-business-time me-2"}),I(" Commercial Dashboard ")],-1)),e("p",Ra,[r[1]||(r[1]=I("Hi, ")),e("strong",Va,D(Ht(t).name),1)])]),e("div",Ma,[e("div",Pa,D(_.value),1)])]),e("ul",Ba,[(g(),p(q,null,J(A,s=>e("li",{class:"nav-item",key:s.value},[e("button",{class:X(["nav-link",{active:a.value===s.value}]),onClick:i=>a.value=s.value},D(s.label),11,Na)])),64))]),e("div",La,[a.value==="0"?(g(),p("div",za,[gt(Sa)])):z("",!0),a.value==="1"?(g(),p("div",ja,[gt(me)])):z("",!0),a.value==="2"?(g(),p("div",Oa,r[3]||(r[3]=[e("i",{class:"fa-solid fa-clock fa-3x text-muted mb-3"},null,-1),e("h4",null,"Feature Coming Soon",-1),e("p",{class:"text-muted"},"This section is under development.",-1)]))):z("",!0)])]))}},Ja=ut(Ha,[["__scopeId","data-v-3e5aa6dd"]]);export{Ja as default};
