import{_ as se,u as oe,r as o,n as b,o as ne,K as re,c as u,a as e,d as A,x as N,b as R,v as K,f as ie,V as de,t as n,q as ue,F as G,j as O,z as E,s as P,p as I,A as B,P as ce,g as c,h as me}from"./index-B2ZTZ8RC.js";import{s as q}from"./vue-multiselect-CRmihEvH.js";/* empty css                            *//* empty css                                                 */import{M as ve}from"./bootstrap.esm-B0YAJBZY.js";const pe={class:"container-global"},be={class:"d-flex align-items-end gap-3 flex-wrap"},ge={class:"col-md-4"},he={class:"col-md-4"},fe={class:"filter-box flex-grow-1"},_e={class:"border rounded p-2 bg-white"},ye={class:"filter-box flex-grow-1"},we={class:"border rounded p-2 bg-white"},ke={class:"filter-box"},xe={class:"container my-4"},Me={key:0,class:"text-center my-5"},De={key:1,class:"alert alert-danger"},Ce={key:2},Ve={class:"row"},Ae={class:"card h-100"},Ee=["src","onClick"],Pe={class:"card-body"},Ie={class:"card-title"},Be={class:"card-text text-muted small"},Le={key:0,"aria-label":"Page navigation"},Se={class:"pagination justify-content-center mt-4"},Te=["onClick"],Ue={class:"text-center text-muted small"},$e={class:"modal-dialog modal-dialog-centered modal-lg"},je={class:"modal-content bg-dark text-white"},ze={class:"modal-header border-0"},Fe={class:"modal-title",id:"imageModalLabel"},Ne={class:"modal-body text-center"},Re=["src"],Ke={class:"modal-footer justify-content-between border-0"},Ge=["disabled"],Oe=["disabled"],v=20,qe={__name:"GalleryAbsensi",setup(He){const x=oe(),i=o([]),r=o(0),M=o(null),g=o(!0),D=o(null);o("");const s=o(1),h=o(null),f=o(null),_=o(""),y=o(""),L=o([]),S=o([]);o({api:{params:[]}}),o({api:{params:[]}}),o(null),o(null);const w=b(()=>Math.ceil(i.value.length/v)),H=b(()=>{const l=(s.value-1)*v,a=l+v;return i.value.slice(l,a)}),J=b(()=>(s.value-1)*v+1),Q=b(()=>Math.min(s.value*v,i.value.length)),W=b(()=>{const l=[];let t=Math.max(1,s.value-Math.floor(2.5)),d=Math.min(w.value,t+5-1);d-t+1<5&&(t=Math.max(1,d-5+1));for(let p=t;p<=d;p++)l.push(p);return l}),T=l=>{if(!l)return"";const a={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(l).toLocaleDateString("id-ID",a)},U=l=>l?`${ce}/absensi/${l}`:"",C=b(()=>i.value[r.value]||{}),X=()=>{s.value<w.value&&s.value++},Y=()=>{s.value>1&&s.value--},Z=l=>{s.value=l},ee=l=>(s.value-1)*v+l,V=async()=>{var l,a;try{g.value=!0;const d=(await I.get(B+"/absensi-gallery",{headers:{Authorization:`Bearer ${x.token}`},params:{department:((l=h.value)==null?void 0:l.value)??"",name:((a=f.value)==null?void 0:a.value)??"",start_date:_.value,end_date:y.value}})).data;if(Array.isArray(d))i.value=d.filter(p=>p.foto);else throw new Error("Format data tidak valid")}catch(t){console.error("Error fetching data:",t),D.value=t.message,i.value=[{foto:"Tj1023_IN_1746431330.jpg",name:"Contoh Karyawan 1",hour:"2023-11-15T08:00:00",status:"in"},{foto:"Tj1023_IN_1746507175.jpg",name:"Contoh Karyawan 2",hour:"2023-11-15T08:05:00",status:"in"}]}finally{g.value=!1}};let m=null;const ae=l=>{r.value=l,m==null||m.show()},$=()=>{m==null||m.hide()},j=()=>{if(r.value<i.value.length-1){r.value++;const l=Math.floor(r.value/v)+1;l!==s.value&&(s.value=l)}},z=()=>{if(r.value>0){r.value--;const l=Math.floor(r.value/v)+1;l!==s.value&&(s.value=l)}},F=l=>{var a;if(!(!m||!((a=document.getElementById("imageModal"))!=null&&a.classList.contains("show"))))switch(l.key){case"ArrowRight":j();break;case"ArrowLeft":z();break;case"Escape":$();break}},te=async()=>{try{const l=await I.get(`${B}/dropdowns/department`,{headers:{Authorization:`Bearer ${x.token}`}});L.value=l.data.map(t=>({label:t,value:t}));const a=await I.get(`${B}/dropdowns/name`,{headers:{Authorization:`Bearer ${x.token}`}});S.value=a.data.map(t=>({label:t,value:t}))}catch(l){console.error("Error fetching dropdowns:",l)}},k=async(l,a)=>{await V()},le=async()=>{h.value=null,f.value=null,_.value="",y.value="",await V()};return ne(async()=>{M.value&&(m=new ve(M.value)),await V(),await te(),g.value=!1,document.addEventListener("keydown",F)}),re(()=>{document.removeEventListener("keydown",F)}),(l,a)=>(c(),u("div",pe,[e("div",be,[e("div",ge,[a[8]||(a[8]=e("label",{class:"form-label"},"Department",-1)),A(N(q),{modelValue:h.value,"onUpdate:modelValue":[a[0]||(a[0]=t=>h.value=t),a[1]||(a[1]=t=>k())],options:L.value||[],placeholder:"Select Department...",label:"label","track-by":"value",class:"multiselect no-border"},null,8,["modelValue","options"])]),e("div",he,[a[9]||(a[9]=e("label",{class:"form-label"},"Employee",-1)),A(N(q),{modelValue:f.value,"onUpdate:modelValue":[a[2]||(a[2]=t=>f.value=t),a[3]||(a[3]=t=>k())],options:S.value||[],placeholder:"Select Employee...",label:"label","track-by":"value",class:"multiselect no-border"},null,8,["modelValue","options"])]),e("div",fe,[a[10]||(a[10]=e("label",{class:"form-label small mb-1 text-muted"},"Start Date",-1)),e("div",_e,[R(e("input",{type:"date",class:"form-control border-0 p-0","onUpdate:modelValue":a[4]||(a[4]=t=>_.value=t),onChange:a[5]||(a[5]=t=>k("start",t.target.value))},null,544),[[K,_.value]])])]),e("div",ye,[a[11]||(a[11]=e("label",{class:"form-label small mb-1 text-muted"},"End Date",-1)),e("div",we,[R(e("input",{type:"date",class:"form-control border-0 p-0","onUpdate:modelValue":a[6]||(a[6]=t=>y.value=t),onChange:a[7]||(a[7]=t=>k("end",t.target.value))},null,544),[[K,y.value]])])]),e("div",ke,[A(de,{type:"button",color:"danger",size:"md",onClick:le,class:"h-100"},{default:ie(()=>a[12]||(a[12]=[e("i",{class:"bi bi-arrow-counterclockwise me-2"},null,-1),me(" Reset ")])),_:1})])]),e("div",xe,[g.value?(c(),u("div",Me,a[13]||(a[13]=[e("div",{class:"spinner-border text-primary",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1),e("p",{class:"mt-2"},"Memuat data absensi...",-1)]))):D.value?(c(),u("div",De," Gagal memuat data: "+n(D.value),1)):(c(),u("div",Ce,[e("div",Ve,[(c(!0),u(G,null,O(H.value,(t,d)=>(c(),u("div",{class:"col-md-3 mb-4",key:d},[e("div",Ae,[e("img",{src:U(t.foto),class:"card-img-top gallery-img",onClick:p=>ae(ee(d)),alt:"Foto Absensi"},null,8,Ee),e("div",Pe,[e("h6",Ie,n(t.name),1),e("p",Be,n(t.status)+" - "+n(T(t.hour)),1)])])]))),128))]),w.value>1?(c(),u("nav",Le,[e("ul",Se,[e("li",{class:E(["page-item",{disabled:s.value===1}])},[e("a",{class:"page-link",href:"#",onClick:P(Y,["prevent"])},"«")],2),(c(!0),u(G,null,O(W.value,t=>(c(),u("li",{class:E(["page-item",{active:s.value===t}]),key:t},[e("a",{class:"page-link",href:"#",onClick:P(d=>Z(t),["prevent"])},n(t),9,Te)],2))),128)),e("li",{class:E(["page-item",{disabled:s.value===w.value}])},[e("a",{class:"page-link",href:"#",onClick:P(X,["prevent"])},"»")],2)]),e("div",Ue," Menampilkan "+n(J.value)+"-"+n(Q.value)+" dari "+n(i.value.length)+" foto ",1)])):ue("",!0)])),e("div",{class:"modal fade",id:"imageModal",tabindex:"-1","data-bs-backdrop":"false","aria-labelledby":"imageModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:M},[e("div",$e,[e("div",je,[e("div",ze,[e("h5",Fe,n(C.value.name||"Karyawan")+" - "+n(T(C.value.hour)),1),e("button",{type:"button",class:"btn-close btn-close-white",onClick:$,"aria-label":"Close","data-bs-dismiss":"modal"})]),e("div",Ne,[e("img",{src:U(C.value.foto),class:"img-fluid rounded portrait-img fixed-modal-image",alt:"Foto Absensi",ref:"modalImage"},null,8,Re)]),e("div",Ke,[e("button",{type:"button",class:"btn btn-outline-light",onClick:z,disabled:r.value===0}," « Sebelumnya ",8,Ge),e("span",null," Gambar "+n(r.value+1)+" dari "+n(i.value.length),1),e("button",{type:"button",class:"btn btn-outline-light",onClick:j,disabled:r.value===i.value.length-1}," Berikutnya » ",8,Oe)])])])],512)])]))}},Ze=se(qe,[["__scopeId","data-v-052b49c4"]]);export{Ze as default};
