import{s as G}from"./vue-multiselect-DQWB_yxN.js";import{_ as z,m as K,n as J,g as n,f as F,I as Q,H as L,z as V,i as W,r as s,u as X,A as _,w as Y,o as Z,G as ee,c as i,p as c,a as e,d as m,s as te,t as p,h as S,F as ae,j as se,x as $,y as le}from"./index-CpqlFtGW.js";import{C as w}from"./Charts-CO9rqfwn.js";/* empty css                                                                   */import{_ as oe}from"./BigTable-Br7Q7lny.js";import"./xlsx-DlC7eQQq.js";/* empty css                            */import"./logger-B1IqVKgO.js";/* empty css                                                 */const ne={__name:"RouterLink",props:{type:{type:String,default:"button"},color:{type:String,default:"primary"},size:{type:String,default:"md",validator:d=>["sm","md","lg"].includes(d)},block:{type:Boolean,default:!1},customStyle:{type:Object,default:()=>({})},padding:{type:String,default:""}},setup(d){const f=d,u=K(()=>f.size==="sm"?"btn-sm":f.size==="lg"?"btn-lg":"");return(v,o)=>{const h=W("RouterLink",!0);return n(),J(h,{to:v.to,type:d.type,class:V(["btn",[`btn-${d.color}`,u.value,{"d-block w-100":d.block}]]),style:L(d.customStyle)},{default:F(()=>[Q(v.$slots,"default",{},void 0,!0)]),_:3},8,["to","type","class","style"])}}},re=z(ne,[["__scopeId","data-v-16113fd6"]]),ie={key:0},de={class:"mb-2"},ue={class:"text-end"},ce={class:"row text-center mb-4"},ve={class:"col"},_e={class:"card border-success"},me={class:"card-body"},pe={class:"text-success"},ye={class:"col"},ge={class:"card border-danger"},he={class:"card-body"},be={class:"text-danger",style:{"text-align":"center"}},fe={style:{"margin-right":"10px"}},we={style:{"margin-left":"10px"}},ke={class:"col"},xe={class:"card border-warning"},Se={class:"card-body"},De={class:"text-warning",style:{"text-align":"center"}},Ce={style:{"margin-right":"10px"}},Ue={style:{"margin-left":"10px"}},Te={class:"nav nav-tabs"},Be=["onClick"],Ae={key:1,class:"card mb-4"},Ie={class:"card-body"},Re={key:2,class:"row g-4 mb-4"},$e={key:0,class:"col-md-12"},ze={key:1,class:"col-md-12"},Fe={class:"card h-100"},Le={key:2,class:"col-md-12"},Ve={class:"card h-100"},je={key:3,class:"col-md-12"},Ee={class:"card h-100"},Ne={key:4,class:"col-md-12"},Pe={class:"card h-100"},He={__name:"DeDashboardCustomer",setup(d){const f=s(null),u=X(),v=s(""),o=s(""),h=s([]),D=s(!0),C=s({title:"Daily Trend",type:"bar",api:{url:_+"/chart/de_running_total",params:[14,o.value,""]},columns:{label:["date"],datas:["running_total","daily_down","daily_done"]},colors:["red","orange","green"],labels:["Total Down","Units Down / Day","Units Done / Day"]}),k=s({title:"Daily Trend",type:"line",api:{url:_+"/chart/de_running_total",params:[14,o.value,""]},columns:{label:["date"],datas:["running_total","daily_down","daily_done"]},colors:["red","orange","green"],labels:["Total Down","Units Down / Day","Units Done / Day"]}),U=s({title:"Unit Summary",type:"pie",api:{url:_+"/chart/de_total_rental",params:[o.value,""]},columns:{datas:["unit_rental","spare_exists_false","spare_exists_true"]},colors:["green","red","orange"],labels:["Unit Rental","PA Unit","PA Rental"]}),j=s({title:"Customer Summary",type:"bar",api:{url:_+"/chart/de_customer_summary"},columns:{label:["customer"],datas:["total_unit","total_break"]},colors:["green","red"],labels:["Total Unit","Total Break"]}),E=s({title:"Location Summary",type:"bar",api:{url:_+"/chart/de_location_summary"},columns:{label:["alt_location"],datas:["total_unit","total_break"]},colors:["green","red"],labels:["Total Unit","Total Break"]}),N=s({title:""}),P=s({firstCol:{label:"TK NO",field:"tk_no",type:"type"},merge:[{fields:["hour_in","hour_out"],to:"hour"},{fields:["jarak_in","jarak_out"],to:"jarak"}],priority:["customer","alt_location"],unpriority:["username","createdAt","lastUpdated"],hidden:["id","done"],toRemove:["vehicle_type","plate_no"],uneditable:["id","plan_hub"],checkbox:["spare_exists"],date:[],datetime:["down_since","estimated_return"]}),H=s({data:`${u.apiBaseUrl}/de_site`,dropdowns:{vehicle_type:{url:u.apiBaseUrl+"/dropdowns/vehicle_type",valueField:"vehicle_type",column:"vehicle_type"},tk_no:{url:u.apiBaseUrl+"/dropdowns/tk_no",valueField:"tk_no",column:"tk_no"}},get:{vehicle_type:{url:u.apiBaseUrl+"/get/vehicle_type",valueField:"vehicle_type",column:"vehicle_type"}}}),l=s(""),O=[{label:"All",value:""},{label:"Site Summary",value:"site-summary"},{label:"Daily Trend",value:"0"},{label:"Unit Summary",value:"1"},{label:"Customer Summary",value:"2"},{label:"Location Summary",value:"3"}],q=async()=>{try{const a=await $.get(_+"/dropdowns/customer",{headers:{Authorization:`Bearer ${u.token}`}});h.value=a.data.map(t=>({label:t,value:t}))}catch(a){console.error("Error fetching dropdown data:",a)}};s();const T=s(),M=async a=>{console.log(a),v.value=a,o.value=v.value.value,C.value.api.params[1]=o.value,k.value.api.params[1]=o.value,await T.value.renderChart(),await x(),await le()},b=s([0,0]),y=s([0,0]),g=s([0,0]),B=s("");function A(){const a=new Date,t=a.getHours().toString().padStart(2,"0"),r=a.getMinutes().toString().padStart(2,"0"),R=a.getSeconds().toString().padStart(2,"0");B.value=`${t}:${r}:${R}`}const x=async()=>{try{const a=await $.get(_+"/chart/de_total_rental",{headers:{Authorization:`Bearer ${u.token}`},params:{params:[o.value,""]}}),t=a.data[0].unit_rental+a.data[0].spare_exists_false+a.data[0].spare_exists_true;b.value[0]=a.data[0].unit_rental,y.value[0]=a.data[0].spare_exists_false+a.data[0].spare_exists_true,g.value[0]=a.data[0].spare_exists_false,t===0?(b.value[1]=0,y.value[1]=0,g.value[1]=0):(b.value[1]=(b.value[0]/t*100).toFixed(2),y.value[1]=(y.value[0]/t*100).toFixed(2),g.value[1]=(g.value[0]/t*100).toFixed(2))}catch(a){console.error("Fetch error:",a)}};Y(o.value,async()=>{console.log("selectedItems : ",o.value),C.value.api.params[1]=o.value,k.value.api.params[1]=o.value,U.value.api.params[0]=o.value,await x()});let I;return Z(async()=>{await q(),await x(),D.value=!1,console.log("dropdown : ",h.value),A(),I=setInterval(A,1e3)}),ee(()=>{clearInterval(I)}),(a,t)=>(n(),i("div",{class:"content",style:L({paddingTop:a.showHeader?"100px":"0px"})},[D.value?c("",!0):(n(),i("div",ie,[t[2]||(t[2]=e("label",{for:"dropdown",class:"form-label"},"Select Customer",-1)),m(te(G),{modelValue:v.value,"onUpdate:modelValue":[t[0]||(t[0]=r=>v.value=r),t[1]||(t[1]=r=>M(r))],options:h.value||[],placeholder:"Select Customer",label:"label","track-by":"value",class:"multiselect no-border"},null,8,["modelValue","options"])])),e("div",de,[t[9]||(t[9]=e("h1",{class:"h4 fw-bold"},"Down Equipment Dashboard",-1)),e("div",ue,[t[3]||(t[3]=e("h5",{class:"fw-bold text-primary"},null,-1)),e("div",null,p(B.value),1)]),e("div",ce,[e("div",ve,[e("div",_e,[e("div",me,[e("h3",pe,p(b.value[0]),1),t[4]||(t[4]=e("p",{class:"fw-bold mb-0"},"On Hire (UIC)",-1))])])]),e("div",ye,[e("div",ge,[e("div",he,[e("h3",be,[e("span",fe,p(y.value[1])+"%",1),t[5]||(t[5]=S(" || ")),e("span",we,p(y.value[0]),1)]),t[6]||(t[6]=e("p",{class:"fw-bold mb-0"},"PA Unit",-1))])])]),e("div",ke,[e("div",xe,[e("div",Se,[e("h3",De,[e("span",Ce,p(g.value[1])+"%",1),t[7]||(t[7]=S(" || ")),e("span",Ue,p(g.value[0]),1)]),t[8]||(t[8]=e("p",{class:"fw-bold mb-0"},"PA Rental",-1))])])])])]),e("ul",Te,[(n(),i(ae,null,se(O,r=>e("li",{class:"nav-item",key:r.value},[e("button",{class:V(["nav-link",{active:l.value===r.value}]),onClick:R=>l.value=r.value},p(r.label),11,Be)])),64))]),l.value===""||l.value==="site-summary"?(n(),i("div",Ae,[e("div",Ie,[t[10]||(t[10]=e("h5",{class:"card-title text-danger"},"Site Summary",-1)),m(oe,{ref_key:"bigTableRef",ref:f,settings:N.value,urls:H.value,fields:P.value,canInsert:!1,canUpdate:!1},null,8,["settings","urls","fields"])])])):c("",!0),l.value===""||["0","1","2","3"].includes(l.value)?(n(),i("div",Re,[l.value===""||l.value==="0"?(n(),i("div",$e)):c("",!0),l.value===""||l.value==="0"?(n(),i("div",ze,[e("div",Fe,[m(w,{ref_key:"chart11",ref:T,settings:k.value},null,8,["settings"])])])):c("",!0),l.value===""||l.value==="1"?(n(),i("div",Le,[e("div",Ve,[m(w,{settings:U.value},null,8,["settings"])])])):c("",!0),l.value===""||l.value==="2"?(n(),i("div",je,[e("div",Ee,[m(w,{settings:j.value},null,8,["settings"])])])):c("",!0),l.value===""||l.value==="3"?(n(),i("div",Ne,[e("div",Pe,[m(w,{settings:E.value},null,8,["settings"])])])):c("",!0)])):c("",!0),e("div",null,[m(re,{to:"/de/down-equipment",color:"danger",size:"md"},{default:F(()=>t[11]||(t[11]=[S("Back to Down Equipment")])),_:1})])],4))}},Ye=z(He,[["__scopeId","data-v-5d9a63bc"]]);export{Ye as default};
