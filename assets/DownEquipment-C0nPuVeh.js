import{s as A}from"./vue-multiselect-Bq7PINeo.js";import{_ as H,r as s,u as O,A as u,w as M,o as G,E as K,c as r,m as d,a as t,d as c,z as F,t as v,h as I,F as J,j as Q,G as W,q as E,C as X,g as i,y as Y}from"./index-DBX_f3tK.js";import{C as h}from"./Charts-D_3EU1RW.js";/* empty css                                                                   */import{_ as Z}from"./BigTable-uoKcxtn_.js";import"./xlsx-BeUCQING.js";const ee={key:0},te={key:1},ae={class:"mb-2"},se={class:"text-end"},le={class:"row text-center mb-4"},oe={class:"col"},ne={class:"card border-success"},re={class:"card-body"},ie={class:"text-success"},de={class:"col"},ue={class:"card border-danger"},ce={class:"card-body"},ve={class:"text-danger",style:{"text-align":"center"}},_e={style:{"margin-right":"10px"}},me={style:{"margin-left":"10px"}},pe={class:"col"},ye={class:"card border-warning"},ge={class:"card-body"},be={class:"text-warning",style:{"text-align":"center"}},he={style:{"margin-right":"10px"}},fe={style:{"margin-left":"10px"}},we={class:"nav nav-tabs"},ke=["onClick"],xe={key:2,class:"card mb-4"},De={class:"card-body"},Se={key:3,class:"row g-4 mb-4"},Ue={key:0,class:"col-md-12"},Ce={key:1,class:"col-md-12"},Te={class:"card h-100"},Be={key:2,class:"col-md-12"},Ve={class:"card h-100"},Ae={key:3,class:"col-md-12"},Fe={class:"card h-100"},Ie={key:4,class:"col-md-12"},Ee={class:"card h-100"},Re={__name:"DownEquipment",setup(Le){const R=s(null),g=O(),_=s(""),n=s(""),b=s([]),f=s(!0),x=s({title:"Daily Trend",type:"bar",api:{url:u+"/chart/de_running_total",params:[14,n.value,""]},columns:{label:["date"],datas:["running_total","daily_down","daily_done"]},colors:["red","orange","green"],labels:["Total Down","Units Down / Day","Units Done / Day"]}),w=s({title:"Daily Trend",type:"line",api:{url:u+"/chart/de_running_total",params:[14,n.value,""]},columns:{label:["date"],datas:["running_total","daily_down","daily_done"]},colors:["red","orange","green"],labels:["Total Down","Units Down / Day","Units Done / Day"]}),D=s({title:"Unit Summary",type:"pie",api:{url:u+"/chart/de_total_rental",params:[n.value,""]},columns:{datas:["unit_rental","spare_exists_false","spare_exists_true"]},colors:["green","red","orange"],labels:["Unit Rental","PA Unit","PA Rental"]}),L=s({title:"Customer Summary",type:"bar",api:{url:u+"/chart/de_customer_summary"},columns:{label:["customer"],datas:["total_unit","total_break"]},colors:["green","red"],labels:["Total Unit","Total Break"]}),$=s({title:"Location Summary",type:"bar",api:{url:u+"/chart/de_location_summary"},columns:{label:["alt_location"],datas:["total_unit","total_break"]},colors:["green","red"],labels:["Total Unit","Total Break"]}),N=s({title:""}),P=s({firstCol:{label:"TK NO",field:"tk_no",type:"type"},merge:[{fields:["hour_in","hour_out"],to:"hour"},{fields:["jarak_in","jarak_out"],to:"jarak"}],priority:["customer","alt_location"],unpriority:["username","createdAt","lastUpdated"],hidden:["id","done"],toRemove:["vehicle_type","plate_no"],uneditable:["id","plan_hub"],checkbox:["spare_exists"],date:[],datetime:["down_since","estimated_return"]}),j=s({data:`${g.apiBaseUrl}/de_site`,dropdowns:{vehicle_type:{url:g.apiBaseUrl+"/dropdowns/vehicle_type",valueField:"vehicle_type",column:"vehicle_type"},tk_no:{url:g.apiBaseUrl+"/dropdowns/tk_no",valueField:"tk_no",column:"tk_no"}},get:{vehicle_type:{url:g.apiBaseUrl+"/get/vehicle_type",valueField:"vehicle_type",column:"vehicle_type"}}}),l=s(""),q=[{label:"All",value:""},{label:"Site Summary",value:"site-summary"},{label:"Daily Trend",value:"0"},{label:"Unit Summary",value:"1"},{label:"Customer Summary",value:"2"},{label:"Location Summary",value:"3"}],z=async()=>{try{const a=await E.get(u+"/dropdowns/customer");b.value=a.data.map(e=>({label:e,value:e}))}catch(a){console.error("Error fetching dropdown data:",a)}};s();const S=s(),U=async a=>{console.log(a),_.value=a,n.value=_.value.value,x.value.api.params[1]=n.value,w.value.api.params[1]=n.value,await S.value.renderChart(),await k(),await X()},y=s([0,0]),m=s([0,0]),p=s([0,0]),C=s("");function T(){const a=new Date,e=a.getHours().toString().padStart(2,"0"),o=a.getMinutes().toString().padStart(2,"0"),V=a.getSeconds().toString().padStart(2,"0");C.value=`${e}:${o}:${V}`}const k=async()=>{try{const a=await E.get(u+"/chart/de_total_rental",{params:{params:[n.value,""]}}),e=a.data[0].unit_rental+a.data[0].spare_exists_false+a.data[0].spare_exists_true;y.value[0]=a.data[0].unit_rental,m.value[0]=a.data[0].spare_exists_false+a.data[0].spare_exists_true,p.value[0]=a.data[0].spare_exists_false,e===0?(y.value[1]=0,m.value[1]=0,p.value[1]=0):(y.value[1]=(y.value[0]/e*100).toFixed(2),m.value[1]=(m.value[0]/e*100).toFixed(2),p.value[1]=(p.value[0]/e*100).toFixed(2))}catch(a){console.error("Fetch error:",a)}};M(n.value,async()=>{console.log("selectedItems : ",n.value),x.value.api.params[1]=n.value,w.value.api.params[1]=n.value,D.value.api.params[0]=n.value,await k()});let B;return G(async()=>{await z(),await k(),f.value=!1,console.log("dropdown : ",b.value),T(),B=setInterval(T,1e3)}),K(()=>{clearInterval(B)}),(a,e)=>(i(),r("div",{class:"content",style:W({paddingTop:a.showHeader?"100px":"0px"})},[f.value?d("",!0):(i(),r("div",ee,[e[4]||(e[4]=t("label",{for:"dropdown",class:"form-label"},"Select Customer",-1)),c(F(A),{modelValue:_.value,"onUpdate:modelValue":[e[0]||(e[0]=o=>_.value=o),e[1]||(e[1]=o=>U(o))],options:b.value||[],placeholder:"Select Customer",label:"label","track-by":"value",class:"multiselect no-border mb-2"},null,8,["modelValue","options"])])),f.value?d("",!0):(i(),r("div",te,[e[5]||(e[5]=t("label",{for:"dropdown",class:"form-label"},"Select Location",-1)),c(F(A),{modelValue:_.value,"onUpdate:modelValue":[e[2]||(e[2]=o=>_.value=o),e[3]||(e[3]=o=>U(o))],options:b.value||[],placeholder:"Select Customer",label:"label","track-by":"value",class:"multiselect no-border mb-4"},null,8,["modelValue","options"])])),t("div",ae,[e[12]||(e[12]=t("h1",{class:"h4 fw-bold"},"Down Equipment Dashboard",-1)),t("div",se,[e[6]||(e[6]=t("h5",{class:"fw-bold text-primary"},null,-1)),t("div",null,v(C.value),1)]),t("div",le,[t("div",oe,[t("div",ne,[t("div",re,[t("h3",ie,v(y.value[0]),1),e[7]||(e[7]=t("p",{class:"fw-bold mb-0"},"On Hire (UIC)",-1))])])]),t("div",de,[t("div",ue,[t("div",ce,[t("h3",ve,[t("span",_e,v(m.value[1])+"%",1),e[8]||(e[8]=I(" || ")),t("span",me,v(m.value[0]),1)]),e[9]||(e[9]=t("p",{class:"fw-bold mb-0"},"PA Unit",-1))])])]),t("div",pe,[t("div",ye,[t("div",ge,[t("h3",be,[t("span",he,v(p.value[1])+"%",1),e[10]||(e[10]=I(" || ")),t("span",fe,v(p.value[0]),1)]),e[11]||(e[11]=t("p",{class:"fw-bold mb-0"},"PA Rental",-1))])])])])]),t("ul",we,[(i(),r(J,null,Q(q,o=>t("li",{class:"nav-item",key:o.value},[t("button",{class:Y(["nav-link",{active:l.value===o.value}]),onClick:V=>l.value=o.value},v(o.label),11,ke)])),64))]),l.value===""||l.value==="site-summary"?(i(),r("div",xe,[t("div",De,[e[13]||(e[13]=t("h5",{class:"card-title text-danger"},"Site Summary",-1)),c(Z,{ref_key:"bigTableRef",ref:R,settings:N.value,urls:j.value,fields:P.value,canInsert:!1,canUpdate:!1},null,8,["settings","urls","fields"])])])):d("",!0),l.value===""||["0","1","2","3"].includes(l.value)?(i(),r("div",Se,[l.value===""||l.value==="0"?(i(),r("div",Ue)):d("",!0),l.value===""||l.value==="0"?(i(),r("div",Ce,[t("div",Te,[c(h,{ref_key:"chart11",ref:S,settings:w.value},null,8,["settings"])])])):d("",!0),l.value===""||l.value==="1"?(i(),r("div",Be,[t("div",Ve,[c(h,{settings:D.value},null,8,["settings"])])])):d("",!0),l.value===""||l.value==="2"?(i(),r("div",Ae,[t("div",Fe,[c(h,{settings:L.value},null,8,["settings"])])])):d("",!0),l.value===""||l.value==="3"?(i(),r("div",Ie,[t("div",Ee,[c(h,{settings:$.value},null,8,["settings"])])])):d("",!0)])):d("",!0)],4))}},He=H(Re,[["__scopeId","data-v-610ca41e"]]);export{He as default};
