import{s as I}from"./vue-multiselect-AzznUv-C.js";import{_ as J,r as s,u as Q,A as c,w as W,o as X,G as Y,c as i,a as e,n as d,h as k,t as u,m as R,C as L,d as m,f as Z,V as ee,F as E,j as te,s as $,x as j,g as r,y as ae}from"./index-mqQHQ1O9.js";import{C as x}from"./Charts-CX1yUB3x.js";/* empty css                                                                   */import{_ as se}from"./BigTable-CEFTvFcZ.js";import"./xlsx-Cda48wl1.js";/* empty css                            *//* empty css                                                 */const le={class:"container-global mb-2"},oe={class:"d-flex justify-content-between align-items-center mb-2 mt-auto"},ne={class:"text-end"},re={class:"row align-items-end mb-4"},ie={class:"col-md-5"},de={class:"col-md-5"},ue={class:"col-md-2 text-end"},ce={class:"mb-2"},ve={class:"text-end"},_e={class:"row text-center mb-4"},me={class:"col"},pe={class:"card border-success"},be={class:"card-body"},ye={class:"text-success"},ge={class:"col"},he={class:"card border-danger"},fe={class:"card-body"},we={class:"text-danger",style:{"text-align":"center"}},ke={style:{"margin-right":"10px"}},xe={style:{"margin-left":"10px"}},De={class:"col"},Se={class:"card border-warning"},Ue={class:"card-body"},Ce={class:"text-warning",style:{"text-align":"center"}},Te={style:{"margin-right":"10px"}},Be={style:{"margin-left":"10px"}},Ve={class:"nav nav-tabs"},Fe=["onClick"],Ae={key:0,class:"card mb-4"},Ie={class:"container-local card-body"},Re={key:1,class:"row g-4 mb-4"},Le={key:0,class:"col-md-12"},Ee={key:1,class:"col-md-12"},$e={class:"card h-100"},je={key:2,class:"col-md-12"},Ne={class:"card h-100"},Pe={key:3,class:"col-md-12"},qe={class:"card h-100"},Oe={key:4,class:"col-md-12"},ze={class:"card h-100"},He={__name:"DownEquipment",setup(Me){const N=s(null),D=s(""),y=Q(),p=s(""),n=s(""),g=s([]),S=s(!0),U=s({title:"Daily Trend",type:"bar",api:{url:c+"/chart/de_running_total",params:[14,n.value,""]},columns:{label:["date"],datas:["running_total","daily_down","daily_done"]},colors:["red","orange","green"],labels:["Total Down","Units Down / Day","Units Done / Day"]}),h=s({title:"Daily Trend",type:"line",api:{url:c+"/chart/de_running_total",params:[14,n.value,""]},columns:{label:["date"],datas:["running_total","daily_down","daily_done"]},colors:["red","orange","green"],labels:["Total Down","Units Down / Day","Units Done / Day"]}),C=s({title:"Unit Summary",type:"pie",api:{url:c+"/chart/de_total_rental",params:[n.value,""]},columns:{datas:["unit_rental","spare_exists_false","spare_exists_true"]},colors:["green","red","orange"],labels:["Unit Rental","PA Unit","PA Rental"]}),P=s({title:"Customer Summary",type:"bar",api:{url:c+"/chart/de_customer_summary"},columns:{label:["customer"],datas:["total_unit","total_break"]},colors:["green","red"],labels:["Total Unit","Total Break"]}),q=s({title:"Location Summary",type:"bar",api:{url:c+"/chart/de_location_summary"},columns:{label:["alt_location"],datas:["total_unit","total_break"]},colors:["green","red"],labels:["Total Unit","Total Break"]}),O=s({title:""}),z=s({firstCol:{label:"TK NO",field:"tk_no",type:"type"},merge:[{fields:["hour_in","hour_out"],to:"hour"},{fields:["jarak_in","jarak_out"],to:"jarak"}],priority:["customer","alt_location"],unpriority:["username","createdAt","lastUpdated"],hidden:["id","done"],toRemove:["vehicle_type","plate_no"],uneditable:["id","plan_hub"],checkbox:["spare_exists"],date:[],datetime:["down_since","estimated_return"]}),H=s({data:`${y.apiBaseUrl}/de_site`,dropdowns:{vehicle_type:{url:y.apiBaseUrl+"/dropdowns/vehicle_type",valueField:"vehicle_type",column:"vehicle_type"},tk_no:{url:y.apiBaseUrl+"/dropdowns/tk_no",valueField:"tk_no",column:"tk_no"}},get:{vehicle_type:{url:y.apiBaseUrl+"/get/vehicle_type",valueField:"vehicle_type",column:"vehicle_type"}}}),l=s(""),M=[{label:"All",value:""},{label:"Site Summary",value:"site-summary"},{label:"Daily Trend",value:"0"},{label:"Unit Summary",value:"1"},{label:"Customer Summary",value:"2"},{label:"Location Summary",value:"3"}],G=async()=>{try{const a=await $.get(c+"/dropdowns/customer");g.value=a.data.map(t=>({label:t,value:t}))}catch(a){console.error("Error fetching dropdown data:",a)}};s();const f=s(),B=async a=>{console.log(a),p.value=a,n.value=p.value.value,U.value.api.params[1]=n.value,h.value.api.params[1]=n.value,await f.value.renderChart(),await w(),await j()},b=s([0,0]),v=s([0,0]),_=s([0,0]),T=s("");function V(){const a=new Date,t=a.getHours().toString().padStart(2,"0"),o=a.getMinutes().toString().padStart(2,"0"),A=a.getSeconds().toString().padStart(2,"0");T.value=`${t}:${o}:${A}`}const w=async()=>{try{const a=await $.get(c+"/chart/de_total_rental",{params:{params:[n.value,""]}}),t=a.data[0].unit_rental+a.data[0].spare_exists_false+a.data[0].spare_exists_true;b.value[0]=a.data[0].unit_rental,v.value[0]=a.data[0].spare_exists_false+a.data[0].spare_exists_true,_.value[0]=a.data[0].spare_exists_false,t===0?(b.value[1]=0,v.value[1]=0,_.value[1]=0):(b.value[1]=(b.value[0]/t*100).toFixed(2),v.value[1]=(v.value[0]/t*100).toFixed(2),_.value[1]=(_.value[0]/t*100).toFixed(2))}catch(a){console.error("Fetch error:",a)}};W(n.value,async()=>{console.log("selectedItems : ",n.value),U.value.api.params[1]=n.value,h.value.api.params[1]=n.value,C.value.api.params[0]=n.value,await w()});let F;X(async()=>{await G(),await w(),S.value=!1,console.log("dropdown : ",g.value),V(),F=setInterval(V,1e3)}),Y(()=>{clearInterval(F)});const K=async()=>{p.value="",D.value="",n.value="",U.value.api.params[1]="",h.value.api.params[1]="",C.value.api.params[0]="",await w(),await j(),f.value&&await f.value.renderChart()};return(a,t)=>(r(),i(E,null,[e("div",le,[e("div",oe,[t[4]||(t[4]=e("h1",{class:"h3 fw-bold mb-0"},[e("i",{class:"bi bi-car-front-fill me-2"}),k(" Down Equipment Dashboard ")],-1)),e("div",ne,[e("div",null,u(T.value),1)])]),e("div",re,[e("div",ie,[t[5]||(t[5]=e("label",{class:"form-label"},"Select Customer",-1)),S.value?d("",!0):(r(),R(L(I),{key:0,modelValue:p.value,"onUpdate:modelValue":[t[0]||(t[0]=o=>p.value=o),t[1]||(t[1]=o=>B(o))],options:g.value||[],placeholder:"Select Customer",label:"label","track-by":"value",class:"multiselect no-border"},null,8,["modelValue","options"]))]),e("div",de,[t[6]||(t[6]=e("label",{class:"form-label"},"Select Location",-1)),S.value?d("",!0):(r(),R(L(I),{key:0,modelValue:D.value,"onUpdate:modelValue":[t[2]||(t[2]=o=>D.value=o),t[3]||(t[3]=o=>B(o))],options:g.value||[],placeholder:"Select Location",label:"label","track-by":"value",class:"multiselect no-border"},null,8,["modelValue","options"]))]),e("div",ue,[m(ee,{type:"button",color:"danger",size:"md",block:!1,onClick:K},{default:Z(()=>t[7]||(t[7]=[k(" Reset Filter ")])),_:1})])]),e("div",ce,[e("div",ve,[t[8]||(t[8]=e("h5",{class:"fw-bold text-primary"},null,-1)),e("div",null,u(T.value),1)]),e("div",_e,[e("div",me,[e("div",pe,[e("div",be,[e("h3",ye,u(b.value[0]),1),t[9]||(t[9]=e("p",{class:"fw-bold mb-0"},"On Hire (UIC)",-1))])])]),e("div",ge,[e("div",he,[e("div",fe,[e("h3",we,[e("span",ke,u(v.value[1])+"%",1),t[10]||(t[10]=k(" || ")),e("span",xe,u(v.value[0]),1)]),t[11]||(t[11]=e("p",{class:"fw-bold mb-0"},"PA Unit",-1))])])]),e("div",De,[e("div",Se,[e("div",Ue,[e("h3",Ce,[e("span",Te,u(_.value[1])+"%",1),t[12]||(t[12]=k(" || ")),e("span",Be,u(_.value[0]),1)]),t[13]||(t[13]=e("p",{class:"fw-bold mb-0"},"PA Rental",-1))])])])])]),e("ul",Ve,[(r(),i(E,null,te(M,o=>e("li",{class:"nav-item",key:o.value},[e("button",{class:ae(["nav-link",{active:l.value===o.value}]),onClick:A=>l.value=o.value},u(o.label),11,Fe)])),64))])]),l.value===""||l.value==="site-summary"?(r(),i("div",Ae,[e("div",Ie,[t[14]||(t[14]=e("h5",{class:"card-title text-danger"},"Site Summary",-1)),m(se,{ref_key:"bigTableRef",ref:N,settings:O.value,urls:H.value,fields:z.value,canInsert:!1,canUpdate:!1},null,8,["settings","urls","fields"])])])):d("",!0),l.value===""||["0","1","2","3"].includes(l.value)?(r(),i("div",Re,[l.value===""||l.value==="0"?(r(),i("div",Le)):d("",!0),l.value===""||l.value==="0"?(r(),i("div",Ee,[e("div",$e,[m(x,{ref_key:"chart11",ref:f,settings:h.value},null,8,["settings"])])])):d("",!0),l.value===""||l.value==="1"?(r(),i("div",je,[e("div",Ne,[m(x,{settings:C.value},null,8,["settings"])])])):d("",!0),l.value===""||l.value==="2"?(r(),i("div",Pe,[e("div",qe,[m(x,{settings:P.value},null,8,["settings"])])])):d("",!0),l.value===""||l.value==="3"?(r(),i("div",Oe,[e("div",ze,[m(x,{settings:q.value},null,8,["settings"])])])):d("",!0)])):d("",!0),t[15]||(t[15]=e("br",null,null,-1)),t[16]||(t[16]=e("br",null,null,-1)),t[17]||(t[17]=e("br",null,null,-1))],64))}},et=J(He,[["__scopeId","data-v-74bb038f"]]);export{et as default};
