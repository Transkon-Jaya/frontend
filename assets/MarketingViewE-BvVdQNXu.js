import{u as q,r as _,p as x,o as D,c as n,a as u,m as p,G as C,b as r,v as i,t as d,f as N,q as M,s as k,g as a}from"./index-Bt7A5wxw.js";import{V as P,u as h,w as S}from"./xlsx-BP5oqIX8.js";/* empty css                            */const B={class:"form-container"},I={key:0},A={key:1,class:"error"},F={key:0},$={key:1},L=["onUpdate:modelValue"],T={key:1},z={key:2},G=["onUpdate:modelValue"],H={key:1},K={key:3},O=["onUpdate:modelValue"],Q={key:1},j={key:4},J=["onUpdate:modelValue"],R={key:1},W={key:5},X=["onUpdate:modelValue"],Y={key:1},Z={key:6},ee=["onClick"],w="https://www.transkon-rent.com/api/marketing",le={__name:"MarketingViewE",setup(te){const f=q(),c=_([]),m=_(!0),b=_(null),l=_({name_customer:"",location:"",plan_hub:"",number_quot:"",no_spk_po_customer:""}),v=async()=>{try{m.value=!0;const t=await k.get(w,{headers:{Authorization:`Bearer ${f.token}`}});c.value=t.data.map(o=>({...o,id:parseInt(o.id,10),isEditing:!1}))}catch(t){b.value="Failed to fetch data",console.error(t)}finally{m.value=!1}},y=async t=>{try{await k.put(`${w}`,{id:t.id,name_customer:t.name_customer,location:t.location,plan_hub:t.plan_hub,number_quot:t.number_quot,no_spk_po_customer:t.no_spk_po_customer}),t.isEditing=!1,alert("Updated successfully!")}catch(o){console.error("Update failed:",o),alert("Failed to update")}},g=async()=>{try{const t=await k.post(w,{name_customer:l.value.name_customer,location:l.value.location,plan_hub:l.value.plan_hub,number_quot:l.value.number_quot,no_spk_po_customer:l.value.no_spk_po_customer},{headers:{Authorization:`Bearer ${f.token}`}});c.value.push({...t.data,id:parseInt(t.data.id,10),isEditing:!1}),l.value={name_customer:"",location:"",plan_hub:"",number_quot:"",no_spk_po_customer:""},alert("Inserted successfully!")}catch(t){console.error("Insertion failed:",t),alert("Failed to insert")}},E=()=>{const t=h.json_to_sheet(c.value),o=h.book_new();h.book_append_sheet(o,t,"Marketing Data"),S(o,"Marketing_Data.xlsx")},V=_([{label:"Actions",field:"actions"},{label:"ID",field:"id",sortable:!0,filterable:!0},{label:"Customer Name",field:"name_customer",sortable:!0,filterable:!0},{label:"Location",field:"location",sortable:!0,filterable:!0},{label:"Plan Hub",field:"plan_hub",sortable:!0,filterable:!0},{label:"Number Quot",field:"number_quot",sortable:!0,filterable:!0},{label:"No SPK PO Customer",field:"no_spk_po_customer",sortable:!0,filterable:!0}]),U=x(()=>c.value.map(t=>({...t,actions:t.isEditing?"Save":"Edit"})));return D(v),(t,o)=>(a(),n("div",null,[o[6]||(o[6]=u("h2",null,"Marketing Data (Editable, Exportable, & Insertable)",-1)),u("div",B,[o[5]||(o[5]=u("h3",null,"Add New Entry",-1)),r(u("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>l.value.name_customer=e),placeholder:"Customer Name"},null,512),[[i,l.value.name_customer]]),r(u("input",{"onUpdate:modelValue":o[1]||(o[1]=e=>l.value.location=e),placeholder:"Location"},null,512),[[i,l.value.location]]),r(u("input",{"onUpdate:modelValue":o[2]||(o[2]=e=>l.value.plan_hub=e),placeholder:"Plan Hub"},null,512),[[i,l.value.plan_hub]]),r(u("input",{"onUpdate:modelValue":o[3]||(o[3]=e=>l.value.number_quot=e),placeholder:"Number Quot"},null,512),[[i,l.value.number_quot]]),r(u("input",{"onUpdate:modelValue":o[4]||(o[4]=e=>l.value.no_spk_po_customer=e),placeholder:"No SPK PO Customer"},null,512),[[i,l.value.no_spk_po_customer]]),u("button",{onClick:g},"Add New Entry")]),u("button",{onClick:E},"Export to Excel"),m.value?(a(),n("p",I,"Loading...")):p("",!0),b.value?(a(),n("p",A,d(b.value),1)):p("",!0),!m.value&&!b.value?(a(),C(M(P),{key:2,columns:V.value,rows:U.value,"pagination-options":{enabled:!0,mode:"pages",perPage:10},"search-options":{enabled:!0},"sort-options":{enabled:!0}},{"table-row":N(e=>[e.column.field==="id"?(a(),n("span",F,d(e.row.id),1)):e.column.field==="name_customer"?(a(),n("span",$,[e.row.isEditing?r((a(),n("input",{key:0,"onUpdate:modelValue":s=>e.row.name_customer=s},null,8,L)),[[i,e.row.name_customer]]):(a(),n("span",T,d(e.row.name_customer),1))])):e.column.field==="location"?(a(),n("span",z,[e.row.isEditing?r((a(),n("input",{key:0,"onUpdate:modelValue":s=>e.row.location=s},null,8,G)),[[i,e.row.location]]):(a(),n("span",H,d(e.row.location),1))])):e.column.field==="plan_hub"?(a(),n("span",K,[e.row.isEditing?r((a(),n("input",{key:0,"onUpdate:modelValue":s=>e.row.plan_hub=s},null,8,O)),[[i,e.row.plan_hub]]):(a(),n("span",Q,d(e.row.plan_hub),1))])):e.column.field==="number_quot"?(a(),n("span",j,[e.row.isEditing?r((a(),n("input",{key:0,"onUpdate:modelValue":s=>e.row.number_quot=s},null,8,J)),[[i,e.row.number_quot]]):(a(),n("span",R,d(e.row.number_quot),1))])):e.column.field==="no_spk_po_customer"?(a(),n("span",W,[e.row.isEditing?r((a(),n("input",{key:0,"onUpdate:modelValue":s=>e.row.no_spk_po_customer=s},null,8,X)),[[i,e.row.no_spk_po_customer]]):(a(),n("span",Y,d(e.row.no_spk_po_customer),1))])):e.column.field==="actions"?(a(),n("span",Z,[u("button",{onClick:s=>e.row.isEditing?y(e.row):e.row.isEditing=!0},d(e.row.isEditing?"Save":"Edit"),9,ee)])):p("",!0)]),_:1},8,["columns","rows"])):p("",!0)]))}};export{le as default};
