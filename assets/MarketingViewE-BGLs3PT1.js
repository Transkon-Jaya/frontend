import{r as _,m as U,o as q,c as a,a as u,j as p,C as x,f as r,v as i,t as d,w as C,y as D,n as k,b as n}from"./index-9r_NpnA2.js";import{V as N,u as w,w as M}from"./xlsx-CW7WaKkq.js";const P={class:"form-container"},I={key:0},S={key:1,class:"error"},B={key:0},F={key:1},A=["onUpdate:modelValue"],L={key:1},T={key:2},j=["onUpdate:modelValue"],H={key:1},K={key:3},O=["onUpdate:modelValue"],Q={key:1},$={key:4},G=["onUpdate:modelValue"],z={key:1},J={key:5},R=["onUpdate:modelValue"],W={key:1},X={key:6},Y=["onClick"],h="https://www.transkon-rent.com/api/marketing",oe={__name:"MarketingViewE",setup(Z){const c=_([]),m=_(!0),b=_(null),l=_({name_customer:"",location:"",plan_hub:"",number_quot:"",no_spk_po_customer:""}),f=async()=>{try{m.value=!0;const t=await k.get(h);c.value=t.data.map(o=>({...o,id:parseInt(o.id,10),isEditing:!1}))}catch(t){b.value="Failed to fetch data",console.error(t)}finally{m.value=!1}},v=async t=>{try{await k.put(`${h}`,{id:t.id,name_customer:t.name_customer,location:t.location,plan_hub:t.plan_hub,number_quot:t.number_quot,no_spk_po_customer:t.no_spk_po_customer}),t.isEditing=!1,alert("Updated successfully!")}catch(o){console.error("Update failed:",o),alert("Failed to update")}},y=async()=>{try{const t=await k.post(h,{name_customer:l.value.name_customer,location:l.value.location,plan_hub:l.value.plan_hub,number_quot:l.value.number_quot,no_spk_po_customer:l.value.no_spk_po_customer});c.value.push({...t.data,id:parseInt(t.data.id,10),isEditing:!1}),l.value={name_customer:"",location:"",plan_hub:"",number_quot:"",no_spk_po_customer:""},alert("Inserted successfully!")}catch(t){console.error("Insertion failed:",t),alert("Failed to insert")}},g=()=>{const t=w.json_to_sheet(c.value),o=w.book_new();w.book_append_sheet(o,t,"Marketing Data"),M(o,"Marketing_Data.xlsx")},E=_([{label:"Actions",field:"actions"},{label:"ID",field:"id",sortable:!0,filterable:!0},{label:"Customer Name",field:"name_customer",sortable:!0,filterable:!0},{label:"Location",field:"location",sortable:!0,filterable:!0},{label:"Plan Hub",field:"plan_hub",sortable:!0,filterable:!0},{label:"Number Quot",field:"number_quot",sortable:!0,filterable:!0},{label:"No SPK PO Customer",field:"no_spk_po_customer",sortable:!0,filterable:!0}]),V=U(()=>c.value.map(t=>({...t,actions:t.isEditing?"Save":"Edit"})));return q(f),(t,o)=>(n(),a("div",null,[o[6]||(o[6]=u("h2",null,"Marketing Data (Editable, Exportable, & Insertable)",-1)),u("div",P,[o[5]||(o[5]=u("h3",null,"Add New Entry",-1)),r(u("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>l.value.name_customer=e),placeholder:"Customer Name"},null,512),[[i,l.value.name_customer]]),r(u("input",{"onUpdate:modelValue":o[1]||(o[1]=e=>l.value.location=e),placeholder:"Location"},null,512),[[i,l.value.location]]),r(u("input",{"onUpdate:modelValue":o[2]||(o[2]=e=>l.value.plan_hub=e),placeholder:"Plan Hub"},null,512),[[i,l.value.plan_hub]]),r(u("input",{"onUpdate:modelValue":o[3]||(o[3]=e=>l.value.number_quot=e),placeholder:"Number Quot"},null,512),[[i,l.value.number_quot]]),r(u("input",{"onUpdate:modelValue":o[4]||(o[4]=e=>l.value.no_spk_po_customer=e),placeholder:"No SPK PO Customer"},null,512),[[i,l.value.no_spk_po_customer]]),u("button",{onClick:y},"Add New Entry")]),u("button",{onClick:g},"Export to Excel"),m.value?(n(),a("p",I,"Loading...")):p("",!0),b.value?(n(),a("p",S,d(b.value),1)):p("",!0),!m.value&&!b.value?(n(),x(D(N),{key:2,columns:E.value,rows:V.value,"pagination-options":{enabled:!0,mode:"pages",perPage:10},"search-options":{enabled:!0},"sort-options":{enabled:!0}},{"table-row":C(e=>[e.column.field==="id"?(n(),a("span",B,d(e.row.id),1)):e.column.field==="name_customer"?(n(),a("span",F,[e.row.isEditing?r((n(),a("input",{key:0,"onUpdate:modelValue":s=>e.row.name_customer=s},null,8,A)),[[i,e.row.name_customer]]):(n(),a("span",L,d(e.row.name_customer),1))])):e.column.field==="location"?(n(),a("span",T,[e.row.isEditing?r((n(),a("input",{key:0,"onUpdate:modelValue":s=>e.row.location=s},null,8,j)),[[i,e.row.location]]):(n(),a("span",H,d(e.row.location),1))])):e.column.field==="plan_hub"?(n(),a("span",K,[e.row.isEditing?r((n(),a("input",{key:0,"onUpdate:modelValue":s=>e.row.plan_hub=s},null,8,O)),[[i,e.row.plan_hub]]):(n(),a("span",Q,d(e.row.plan_hub),1))])):e.column.field==="number_quot"?(n(),a("span",$,[e.row.isEditing?r((n(),a("input",{key:0,"onUpdate:modelValue":s=>e.row.number_quot=s},null,8,G)),[[i,e.row.number_quot]]):(n(),a("span",z,d(e.row.number_quot),1))])):e.column.field==="no_spk_po_customer"?(n(),a("span",J,[e.row.isEditing?r((n(),a("input",{key:0,"onUpdate:modelValue":s=>e.row.no_spk_po_customer=s},null,8,R)),[[i,e.row.no_spk_po_customer]]):(n(),a("span",W,d(e.row.no_spk_po_customer),1))])):e.column.field==="actions"?(n(),a("span",X,[u("button",{onClick:s=>e.row.isEditing?v(e.row):e.row.isEditing=!0},d(e.row.isEditing?"Save":"Edit"),9,Y)])):p("",!0)]),_:1},8,["columns","rows"])):p("",!0)]))}};export{oe as default};
