import{_ as le,r as o,l as b,o as se,H as oe,c,a as l,d as x,C as $,b as ne,v as ie,f as re,V as de,t as i,n as ce,F as G,j as K,y as C,p as M,s as V,A as D,x as ue,g as u,h as me}from"./index-P8gt9Fxf.js";import{s as z}from"./vue-multiselect-4FTi_zDx.js";/* empty css                            *//* empty css                                                 */import{M as ve}from"./bootstrap.esm-B0YAJBZY.js";const pe={class:"container-global"},be={class:"d-flex align-items-end gap-3 flex-wrap"},he={class:"col-md-4"},ge={class:"col-md-4"},_e={class:"filter-box flex-grow-1"},fe={class:"border rounded p-2 bg-white"},ye={class:"filter-box"},we={class:"container my-4"},ke={key:0,class:"text-center my-5"},xe={key:1,class:"alert alert-danger"},Ce={key:2},Me={class:"row"},Ve={class:"card h-100"},De=["src","onClick"],Ae={class:"card-body"},Ee={class:"card-title"},Ie={class:"card-text text-muted small"},Pe={key:0,"aria-label":"Page navigation"},Le={class:"pagination justify-content-center mt-4"},Te=["onClick"],je={class:"text-center text-muted small"},Be={class:"modal-dialog modal-dialog-centered modal-lg"},Re={class:"modal-content bg-dark text-white"},Fe={class:"modal-header border-0"},Ne={class:"modal-title",id:"imageModalLabel"},Ue={class:"modal-body text-center"},Se=["src"],$e={class:"modal-footer justify-content-between border-0"},Ge=["disabled"],Ke=["disabled"],v=20,ze={__name:"GalleryAbsensi",setup(Oe){const r=o([]),n=o(0),f=o(null),h=o(!0),y=o(null);o("");const s=o(1),g=o(null),w=o(null),A=o([]),E=o([]),I=o({api:{params:[]}}),P=o({api:{params:[]}}),L=o(null),T=o(null),_=b(()=>Math.ceil(r.value.length/v)),O=b(()=>{const e=(s.value-1)*v,a=e+v;return r.value.slice(e,a)}),H=b(()=>(s.value-1)*v+1),q=b(()=>Math.min(s.value*v,r.value.length)),J=b(()=>{const e=[];let t=Math.max(1,s.value-Math.floor(2.5)),d=Math.min(_.value,t+5-1);d-t+1<5&&(t=Math.max(1,d-5+1));for(let p=t;p<=d;p++)e.push(p);return e}),j=e=>{if(!e)return"";const a={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(e).toLocaleDateString("id-ID",a)},B=e=>e?`https://www.transkon-rent.com/uploads/absensi/${e}`:"",k=b(()=>r.value[n.value]||{}),Q=()=>{s.value<_.value&&s.value++},W=()=>{s.value>1&&s.value--},X=e=>{s.value=e},Y=e=>(s.value-1)*v+e,Z=async()=>{try{h.value=!0;const a=(await V.get(D+"/data/absensi_all",{params:{params:["","",""]}})).data;if(Array.isArray(a))r.value=a.filter(t=>t.foto_in);else throw new Error("Format data tidak valid")}catch(e){console.error("Error fetching data:",e),y.value=e.message,r.value=[{foto_in:"Tj1023_IN_1746431330.jpg",name:"Contoh Karyawan 1",hour_in:"2023-11-15T08:00:00"},{foto_in:"Tj1023_IN_1746507175.jpg",name:"Contoh Karyawan 2",hour_in:"2023-11-15T08:05:00"}]}finally{h.value=!1}};let m=null;const ee=e=>{n.value=e,m==null||m.show()},R=()=>{m==null||m.hide()},F=()=>{if(n.value<r.value.length-1){n.value++;const e=Math.floor(n.value/v)+1;e!==s.value&&(s.value=e)}},N=()=>{if(n.value>0){n.value--;const e=Math.floor(n.value/v)+1;e!==s.value&&(s.value=e)}},U=e=>{var a;if(!(!m||!((a=document.getElementById("imageModal"))!=null&&a.classList.contains("show"))))switch(e.key){case"ArrowRight":F();break;case"ArrowLeft":N();break;case"Escape":R();break}},ae=async()=>{try{const e=await V.get(`${D}/dropdowns/department`);A.value=e.data.map(t=>({label:t,value:t}));const a=await V.get(`${D}/dropdowns/name`);E.value=a.data.map(t=>({label:t,value:t}))}catch(e){console.error("Error fetching dropdowns:",e)}},S=async(e,a)=>{var d,p;let t=0;g.value=a,t=3,I.value.api.params[t]=a.value,P.value.api.params[t]=a.value,await((d=L.value)==null?void 0:d.renderChart()),await((p=T.value)==null?void 0:p.renderChart()),await ue()},te=async()=>{var e,a;g.value="",w.value="";for(let t=2;t<5;t++)I.value.api.params[t]="",P.value.api.params[t]="";await((e=L.value)==null?void 0:e.renderChart()),await((a=T.value)==null?void 0:a.renderChart())};return se(async()=>{f.value&&(m=new ve(f.value)),await Z(),await ae(),h.value=!1,document.addEventListener("keydown",U)}),oe(()=>{document.removeEventListener("keydown",U)}),(e,a)=>(u(),c("div",pe,[l("div",be,[l("div",he,[a[5]||(a[5]=l("label",{class:"form-label"},"Department",-1)),x($(z),{modelValue:g.value,"onUpdate:modelValue":[a[0]||(a[0]=t=>g.value=t),a[1]||(a[1]=t=>S("dep",t))],options:A.value||[],placeholder:"Select...",label:"label","track-by":"value",class:"multiselect no-border"},null,8,["modelValue","options"])]),l("div",ge,[a[6]||(a[6]=l("label",{class:"form-label"},"Employee",-1)),x($(z),{modelValue:w.value,"onUpdate:modelValue":[a[2]||(a[2]=t=>w.value=t),a[3]||(a[3]=t=>S("dep",t))],options:E.value||[],placeholder:"Select...",label:"label","track-by":"value",class:"multiselect no-border"},null,8,["modelValue","options"])]),l("div",_e,[a[7]||(a[7]=l("label",{class:"form-label small mb-1 text-muted"},"Date",-1)),l("div",fe,[ne(l("input",{type:"date",class:"form-control border-0 p-0","onUpdate:modelValue":a[4]||(a[4]=t=>e.selectedDate=t)},null,512),[[ie,e.selectedDate]])])]),l("div",ye,[x(de,{type:"button",color:"danger",size:"md",onClick:te,class:"h-100"},{default:re(()=>a[8]||(a[8]=[l("i",{class:"bi bi-arrow-counterclockwise me-2"},null,-1),me(" Reset ")])),_:1})])]),l("div",we,[h.value?(u(),c("div",ke,a[9]||(a[9]=[l("div",{class:"spinner-border text-primary",role:"status"},[l("span",{class:"visually-hidden"},"Loading...")],-1),l("p",{class:"mt-2"},"Memuat data absensi...",-1)]))):y.value?(u(),c("div",xe," Gagal memuat data: "+i(y.value),1)):(u(),c("div",Ce,[l("div",Me,[(u(!0),c(G,null,K(O.value,(t,d)=>(u(),c("div",{class:"col-md-3 mb-4",key:d},[l("div",Ve,[l("img",{src:B(t.foto_in),class:"card-img-top gallery-img",onClick:p=>ee(Y(d)),alt:"Foto Absensi"},null,8,De),l("div",Ae,[l("h6",Ee,i(t.name),1),l("p",Ie,i(j(t.hour_in)),1)])])]))),128))]),_.value>1?(u(),c("nav",Pe,[l("ul",Le,[l("li",{class:C(["page-item",{disabled:s.value===1}])},[l("a",{class:"page-link",href:"#",onClick:M(W,["prevent"])},"«")],2),(u(!0),c(G,null,K(J.value,t=>(u(),c("li",{class:C(["page-item",{active:s.value===t}]),key:t},[l("a",{class:"page-link",href:"#",onClick:M(d=>X(t),["prevent"])},i(t),9,Te)],2))),128)),l("li",{class:C(["page-item",{disabled:s.value===_.value}])},[l("a",{class:"page-link",href:"#",onClick:M(Q,["prevent"])},"»")],2)]),l("div",je," Menampilkan "+i(H.value)+"-"+i(q.value)+" dari "+i(r.value.length)+" foto ",1)])):ce("",!0)])),l("div",{class:"modal fade",id:"imageModal",tabindex:"-1","data-bs-backdrop":"false","aria-labelledby":"imageModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:f},[l("div",Be,[l("div",Re,[l("div",Fe,[l("h5",Ne,i(k.value.name||"Karyawan")+" - "+i(j(k.value.hour_in)),1),l("button",{type:"button",class:"btn-close btn-close-white",onClick:R,"aria-label":"Close","data-bs-dismiss":"modal"})]),l("div",Ue,[l("img",{src:B(k.value.foto_in),class:"img-fluid rounded portrait-img fixed-modal-image",alt:"Foto Absensi",ref:"modalImage"},null,8,Se)]),l("div",$e,[l("button",{type:"button",class:"btn btn-outline-light",onClick:N,disabled:n.value===0}," « Sebelumnya ",8,Ge),l("span",null," Gambar "+i(n.value+1)+" dari "+i(r.value.length),1),l("button",{type:"button",class:"btn btn-outline-light",onClick:F,disabled:n.value===r.value.length-1}," Berikutnya » ",8,Ke)])])])],512)])]))}},Xe=le(ze,[["__scopeId","data-v-7df6e2ca"]]);export{Xe as default};
